var app=function(){"use strict";function e(){}function t(e){return e()}function n(){return Object.create(null)}function r(e){e.forEach(t)}function i(e){return"function"==typeof e}function o(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function a(e,t){e.appendChild(t)}function s(e,t,n){e.insertBefore(t,n||null)}function c(e){e.parentNode.removeChild(e)}function u(e){return document.createElement(e)}function l(e){return document.createTextNode(e)}function f(){return l(" ")}function h(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}function p(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function d(e,t){(null!=t||e.value)&&(e.value=t)}let v;function y(e){v=e}function m(){if(!v)throw new Error("Function called outside component initialization");return v}function g(){const e=m();return(t,n)=>{const r=e.$$.callbacks[t];if(r){const i=function(e,t){const n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!1,!1,t),n}(t,n);r.slice().forEach(t=>{t.call(e,i)})}}}const b=[],_=[],w=[],S=[],C=Promise.resolve();let k=!1;function x(e){w.push(e)}function T(){const e=new Set;do{for(;b.length;){const e=b.shift();y(e),P(e.$$)}for(;_.length;)_.pop()();for(let t=0;t<w.length;t+=1){const n=w[t];e.has(n)||(n(),e.add(n))}w.length=0}while(b.length);for(;S.length;)S.pop()();k=!1}function P(e){null!==e.fragment&&(e.update(e.dirty),r(e.before_update),e.fragment&&e.fragment.p(e.dirty,e.ctx),e.dirty=null,e.after_update.forEach(x))}const E=new Set;let O;function R(e,t){e&&e.i&&(E.delete(e),e.i(t))}function M(e,t,n,r){if(e&&e.o){if(E.has(e))return;E.add(e),O.c.push(()=>{E.delete(e),r&&(n&&e.d(1),r())}),e.o(t)}}function j(e){e&&e.c()}function D(e,n,o){const{fragment:a,on_mount:s,on_destroy:c,after_update:u}=e.$$;a&&a.m(n,o),x(()=>{const n=s.map(t).filter(i);c?c.push(...n):r(n),e.$$.on_mount=[]}),u.forEach(x)}function I(e,t){const n=e.$$;null!==n.fragment&&(r(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx={})}function A(e,t){e.$$.dirty||(b.push(e),k||(k=!0,C.then(T)),e.$$.dirty=n()),e.$$.dirty[t]=!0}function L(t,i,o,a,s,c){const u=v;y(t);const l=i.props||{},f=t.$$={fragment:null,ctx:null,props:c,update:e,not_equal:s,bound:n(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(u?u.$$.context:[]),callbacks:n(),dirty:null};let h=!1;f.ctx=o?o(t,l,(e,n,r=n)=>(f.ctx&&s(f.ctx[e],f.ctx[e]=r)&&(f.bound[e]&&f.bound[e](r),h&&A(t,e)),n)):l,f.update(),h=!0,r(f.before_update),f.fragment=!!a&&a(f.ctx),i.target&&(i.hydrate?f.fragment&&f.fragment.l(function(e){return Array.from(e.childNodes)}(i.target)):f.fragment&&f.fragment.c(),i.intro&&R(t.$$.fragment),D(t,i.target,i.anchor),T()),y(u)}class N{$destroy(){I(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(){}}function B(){throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}var F=function(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}(function(e,t){return e(t={exports:{}},t.exports),t.exports}((function(e,t){parcelRequire=function(t,n,r,i){var o,a="function"==typeof parcelRequire&&parcelRequire,s=B;function c(e,r){if(!n[e]){if(!t[e]){var i="function"==typeof parcelRequire&&parcelRequire;if(!r&&i)return i(e,!0);if(a)return a(e,!0);if(s&&"string"==typeof e)return s(e);var o=new Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}l.resolve=function(n){return t[e][1][n]||n},l.cache={};var u=n[e]=new c.Module(e);t[e][0].call(u.exports,l,u,u.exports,this)}return n[e].exports;function l(e){return c(l.resolve(e))}}c.isParcelRequire=!0,c.Module=function(e){this.id=e,this.bundle=c,this.exports={}},c.modules=t,c.cache=n,c.parent=a,c.register=function(e,n){t[e]=[function(e,t){t.exports=n},{}]};for(var u=0;u<r.length;u++)try{c(r[u])}catch(t){o||(o=t)}if(r.length){var l=c(r[r.length-1]);e.exports=l}if(parcelRequire=c,o)throw o;return c}({"4EgB":[function(e,t,n){var r={};r.useBlobBuilder=function(){try{return new Blob([]),!1}catch(e){return!0}}(),r.useArrayBufferView=!r.useBlobBuilder&&function(){try{return 0===new Blob([new Uint8Array([])]).size}catch(e){return!0}}(),t.exports.binaryFeatures=r;var i=t.exports.BlobBuilder;function o(){this._pieces=[],this._parts=[]}"undefined"!=typeof window&&(i=t.exports.BlobBuilder=window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder||window.BlobBuilder),o.prototype.append=function(e){"number"==typeof e?this._pieces.push(e):(this.flush(),this._parts.push(e))},o.prototype.flush=function(){if(this._pieces.length>0){var e=new Uint8Array(this._pieces);r.useArrayBufferView||(e=e.buffer),this._parts.push(e),this._pieces=[]}},o.prototype.getBuffer=function(){if(this.flush(),r.useBlobBuilder){for(var e=new i,t=0,n=this._parts.length;t<n;t++)e.append(this._parts[t]);return e.getBlob()}return new Blob(this._parts)},t.exports.BufferBuilder=o},{}],kdPp:[function(e,t,n){var r=e("./bufferbuilder").BufferBuilder,i=e("./bufferbuilder").binaryFeatures,o={unpack:function(e){return new a(e).unpack()},pack:function(e){var t=new s;return t.pack(e),t.getBuffer()}};function a(e){this.index=0,this.dataBuffer=e,this.dataView=new Uint8Array(this.dataBuffer),this.length=this.dataBuffer.byteLength}function s(){this.bufferBuilder=new r}function c(e){var t=e.charCodeAt(0);return t<=2047?"00":t<=65535?"000":t<=2097151?"0000":t<=67108863?"00000":"000000"}t.exports=o,a.prototype.unpack=function(){var e,t=this.unpack_uint8();if(t<128)return t;if((224^t)<32)return(224^t)-32;if((e=160^t)<=15)return this.unpack_raw(e);if((e=176^t)<=15)return this.unpack_string(e);if((e=144^t)<=15)return this.unpack_array(e);if((e=128^t)<=15)return this.unpack_map(e);switch(t){case 192:return null;case 193:return;case 194:return!1;case 195:return!0;case 202:return this.unpack_float();case 203:return this.unpack_double();case 204:return this.unpack_uint8();case 205:return this.unpack_uint16();case 206:return this.unpack_uint32();case 207:return this.unpack_uint64();case 208:return this.unpack_int8();case 209:return this.unpack_int16();case 210:return this.unpack_int32();case 211:return this.unpack_int64();case 212:case 213:case 214:case 215:return;case 216:return e=this.unpack_uint16(),this.unpack_string(e);case 217:return e=this.unpack_uint32(),this.unpack_string(e);case 218:return e=this.unpack_uint16(),this.unpack_raw(e);case 219:return e=this.unpack_uint32(),this.unpack_raw(e);case 220:return e=this.unpack_uint16(),this.unpack_array(e);case 221:return e=this.unpack_uint32(),this.unpack_array(e);case 222:return e=this.unpack_uint16(),this.unpack_map(e);case 223:return e=this.unpack_uint32(),this.unpack_map(e)}},a.prototype.unpack_uint8=function(){var e=255&this.dataView[this.index];return this.index++,e},a.prototype.unpack_uint16=function(){var e=this.read(2),t=256*(255&e[0])+(255&e[1]);return this.index+=2,t},a.prototype.unpack_uint32=function(){var e=this.read(4),t=256*(256*(256*e[0]+e[1])+e[2])+e[3];return this.index+=4,t},a.prototype.unpack_uint64=function(){var e=this.read(8),t=256*(256*(256*(256*(256*(256*(256*e[0]+e[1])+e[2])+e[3])+e[4])+e[5])+e[6])+e[7];return this.index+=8,t},a.prototype.unpack_int8=function(){var e=this.unpack_uint8();return e<128?e:e-256},a.prototype.unpack_int16=function(){var e=this.unpack_uint16();return e<32768?e:e-65536},a.prototype.unpack_int32=function(){var e=this.unpack_uint32();return e<Math.pow(2,31)?e:e-Math.pow(2,32)},a.prototype.unpack_int64=function(){var e=this.unpack_uint64();return e<Math.pow(2,63)?e:e-Math.pow(2,64)},a.prototype.unpack_raw=function(e){if(this.length<this.index+e)throw new Error("BinaryPackFailure: index is out of range "+this.index+" "+e+" "+this.length);var t=this.dataBuffer.slice(this.index,this.index+e);return this.index+=e,t},a.prototype.unpack_string=function(e){for(var t,n,r=this.read(e),i=0,o="";i<e;)(t=r[i])<128?(o+=String.fromCharCode(t),i++):(192^t)<32?(n=(192^t)<<6|63&r[i+1],o+=String.fromCharCode(n),i+=2):(n=(15&t)<<12|(63&r[i+1])<<6|63&r[i+2],o+=String.fromCharCode(n),i+=3);return this.index+=e,o},a.prototype.unpack_array=function(e){for(var t=new Array(e),n=0;n<e;n++)t[n]=this.unpack();return t},a.prototype.unpack_map=function(e){for(var t={},n=0;n<e;n++){var r=this.unpack(),i=this.unpack();t[r]=i}return t},a.prototype.unpack_float=function(){var e=this.unpack_uint32(),t=(e>>23&255)-127;return(0==e>>31?1:-1)*(8388607&e|8388608)*Math.pow(2,t-23)},a.prototype.unpack_double=function(){var e=this.unpack_uint32(),t=this.unpack_uint32(),n=(e>>20&2047)-1023;return(0==e>>31?1:-1)*((1048575&e|1048576)*Math.pow(2,n-20)+t*Math.pow(2,n-52))},a.prototype.read=function(e){var t=this.index;if(t+e<=this.length)return this.dataView.subarray(t,t+e);throw new Error("BinaryPackFailure: read index out of range")},s.prototype.getBuffer=function(){return this.bufferBuilder.getBuffer()},s.prototype.pack=function(e){var t=typeof e;if("string"===t)this.pack_string(e);else if("number"===t)Math.floor(e)===e?this.pack_integer(e):this.pack_double(e);else if("boolean"===t)!0===e?this.bufferBuilder.append(195):!1===e&&this.bufferBuilder.append(194);else if("undefined"===t)this.bufferBuilder.append(192);else{if("object"!==t)throw new Error('Type "'+t+'" not yet supported');if(null===e)this.bufferBuilder.append(192);else{var n=e.constructor;if(n==Array)this.pack_array(e);else if(n==Blob||n==File||e instanceof Blob||e instanceof File)this.pack_bin(e);else if(n==ArrayBuffer)i.useArrayBufferView?this.pack_bin(new Uint8Array(e)):this.pack_bin(e);else if("BYTES_PER_ELEMENT"in e)i.useArrayBufferView?this.pack_bin(new Uint8Array(e.buffer)):this.pack_bin(e.buffer);else if(n==Object||n.toString().startsWith("class"))this.pack_object(e);else if(n==Date)this.pack_string(e.toString());else{if("function"!=typeof e.toBinaryPack)throw new Error('Type "'+n.toString()+'" not yet supported');this.bufferBuilder.append(e.toBinaryPack())}}}this.bufferBuilder.flush()},s.prototype.pack_bin=function(e){var t=e.length||e.byteLength||e.size;if(t<=15)this.pack_uint8(160+t);else if(t<=65535)this.bufferBuilder.append(218),this.pack_uint16(t);else{if(!(t<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(219),this.pack_uint32(t)}this.bufferBuilder.append(e)},s.prototype.pack_string=function(e){var t=function(e){return e.length>600?new Blob([e]).size:e.replace(/[^\u0000-\u007F]/g,c).length}(e);if(t<=15)this.pack_uint8(176+t);else if(t<=65535)this.bufferBuilder.append(216),this.pack_uint16(t);else{if(!(t<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(217),this.pack_uint32(t)}this.bufferBuilder.append(e)},s.prototype.pack_array=function(e){var t=e.length;if(t<=15)this.pack_uint8(144+t);else if(t<=65535)this.bufferBuilder.append(220),this.pack_uint16(t);else{if(!(t<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(221),this.pack_uint32(t)}for(var n=0;n<t;n++)this.pack(e[n])},s.prototype.pack_integer=function(e){if(e>=-32&&e<=127)this.bufferBuilder.append(255&e);else if(e>=0&&e<=255)this.bufferBuilder.append(204),this.pack_uint8(e);else if(e>=-128&&e<=127)this.bufferBuilder.append(208),this.pack_int8(e);else if(e>=0&&e<=65535)this.bufferBuilder.append(205),this.pack_uint16(e);else if(e>=-32768&&e<=32767)this.bufferBuilder.append(209),this.pack_int16(e);else if(e>=0&&e<=4294967295)this.bufferBuilder.append(206),this.pack_uint32(e);else if(e>=-2147483648&&e<=2147483647)this.bufferBuilder.append(210),this.pack_int32(e);else if(e>=-0x8000000000000000&&e<=0x8000000000000000)this.bufferBuilder.append(211),this.pack_int64(e);else{if(!(e>=0&&e<=0x10000000000000000))throw new Error("Invalid integer");this.bufferBuilder.append(207),this.pack_uint64(e)}},s.prototype.pack_double=function(e){var t=0;e<0&&(t=1,e=-e);var n=Math.floor(Math.log(e)/Math.LN2),r=e/Math.pow(2,n)-1,i=Math.floor(r*Math.pow(2,52)),o=Math.pow(2,32),a=t<<31|n+1023<<20|i/o&1048575,s=i%o;this.bufferBuilder.append(203),this.pack_int32(a),this.pack_int32(s)},s.prototype.pack_object=function(e){var t=Object.keys(e).length;if(t<=15)this.pack_uint8(128+t);else if(t<=65535)this.bufferBuilder.append(222),this.pack_uint16(t);else{if(!(t<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(223),this.pack_uint32(t)}for(var n in e)e.hasOwnProperty(n)&&(this.pack(n),this.pack(e[n]))},s.prototype.pack_uint8=function(e){this.bufferBuilder.append(e)},s.prototype.pack_uint16=function(e){this.bufferBuilder.append(e>>8),this.bufferBuilder.append(255&e)},s.prototype.pack_uint32=function(e){var t=4294967295&e;this.bufferBuilder.append((4278190080&t)>>>24),this.bufferBuilder.append((16711680&t)>>>16),this.bufferBuilder.append((65280&t)>>>8),this.bufferBuilder.append(255&t)},s.prototype.pack_uint64=function(e){var t=e/Math.pow(2,32),n=e%Math.pow(2,32);this.bufferBuilder.append((4278190080&t)>>>24),this.bufferBuilder.append((16711680&t)>>>16),this.bufferBuilder.append((65280&t)>>>8),this.bufferBuilder.append(255&t),this.bufferBuilder.append((4278190080&n)>>>24),this.bufferBuilder.append((16711680&n)>>>16),this.bufferBuilder.append((65280&n)>>>8),this.bufferBuilder.append(255&n)},s.prototype.pack_int8=function(e){this.bufferBuilder.append(255&e)},s.prototype.pack_int16=function(e){this.bufferBuilder.append((65280&e)>>8),this.bufferBuilder.append(255&e)},s.prototype.pack_int32=function(e){this.bufferBuilder.append(e>>>24&255),this.bufferBuilder.append((16711680&e)>>>16),this.bufferBuilder.append((65280&e)>>>8),this.bufferBuilder.append(255&e)},s.prototype.pack_int64=function(e){var t=Math.floor(e/Math.pow(2,32)),n=e%Math.pow(2,32);this.bufferBuilder.append((4278190080&t)>>>24),this.bufferBuilder.append((16711680&t)>>>16),this.bufferBuilder.append((65280&t)>>>8),this.bufferBuilder.append(255&t),this.bufferBuilder.append((4278190080&n)>>>24),this.bufferBuilder.append((16711680&n)>>>16),this.bufferBuilder.append((65280&n)>>>8),this.bufferBuilder.append(255&n)}},{"./bufferbuilder":"4EgB"}],iSxC:[function(e,t,n){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.extractVersion=a,n.wrapPeerConnectionEvent=function(e,t,n){if(e.RTCPeerConnection){var r=e.RTCPeerConnection.prototype,i=r.addEventListener;r.addEventListener=function(e,r){if(e!==t)return i.apply(this,arguments);var o=function(e){var t=n(e);t&&r(t)};return this._eventMap=this._eventMap||{},this._eventMap[r]=o,i.apply(this,[e,o])};var o=r.removeEventListener;r.removeEventListener=function(e,n){if(e!==t||!this._eventMap||!this._eventMap[n])return o.apply(this,arguments);var r=this._eventMap[n];return delete this._eventMap[n],o.apply(this,[e,r])},Object.defineProperty(r,"on"+t,{get:function(){return this["_on"+t]},set:function(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}},n.disableLog=function(e){return"boolean"!=typeof e?new Error("Argument type: "+r(e)+". Please use a boolean."):(i=e,e?"adapter.js logging disabled":"adapter.js logging enabled")},n.disableWarnings=function(e){return"boolean"!=typeof e?new Error("Argument type: "+r(e)+". Please use a boolean."):(o=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))},n.log=function(){if("object"===("undefined"==typeof window?"undefined":r(window))){if(i)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}},n.deprecated=function(e,t){o&&console.warn(e+" is deprecated, please use "+t+" instead.")},n.detectBrowser=function(e){var{navigator:t}=e,n={browser:null,version:null};if(void 0===e||!e.navigator)return n.browser="Not a browser.",n;if(t.mozGetUserMedia)n.browser="firefox",n.version=a(t.userAgent,/Firefox\/(\d+)\./,1);else if(t.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection&&!e.RTCIceGatherer)n.browser="chrome",n.version=a(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(t.mediaDevices&&t.userAgent.match(/Edge\/(\d+).(\d+)$/))n.browser="edge",n.version=a(t.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!e.RTCPeerConnection||!t.userAgent.match(/AppleWebKit\/(\d+)\./))return n.browser="Not a supported browser.",n;n.browser="safari",n.version=a(t.userAgent,/AppleWebKit\/(\d+)\./,1),n.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype}return n},n.compactObject=function e(t){return s(t)?Object.keys(t).reduce((function(n,r){var i=s(t[r]),o=i?e(t[r]):t[r],a=i&&!Object.keys(o).length;return void 0===o||a?n:Object.assign(n,function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},r,o))}),{}):t},n.walkStats=c,n.filterStats=function(e,t,n){var r=n?"outbound-rtp":"inbound-rtp",i=new Map;if(null===t)return i;var o=[];return e.forEach((function(e){"track"===e.type&&e.trackIdentifier===t.id&&o.push(e)})),o.forEach((function(t){e.forEach((function(n){n.type===r&&n.trackId===t.id&&c(e,n,i)}))})),i};var i=!0,o=!0;function a(e,t,n){var r=e.match(t);return r&&r.length>=n&&parseInt(r[n],10)}function s(e){return"[object Object]"===Object.prototype.toString.call(e)}function c(e,t,n){t&&!n.has(t.id)&&(n.set(t.id,t),Object.keys(t).forEach((function(r){r.endsWith("Id")?c(e,e.get(t[r]),n):r.endsWith("Ids")&&t[r].forEach((function(t){c(e,e.get(t),n)}))})))}},{}],s6SN:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetUserMedia=function(e){var t=e&&e.navigator;if(t.mediaDevices){var n=r.detectBrowser(e),a=function(e){if("object"!==i(e)||e.mandatory||e.optional)return e;var t={};return Object.keys(e).forEach((function(n){if("require"!==n&&"advanced"!==n&&"mediaSource"!==n){var r="object"===i(e[n])?e[n]:{ideal:e[n]};void 0!==r.exact&&"number"==typeof r.exact&&(r.min=r.max=r.exact);var o=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==r.ideal){t.optional=t.optional||[];var a={};"number"==typeof r.ideal?(a[o("min",n)]=r.ideal,t.optional.push(a),(a={})[o("max",n)]=r.ideal,t.optional.push(a)):(a[o("",n)]=r.ideal,t.optional.push(a))}void 0!==r.exact&&"number"!=typeof r.exact?(t.mandatory=t.mandatory||{},t.mandatory[o("",n)]=r.exact):["min","max"].forEach((function(e){void 0!==r[e]&&(t.mandatory=t.mandatory||{},t.mandatory[o(e,n)]=r[e])}))}})),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},s=function(e,r){if(n.version>=61)return r(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"===i(e.audio)){var s=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])};s((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),s(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=a(e.audio)}if(e&&"object"===i(e.video)){var c=e.video.facingMode;c=c&&("object"===i(c)?c:{ideal:c});var u,l=n.version<66;if(c&&("user"===c.exact||"environment"===c.exact||"user"===c.ideal||"environment"===c.ideal)&&(!t.mediaDevices.getSupportedConstraints||!t.mediaDevices.getSupportedConstraints().facingMode||l)&&(delete e.video.facingMode,"environment"===c.exact||"environment"===c.ideal?u=["back","rear"]:"user"!==c.exact&&"user"!==c.ideal||(u=["front"]),u))return t.mediaDevices.enumerateDevices().then((function(t){var n=(t=t.filter((function(e){return"videoinput"===e.kind}))).find((function(e){return u.some((function(t){return e.label.toLowerCase().includes(t)}))}));return!n&&t.length&&u.includes("back")&&(n=t[t.length-1]),n&&(e.video.deviceId=c.exact?{exact:n.deviceId}:{ideal:n.deviceId}),e.video=a(e.video),o("chrome: "+JSON.stringify(e)),r(e)}));e.video=a(e.video)}return o("chrome: "+JSON.stringify(e)),r(e)},c=function(e){return n.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}};if(t.getUserMedia=function(e,n,r){s(e,(function(e){t.webkitGetUserMedia(e,n,(function(e){r&&r(c(e))}))}))}.bind(t),t.mediaDevices.getUserMedia){var u=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return s(e,(function(e){return u(e).then((function(t){if(e.audio&&!t.getAudioTracks().length||e.video&&!t.getVideoTracks().length)throw t.getTracks().forEach((function(e){e.stop()})),new DOMException("","NotFoundError");return t}),(function(e){return Promise.reject(c(e))}))}))}}}};var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}(e("../utils.js"));function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o=r.log},{"../utils.js":"iSxC"}],VHa8:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&("function"==typeof t?e.navigator.mediaDevices.getDisplayMedia=function(n){return t(n).then((function(t){var r=n.video&&n.video.width,i=n.video&&n.video.height,o=n.video&&n.video.frameRate;return n.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:o||3}},r&&(n.video.mandatory.maxWidth=r),i&&(n.video.mandatory.maxHeight=i),e.navigator.mediaDevices.getUserMedia(n)}))}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}},{}],uI5X:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.shimMediaStream=function(e){e.MediaStream=e.MediaStream||e.webkitMediaStream},n.shimOnTrack=function(e){if("object"!==s(e)||!e.RTCPeerConnection||"ontrack"in e.RTCPeerConnection.prototype)r.wrapPeerConnectionEvent(e,"track",(function(e){return e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e}));else{Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var n=this;return this._ontrackpoly||(this._ontrackpoly=function(t){t.stream.addEventListener("addtrack",(function(r){var i;i=e.RTCPeerConnection.prototype.getReceivers?n.getReceivers().find((function(e){return e.track&&e.track.id===r.track.id})):{track:r.track};var o=new Event("track");o.track=r.track,o.receiver=i,o.transceiver={receiver:i},o.streams=[t.stream],n.dispatchEvent(o)})),t.stream.getTracks().forEach((function(r){var i;i=e.RTCPeerConnection.prototype.getReceivers?n.getReceivers().find((function(e){return e.track&&e.track.id===r.id})):{track:r};var o=new Event("track");o.track=r,o.receiver=i,o.transceiver={receiver:i},o.streams=[t.stream],n.dispatchEvent(o)}))},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}},n.shimGetSendersWithDtmf=function(e){if("object"===s(e)&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){var t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};var n=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,r){var i=n.apply(this,arguments);return i||(i=t(this,e),this._senders.push(i)),i};var r=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){r.apply(this,arguments);var t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}var i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var n=this;this._senders=this._senders||[],i.apply(this,[e]),e.getTracks().forEach((function(e){n._senders.push(t(n,e))}))};var o=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._senders=this._senders||[],o.apply(this,[e]),e.getTracks().forEach((function(e){var n=t._senders.find((function(t){return t.track===e}));n&&t._senders.splice(t._senders.indexOf(n),1)}))}}else if("object"===s(e)&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){var a=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){var e=this,t=a.apply(this,[]);return t.forEach((function(t){return t._pc=e})),t},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}},n.shimGetStats=function(e){if(e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var e=this,[n,r,i]=arguments;if(arguments.length>0&&"function"==typeof n)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!=typeof n))return t.apply(this,[]);var o=function(e){var t={};return e.result().forEach((function(e){var n={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach((function(t){n[t]=e.stat(t)})),t[n.id]=n})),t},a=function(e){return new Map(Object.keys(e).map((function(t){return[t,e[t]]})))};return arguments.length>=2?t.apply(this,[function(e){r(a(o(e)))},n]):new Promise((function(n,r){t.apply(e,[function(e){n(a(o(e)))},r])})).then(r,i)}}},n.shimSenderReceiverGetStats=function(e){if("object"===s(e)&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver){if(!("getStats"in e.RTCRtpSender.prototype)){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,n=t.apply(this,[]);return n.forEach((function(t){return t._pc=e})),n});var n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){var e=this;return this._pc.getStats().then((function(t){return r.filterStats(t,e.track,!0)}))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){var i=e.RTCPeerConnection.prototype.getReceivers;i&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,t=i.apply(this,[]);return t.forEach((function(t){return t._pc=e})),t}),r.wrapPeerConnectionEvent(e,"track",(function(e){return e.receiver._pc=e.srcElement,e})),e.RTCRtpReceiver.prototype.getStats=function(){var e=this;return this._pc.getStats().then((function(t){return r.filterStats(t,e.track,!1)}))}}if("getStats"in e.RTCRtpSender.prototype&&"getStats"in e.RTCRtpReceiver.prototype){var o=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){var t,n,r,i=arguments[0];return this.getSenders().forEach((function(e){e.track===i&&(t?r=!0:t=e)})),this.getReceivers().forEach((function(e){return e.track===i&&(n?r=!0:n=e),e.track===i})),r||t&&n?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):t?t.getStats():n?n.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return o.apply(this,arguments)}}}},n.shimAddTrackRemoveTrackWithNative=c,n.shimAddTrackRemoveTrack=function(e){if(e.RTCPeerConnection){var t=r.detectBrowser(e);if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return c(e);var n=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this,t=n.apply(this);return this._reverseStreams=this._reverseStreams||{},t.map((function(t){return e._reverseStreams[t.id]}))};var i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){var n=this;if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.getTracks().forEach((function(e){if(n.getSenders().find((function(t){return t.track===e})))throw new DOMException("Track already exists.","InvalidAccessError")})),!this._reverseStreams[t.id]){var r=new e.MediaStream(t.getTracks());this._streams[t.id]=r,this._reverseStreams[r.id]=t,t=r}i.apply(this,[t])};var o=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},o.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,n){var r=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var i=[].slice.call(arguments,1);if(1!==i.length||!i[0].getTracks().find((function(e){return e===t})))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find((function(e){return e.track===t})))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};var o=this._streams[n.id];if(o)o.addTrack(t),Promise.resolve().then((function(){r.dispatchEvent(new Event("negotiationneeded"))}));else{var a=new e.MediaStream([t]);this._streams[n.id]=a,this._reverseStreams[a.id]=n,this.addStream(a)}return this.getSenders().find((function(e){return e.track===t}))},["createOffer","createAnswer"].forEach((function(t){var n=e.RTCPeerConnection.prototype[t],r=a({},t,(function(){var e=this,t=arguments;return arguments.length&&"function"==typeof arguments[0]?n.apply(this,[function(n){var r=l(e,n);t[0].apply(null,[r])},function(e){t[1]&&t[1].apply(null,e)},arguments[2]]):n.apply(this,arguments).then((function(t){return l(e,t)}))}));e.RTCPeerConnection.prototype[t]=r[t]}));var s=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=(e=this,t=arguments[0],n=t.sdp,Object.keys(e._reverseStreams||[]).forEach((function(t){var r=e._reverseStreams[t],i=e._streams[r.id];n=n.replace(new RegExp(r.id,"g"),i.id)})),new RTCSessionDescription({type:t.type,sdp:n})),s.apply(this,arguments)):s.apply(this,arguments);var e,t,n};var u=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get:function(){var e=u.get.apply(this);return""===e.type?e:l(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){var t,n=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(e._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{},Object.keys(this._streams).forEach((function(r){n._streams[r].getTracks().find((function(t){return e.track===t}))&&(t=n._streams[r])})),t&&(1===t.getTracks().length?this.removeStream(this._reverseStreams[t.id]):t.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}}function l(e,t){var n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((function(t){var r=e._reverseStreams[t],i=e._streams[r.id];n=n.replace(new RegExp(i.id,"g"),r.id)})),new RTCSessionDescription({type:t.type,sdp:n})}},n.shimPeerConnection=function(e){var t=r.detectBrowser(e);if(!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection){t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){var n=e.RTCPeerConnection.prototype[t],r=a({},t,(function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}));e.RTCPeerConnection.prototype[t]=r[t]}));var n=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?t.version<78&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}},n.fixNegotiationNeeded=function(e){r.wrapPeerConnectionEvent(e,"negotiationneeded",(function(e){if("stable"===e.target.signalingState)return e}))},Object.defineProperty(n,"shimGetUserMedia",{enumerable:!0,get:function(){return i.shimGetUserMedia}}),Object.defineProperty(n,"shimGetDisplayMedia",{enumerable:!0,get:function(){return o.shimGetDisplayMedia}});var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}(e("../utils.js")),i=e("./getusermedia"),o=e("./getdisplaymedia");function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map((function(t){return e._shimmedLocalStreams[t][0]}))};var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){if(!n)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var r=t.apply(this,arguments);return this._shimmedLocalStreams[n.id]?-1===this._shimmedLocalStreams[n.id].indexOf(r)&&this._shimmedLocalStreams[n.id].push(r):this._shimmedLocalStreams[n.id]=[n,r],r};var n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var t=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach((function(e){if(t.getSenders().find((function(t){return t.track===e})))throw new DOMException("Track already exists.","InvalidAccessError")}));var r=this.getSenders();n.apply(this,arguments);var i=this.getSenders().filter((function(e){return-1===r.indexOf(e)}));this._shimmedLocalStreams[e.id]=[e].concat(i)};var r=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],r.apply(this,arguments)};var i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach((function(n){var r=t._shimmedLocalStreams[n].indexOf(e);-1!==r&&t._shimmedLocalStreams[n].splice(r,1),1===t._shimmedLocalStreams[n].length&&delete t._shimmedLocalStreams[n]})),i.apply(this,arguments)}}},{"../utils.js":"iSxC","./getusermedia":"s6SN","./getdisplaymedia":"VHa8"}],"6NZ1":[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.filterIceServers=function(e,t){var n=!1;return(e=JSON.parse(JSON.stringify(e))).filter((function(e){if(e&&(e.urls||e.url)){var t=e.urls||e.url;e.url&&!e.urls&&r.deprecated("RTCIceServer.url","RTCIceServer.urls");var i="string"==typeof t;return i&&(t=[t]),t=t.filter((function(e){if(0===e.indexOf("stun:"))return!1;var t=e.startsWith("turn")&&!e.startsWith("turn:[")&&e.includes("transport=udp");return t&&!n?(n=!0,!0):t&&!n})),delete e.url,e.urls=i?t[0]:t,!!t.length}}))};var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}(e("../utils"))},{"../utils":"iSxC"}],YHvh:[function(e,t,n){var r={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};r.localCName=r.generateIdentifier(),r.splitLines=function(e){return e.trim().split("\n").map((function(e){return e.trim()}))},r.splitSections=function(e){return e.split("\nm=").map((function(e,t){return(t>0?"m="+e:e).trim()+"\r\n"}))},r.getDescription=function(e){var t=r.splitSections(e);return t&&t[0]},r.getMediaSections=function(e){var t=r.splitSections(e);return t.shift(),t},r.matchPrefix=function(e,t){return r.splitLines(e).filter((function(e){return 0===e.indexOf(t)}))},r.parseCandidate=function(e){for(var t,n={foundation:(t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" "))[0],component:parseInt(t[1],10),protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]},r=8;r<t.length;r+=2)switch(t[r]){case"raddr":n.relatedAddress=t[r+1];break;case"rport":n.relatedPort=parseInt(t[r+1],10);break;case"tcptype":n.tcpType=t[r+1];break;case"ufrag":n.ufrag=t[r+1],n.usernameFragment=t[r+1];break;default:n[t[r]]=t[r+1]}return n},r.writeCandidate=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);var n=e.type;return t.push("typ"),t.push(n),"host"!==n&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},r.parseIceOptions=function(e){return e.substr(14).split(" ")},r.parseRtpMap=function(e){var t=e.substr(9).split(" "),n={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),n.name=t[0],n.clockRate=parseInt(t[1],10),n.channels=3===t.length?parseInt(t[2],10):1,n.numChannels=n.channels,n},r.writeRtpMap=function(e){var t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);var n=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==n?"/"+n:"")+"\r\n"},r.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1]}},r.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},r.parseFmtp=function(e){for(var t,n={},r=e.substr(e.indexOf(" ")+1).split(";"),i=0;i<r.length;i++)n[(t=r[i].trim().split("="))[0].trim()]=t[1];return n},r.writeFmtp=function(e){var t="",n=e.payloadType;if(void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){var r=[];Object.keys(e.parameters).forEach((function(t){e.parameters[t]?r.push(t+"="+e.parameters[t]):r.push(t)})),t+="a=fmtp:"+n+" "+r.join(";")+"\r\n"}return t},r.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},r.writeRtcpFb=function(e){var t="",n=e.payloadType;return void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach((function(e){t+="a=rtcp-fb:"+n+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"})),t},r.parseSsrcMedia=function(e){var t=e.indexOf(" "),n={ssrc:parseInt(e.substr(7,t-7),10)},r=e.indexOf(":",t);return r>-1?(n.attribute=e.substr(t+1,r-t-1),n.value=e.substr(r+1)):n.attribute=e.substr(t+1),n},r.parseSsrcGroup=function(e){var t=e.substr(13).split(" ");return{semantics:t.shift(),ssrcs:t.map((function(e){return parseInt(e,10)}))}},r.getMid=function(e){var t=r.matchPrefix(e,"a=mid:")[0];if(t)return t.substr(6)},r.parseFingerprint=function(e){var t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1]}},r.getDtlsParameters=function(e,t){return{role:"auto",fingerprints:r.matchPrefix(e+t,"a=fingerprint:").map(r.parseFingerprint)}},r.writeDtlsParameters=function(e,t){var n="a=setup:"+t+"\r\n";return e.fingerprints.forEach((function(e){n+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"})),n},r.getIceParameters=function(e,t){var n=r.splitLines(e);return{usernameFragment:(n=n.concat(r.splitLines(t))).filter((function(e){return 0===e.indexOf("a=ice-ufrag:")}))[0].substr(12),password:n.filter((function(e){return 0===e.indexOf("a=ice-pwd:")}))[0].substr(10)}},r.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n"},r.parseRtpParameters=function(e){for(var t={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},n=r.splitLines(e)[0].split(" "),i=3;i<n.length;i++){var o=n[i],a=r.matchPrefix(e,"a=rtpmap:"+o+" ")[0];if(a){var s=r.parseRtpMap(a),c=r.matchPrefix(e,"a=fmtp:"+o+" ");switch(s.parameters=c.length?r.parseFmtp(c[0]):{},s.rtcpFeedback=r.matchPrefix(e,"a=rtcp-fb:"+o+" ").map(r.parseRtcpFb),t.codecs.push(s),s.name.toUpperCase()){case"RED":case"ULPFEC":t.fecMechanisms.push(s.name.toUpperCase())}}}return r.matchPrefix(e,"a=extmap:").forEach((function(e){t.headerExtensions.push(r.parseExtmap(e))})),t},r.writeRtpDescription=function(e,t){var n="";n+="m="+e+" ",n+=t.codecs.length>0?"9":"0",n+=" UDP/TLS/RTP/SAVPF ",n+=t.codecs.map((function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType})).join(" ")+"\r\n",n+="c=IN IP4 0.0.0.0\r\n",n+="a=rtcp:9 IN IP4 0.0.0.0\r\n",t.codecs.forEach((function(e){n+=r.writeRtpMap(e),n+=r.writeFmtp(e),n+=r.writeRtcpFb(e)}));var i=0;return t.codecs.forEach((function(e){e.maxptime>i&&(i=e.maxptime)})),i>0&&(n+="a=maxptime:"+i+"\r\n"),n+="a=rtcp-mux\r\n",t.headerExtensions&&t.headerExtensions.forEach((function(e){n+=r.writeExtmap(e)})),n},r.parseRtpEncodingParameters=function(e){var t,n=[],i=r.parseRtpParameters(e),o=-1!==i.fecMechanisms.indexOf("RED"),a=-1!==i.fecMechanisms.indexOf("ULPFEC"),s=r.matchPrefix(e,"a=ssrc:").map((function(e){return r.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute})),c=s.length>0&&s[0].ssrc,u=r.matchPrefix(e,"a=ssrc-group:FID").map((function(e){return e.substr(17).split(" ").map((function(e){return parseInt(e,10)}))}));u.length>0&&u[0].length>1&&u[0][0]===c&&(t=u[0][1]),i.codecs.forEach((function(e){if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var r={ssrc:c,codecPayloadType:parseInt(e.parameters.apt,10)};c&&t&&(r.rtx={ssrc:t}),n.push(r),o&&((r=JSON.parse(JSON.stringify(r))).fec={ssrc:c,mechanism:a?"red+ulpfec":"red"},n.push(r))}})),0===n.length&&c&&n.push({ssrc:c});var l=r.matchPrefix(e,"b=");return l.length&&(l=0===l[0].indexOf("b=TIAS:")?parseInt(l[0].substr(7),10):0===l[0].indexOf("b=AS:")?1e3*parseInt(l[0].substr(5),10)*.95-16e3:void 0,n.forEach((function(e){e.maxBitrate=l}))),n},r.parseRtcpParameters=function(e){var t={},n=r.matchPrefix(e,"a=ssrc:").map((function(e){return r.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute}))[0];n&&(t.cname=n.value,t.ssrc=n.ssrc);var i=r.matchPrefix(e,"a=rtcp-rsize");t.reducedSize=i.length>0,t.compound=0===i.length;var o=r.matchPrefix(e,"a=rtcp-mux");return t.mux=o.length>0,t},r.parseMsid=function(e){var t,n=r.matchPrefix(e,"a=msid:");if(1===n.length)return{stream:(t=n[0].substr(7).split(" "))[0],track:t[1]};var i=r.matchPrefix(e,"a=ssrc:").map((function(e){return r.parseSsrcMedia(e)})).filter((function(e){return"msid"===e.attribute}));return i.length>0?{stream:(t=i[0].value.split(" "))[0],track:t[1]}:void 0},r.parseSctpDescription=function(e){var t,n=r.parseMLine(e),i=r.matchPrefix(e,"a=max-message-size:");i.length>0&&(t=parseInt(i[0].substr(19),10)),isNaN(t)&&(t=65536);var o=r.matchPrefix(e,"a=sctp-port:");if(o.length>0)return{port:parseInt(o[0].substr(12),10),protocol:n.fmt,maxMessageSize:t};if(r.matchPrefix(e,"a=sctpmap:").length>0){var a=r.matchPrefix(e,"a=sctpmap:")[0].substr(10).split(" ");return{port:parseInt(a[0],10),protocol:a[1],maxMessageSize:t}}},r.writeSctpDescription=function(e,t){var n=[];return n="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"],void 0!==t.maxMessageSize&&n.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),n.join("")},r.generateSessionId=function(){return Math.random().toString().substr(2,21)},r.writeSessionBoilerplate=function(e,t,n){var i=void 0!==t?t:2;return"v=0\r\no="+(n||"thisisadapterortc")+" "+(e||r.generateSessionId())+" "+i+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},r.writeMediaSection=function(e,t,n,i){var o=r.writeRtpDescription(e.kind,t);if(o+=r.writeIceParameters(e.iceGatherer.getLocalParameters()),o+=r.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":"active"),o+="a=mid:"+e.mid+"\r\n",e.direction?o+="a="+e.direction+"\r\n":e.rtpSender&&e.rtpReceiver?o+="a=sendrecv\r\n":e.rtpSender?o+="a=sendonly\r\n":e.rtpReceiver?o+="a=recvonly\r\n":o+="a=inactive\r\n",e.rtpSender){var a="msid:"+i.id+" "+e.rtpSender.track.id+"\r\n";o+="a="+a,o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+a,e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+a,o+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+r.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+r.localCName+"\r\n"),o},r.getDirection=function(e,t){for(var n=r.splitLines(e),i=0;i<n.length;i++)switch(n[i]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return n[i].substr(2)}return t?r.getDirection(t):"sendrecv"},r.getKind=function(e){return r.splitLines(e)[0].split(" ")[0].substr(2)},r.isRejected=function(e){return"0"===e.split(" ",2)[1]},r.parseMLine=function(e){var t=r.splitLines(e)[0].substr(2).split(" ");return{kind:t[0],port:parseInt(t[1],10),protocol:t[2],fmt:t.slice(3).join(" ")}},r.parseOLine=function(e){var t=r.matchPrefix(e,"o=")[0].substr(2).split(" ");return{username:t[0],sessionId:t[1],sessionVersion:parseInt(t[2],10),netType:t[3],addressType:t[4],address:t[5]}},r.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;for(var t=r.splitLines(e),n=0;n<t.length;n++)if(t[n].length<2||"="!==t[n].charAt(1))return!1;return!0},"object"==typeof t&&(t.exports=r)},{}],NJ2u:[function(e,t,n){var r=e("sdp");function i(e,t,n,i,o){var a=r.writeRtpDescription(e.kind,t);if(a+=r.writeIceParameters(e.iceGatherer.getLocalParameters()),a+=r.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":o||"active"),a+="a=mid:"+e.mid+"\r\n",e.rtpSender&&e.rtpReceiver?a+="a=sendrecv\r\n":e.rtpSender?a+="a=sendonly\r\n":e.rtpReceiver?a+="a=recvonly\r\n":a+="a=inactive\r\n",e.rtpSender){var s=e.rtpSender._initialTrackId||e.rtpSender.track.id;e.rtpSender._initialTrackId=s;var c="msid:"+(i?i.id:"-")+" "+s+"\r\n";a+="a="+c,a+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+c,e.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+c,a+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return a+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+r.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+r.localCName+"\r\n"),a}function o(e,t){var n={codecs:[],headerExtensions:[],fecMechanisms:[]},r=function(e,t){e=parseInt(e,10);for(var n=0;n<t.length;n++)if(t[n].payloadType===e||t[n].preferredPayloadType===e)return t[n]},i=function(e,t,n,i){var o=r(e.parameters.apt,n),a=r(t.parameters.apt,i);return o&&a&&o.name.toLowerCase()===a.name.toLowerCase()};return e.codecs.forEach((function(r){for(var o=0;o<t.codecs.length;o++){var a=t.codecs[o];if(r.name.toLowerCase()===a.name.toLowerCase()&&r.clockRate===a.clockRate){if("rtx"===r.name.toLowerCase()&&r.parameters&&a.parameters.apt&&!i(r,a,e.codecs,t.codecs))continue;(a=JSON.parse(JSON.stringify(a))).numChannels=Math.min(r.numChannels,a.numChannels),n.codecs.push(a),a.rtcpFeedback=a.rtcpFeedback.filter((function(e){for(var t=0;t<r.rtcpFeedback.length;t++)if(r.rtcpFeedback[t].type===e.type&&r.rtcpFeedback[t].parameter===e.parameter)return!0;return!1}));break}}})),e.headerExtensions.forEach((function(e){for(var r=0;r<t.headerExtensions.length;r++){var i=t.headerExtensions[r];if(e.uri===i.uri){n.headerExtensions.push(i);break}}})),n}function a(e,t,n){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[t][e].indexOf(n)}function s(e,t){var n=e.getRemoteCandidates().find((function(e){return t.foundation===e.foundation&&t.ip===e.ip&&t.port===e.port&&t.priority===e.priority&&t.protocol===e.protocol&&t.type===e.type}));return n||e.addRemoteCandidate(t),!n}function c(e,t){var n=new Error(t);return n.name=e,n.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[e],n}t.exports=function(e,t){function n(t,n){n.addTrack(t),n.dispatchEvent(new e.MediaStreamTrackEvent("addtrack",{track:t}))}function u(t,n,r,i){var o=new Event("track");o.track=n,o.receiver=r,o.transceiver={receiver:r},o.streams=i,e.setTimeout((function(){t._dispatchEvent("track",o)}))}var l=function(n){var i=this,o=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach((function(e){i[e]=o[e].bind(o)})),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",n=JSON.parse(JSON.stringify(n||{})),this.usingBundle="max-bundle"===n.bundlePolicy,"negotiate"===n.rtcpMuxPolicy)throw c("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(n.rtcpMuxPolicy||(n.rtcpMuxPolicy="require"),n.iceTransportPolicy){case"all":case"relay":break;default:n.iceTransportPolicy="all"}switch(n.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:n.bundlePolicy="balanced"}if(n.iceServers=function(e,t){var n=!1;return(e=JSON.parse(JSON.stringify(e))).filter((function(e){if(e&&(e.urls||e.url)){var r=e.urls||e.url;e.url&&!e.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var i="string"==typeof r;return i&&(r=[r]),r=r.filter((function(e){return 0!==e.indexOf("turn:")||-1===e.indexOf("transport=udp")||-1!==e.indexOf("turn:[")||n?0===e.indexOf("stun:")&&t>=14393&&-1===e.indexOf("?transport=udp"):(n=!0,!0)})),delete e.url,e.urls=i?r[0]:r,!!r.length}}))}(n.iceServers||[],t),this._iceGatherers=[],n.iceCandidatePoolSize)for(var a=n.iceCandidatePoolSize;a>0;a--)this._iceGatherers.push(new e.RTCIceGatherer({iceServers:n.iceServers,gatherPolicy:n.iceTransportPolicy}));else n.iceCandidatePoolSize=0;this._config=n,this.transceivers=[],this._sdpSessionId=r.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(l.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(l.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),l.prototype.onicecandidate=null,l.prototype.onaddstream=null,l.prototype.ontrack=null,l.prototype.onremovestream=null,l.prototype.onsignalingstatechange=null,l.prototype.oniceconnectionstatechange=null,l.prototype.onconnectionstatechange=null,l.prototype.onicegatheringstatechange=null,l.prototype.onnegotiationneeded=null,l.prototype.ondatachannel=null,l.prototype._dispatchEvent=function(e,t){this._isClosed||(this.dispatchEvent(t),"function"==typeof this["on"+e]&&this["on"+e](t))},l.prototype._emitGatheringStateChange=function(){var e=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",e)},l.prototype.getConfiguration=function(){return this._config},l.prototype.getLocalStreams=function(){return this.localStreams},l.prototype.getRemoteStreams=function(){return this.remoteStreams},l.prototype._createTransceiver=function(e,t){var n=this.transceivers.length>0,r={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:e,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&n)r.iceTransport=this.transceivers[0].iceTransport,r.dtlsTransport=this.transceivers[0].dtlsTransport;else{var i=this._createIceAndDtlsTransports();r.iceTransport=i.iceTransport,r.dtlsTransport=i.dtlsTransport}return t||this.transceivers.push(r),r},l.prototype.addTrack=function(t,n){if(this._isClosed)throw c("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var r;if(this.transceivers.find((function(e){return e.track===t})))throw c("InvalidAccessError","Track already exists.");for(var i=0;i<this.transceivers.length;i++)this.transceivers[i].track||this.transceivers[i].kind!==t.kind||(r=this.transceivers[i]);return r||(r=this._createTransceiver(t.kind)),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(n)&&this.localStreams.push(n),r.track=t,r.stream=n,r.rtpSender=new e.RTCRtpSender(t,r.dtlsTransport),r.rtpSender},l.prototype.addStream=function(e){var n=this;if(t>=15025)e.getTracks().forEach((function(t){n.addTrack(t,e)}));else{var r=e.clone();e.getTracks().forEach((function(e,t){var n=r.getTracks()[t];e.addEventListener("enabled",(function(e){n.enabled=e.enabled}))})),r.getTracks().forEach((function(e){n.addTrack(e,r)}))}},l.prototype.removeTrack=function(t){if(this._isClosed)throw c("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(t instanceof e.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var n=this.transceivers.find((function(e){return e.rtpSender===t}));if(!n)throw c("InvalidAccessError","Sender was not created by this connection.");var r=n.stream;n.rtpSender.stop(),n.rtpSender=null,n.track=null,n.stream=null,-1===this.transceivers.map((function(e){return e.stream})).indexOf(r)&&this.localStreams.indexOf(r)>-1&&this.localStreams.splice(this.localStreams.indexOf(r),1),this._maybeFireNegotiationNeeded()},l.prototype.removeStream=function(e){var t=this;e.getTracks().forEach((function(e){var n=t.getSenders().find((function(t){return t.track===e}));n&&t.removeTrack(n)}))},l.prototype.getSenders=function(){return this.transceivers.filter((function(e){return!!e.rtpSender})).map((function(e){return e.rtpSender}))},l.prototype.getReceivers=function(){return this.transceivers.filter((function(e){return!!e.rtpReceiver})).map((function(e){return e.rtpReceiver}))},l.prototype._createIceGatherer=function(t,n){var r=this;if(n&&t>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var i=new e.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(i,"state",{value:"new",writable:!0}),this.transceivers[t].bufferedCandidateEvents=[],this.transceivers[t].bufferCandidates=function(e){var n=!e.candidate||0===Object.keys(e.candidate).length;i.state=n?"completed":"gathering",null!==r.transceivers[t].bufferedCandidateEvents&&r.transceivers[t].bufferedCandidateEvents.push(e)},i.addEventListener("localcandidate",this.transceivers[t].bufferCandidates),i},l.prototype._gather=function(t,n){var i=this,o=this.transceivers[n].iceGatherer;if(!o.onlocalcandidate){var a=this.transceivers[n].bufferedCandidateEvents;this.transceivers[n].bufferedCandidateEvents=null,o.removeEventListener("localcandidate",this.transceivers[n].bufferCandidates),o.onlocalcandidate=function(e){if(!(i.usingBundle&&n>0)){var a=new Event("icecandidate");a.candidate={sdpMid:t,sdpMLineIndex:n};var s=e.candidate,c=!s||0===Object.keys(s).length;if(c)"new"!==o.state&&"gathering"!==o.state||(o.state="completed");else{"new"===o.state&&(o.state="gathering"),s.component=1,s.ufrag=o.getLocalParameters().usernameFragment;var u=r.writeCandidate(s);a.candidate=Object.assign(a.candidate,r.parseCandidate(u)),a.candidate.candidate=u,a.candidate.toJSON=function(){return{candidate:a.candidate.candidate,sdpMid:a.candidate.sdpMid,sdpMLineIndex:a.candidate.sdpMLineIndex,usernameFragment:a.candidate.usernameFragment}}}var l=r.getMediaSections(i._localDescription.sdp);l[a.candidate.sdpMLineIndex]+=c?"a=end-of-candidates\r\n":"a="+a.candidate.candidate+"\r\n",i._localDescription.sdp=r.getDescription(i._localDescription.sdp)+l.join("");var f=i.transceivers.every((function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state}));"gathering"!==i.iceGatheringState&&(i.iceGatheringState="gathering",i._emitGatheringStateChange()),c||i._dispatchEvent("icecandidate",a),f&&(i._dispatchEvent("icecandidate",new Event("icecandidate")),i.iceGatheringState="complete",i._emitGatheringStateChange())}},e.setTimeout((function(){a.forEach((function(e){o.onlocalcandidate(e)}))}),0)}},l.prototype._createIceAndDtlsTransports=function(){var t=this,n=new e.RTCIceTransport(null);n.onicestatechange=function(){t._updateIceConnectionState(),t._updateConnectionState()};var r=new e.RTCDtlsTransport(n);return r.ondtlsstatechange=function(){t._updateConnectionState()},r.onerror=function(){Object.defineProperty(r,"state",{value:"failed",writable:!0}),t._updateConnectionState()},{iceTransport:n,dtlsTransport:r}},l.prototype._disposeIceAndDtlsTransports=function(e){var t=this.transceivers[e].iceGatherer;t&&(delete t.onlocalcandidate,delete this.transceivers[e].iceGatherer);var n=this.transceivers[e].iceTransport;n&&(delete n.onicestatechange,delete this.transceivers[e].iceTransport);var r=this.transceivers[e].dtlsTransport;r&&(delete r.ondtlsstatechange,delete r.onerror,delete this.transceivers[e].dtlsTransport)},l.prototype._transceive=function(e,n,i){var a=o(e.localCapabilities,e.remoteCapabilities);n&&e.rtpSender&&(a.encodings=e.sendEncodingParameters,a.rtcp={cname:r.localCName,compound:e.rtcpParameters.compound},e.recvEncodingParameters.length&&(a.rtcp.ssrc=e.recvEncodingParameters[0].ssrc),e.rtpSender.send(a)),i&&e.rtpReceiver&&a.codecs.length>0&&("video"===e.kind&&e.recvEncodingParameters&&t<15019&&e.recvEncodingParameters.forEach((function(e){delete e.rtx})),e.recvEncodingParameters.length?a.encodings=e.recvEncodingParameters:a.encodings=[{}],a.rtcp={compound:e.rtcpParameters.compound},e.rtcpParameters.cname&&(a.rtcp.cname=e.rtcpParameters.cname),e.sendEncodingParameters.length&&(a.rtcp.ssrc=e.sendEncodingParameters[0].ssrc),e.rtpReceiver.receive(a))},l.prototype.setLocalDescription=function(e){var t,n,i=this;if(-1===["offer","answer"].indexOf(e.type))return Promise.reject(c("TypeError",'Unsupported type "'+e.type+'"'));if(!a("setLocalDescription",e.type,i.signalingState)||i._isClosed)return Promise.reject(c("InvalidStateError","Can not set local "+e.type+" in state "+i.signalingState));if("offer"===e.type)t=r.splitSections(e.sdp),n=t.shift(),t.forEach((function(e,t){var n=r.parseRtpParameters(e);i.transceivers[t].localCapabilities=n})),i.transceivers.forEach((function(e,t){i._gather(e.mid,t)}));else if("answer"===e.type){t=r.splitSections(i._remoteDescription.sdp),n=t.shift();var s=r.matchPrefix(n,"a=ice-lite").length>0;t.forEach((function(e,t){var a=i.transceivers[t],c=a.iceGatherer,u=a.iceTransport,l=a.dtlsTransport,f=a.localCapabilities,h=a.remoteCapabilities;if(!(r.isRejected(e)&&0===r.matchPrefix(e,"a=bundle-only").length||a.rejected)){var p=r.getIceParameters(e,n),d=r.getDtlsParameters(e,n);s&&(d.role="server"),i.usingBundle&&0!==t||(i._gather(a.mid,t),"new"===u.state&&u.start(c,p,s?"controlling":"controlled"),"new"===l.state&&l.start(d));var v=o(f,h);i._transceive(a,v.codecs.length>0,!1)}}))}return i._localDescription={type:e.type,sdp:e.sdp},"offer"===e.type?i._updateSignalingState("have-local-offer"):i._updateSignalingState("stable"),Promise.resolve()},l.prototype.setRemoteDescription=function(i){var l=this;if(-1===["offer","answer"].indexOf(i.type))return Promise.reject(c("TypeError",'Unsupported type "'+i.type+'"'));if(!a("setRemoteDescription",i.type,l.signalingState)||l._isClosed)return Promise.reject(c("InvalidStateError","Can not set remote "+i.type+" in state "+l.signalingState));var f={};l.remoteStreams.forEach((function(e){f[e.id]=e}));var h=[],p=r.splitSections(i.sdp),d=p.shift(),v=r.matchPrefix(d,"a=ice-lite").length>0,y=r.matchPrefix(d,"a=group:BUNDLE ").length>0;l.usingBundle=y;var m=r.matchPrefix(d,"a=ice-options:")[0];return l.canTrickleIceCandidates=!!m&&m.substr(14).split(" ").indexOf("trickle")>=0,p.forEach((function(a,c){var u=r.splitLines(a),p=r.getKind(a),m=r.isRejected(a)&&0===r.matchPrefix(a,"a=bundle-only").length,g=u[0].substr(2).split(" ")[2],b=r.getDirection(a,d),_=r.parseMsid(a),w=r.getMid(a)||r.generateIdentifier();if(m||"application"===p&&("DTLS/SCTP"===g||"UDP/DTLS/SCTP"===g))l.transceivers[c]={mid:w,kind:p,protocol:g,rejected:!0};else{var S,C,k,x,T,P,E,O,R;!m&&l.transceivers[c]&&l.transceivers[c].rejected&&(l.transceivers[c]=l._createTransceiver(p,!0));var M,j,D=r.parseRtpParameters(a);m||(M=r.getIceParameters(a,d),(j=r.getDtlsParameters(a,d)).role="client"),E=r.parseRtpEncodingParameters(a);var I=r.parseRtcpParameters(a),A=r.matchPrefix(a,"a=end-of-candidates",d).length>0,L=r.matchPrefix(a,"a=candidate:").map((function(e){return r.parseCandidate(e)})).filter((function(e){return 1===e.component}));if(("offer"===i.type||"answer"===i.type)&&!m&&y&&c>0&&l.transceivers[c]&&(l._disposeIceAndDtlsTransports(c),l.transceivers[c].iceGatherer=l.transceivers[0].iceGatherer,l.transceivers[c].iceTransport=l.transceivers[0].iceTransport,l.transceivers[c].dtlsTransport=l.transceivers[0].dtlsTransport,l.transceivers[c].rtpSender&&l.transceivers[c].rtpSender.setTransport(l.transceivers[0].dtlsTransport),l.transceivers[c].rtpReceiver&&l.transceivers[c].rtpReceiver.setTransport(l.transceivers[0].dtlsTransport)),"offer"!==i.type||m)"answer"!==i.type||m||(C=(S=l.transceivers[c]).iceGatherer,k=S.iceTransport,x=S.dtlsTransport,T=S.rtpReceiver,P=S.sendEncodingParameters,O=S.localCapabilities,l.transceivers[c].recvEncodingParameters=E,l.transceivers[c].remoteCapabilities=D,l.transceivers[c].rtcpParameters=I,L.length&&"new"===k.state&&(!v&&!A||y&&0!==c?L.forEach((function(e){s(S.iceTransport,e)})):k.setRemoteCandidates(L)),y&&0!==c||("new"===k.state&&k.start(C,M,"controlling"),"new"===x.state&&x.start(j)),!o(S.localCapabilities,S.remoteCapabilities).codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length&&S.sendEncodingParameters[0].rtx&&delete S.sendEncodingParameters[0].rtx,l._transceive(S,"sendrecv"===b||"recvonly"===b,"sendrecv"===b||"sendonly"===b),!T||"sendrecv"!==b&&"sendonly"!==b?delete S.rtpReceiver:(R=T.track,_?(f[_.stream]||(f[_.stream]=new e.MediaStream),n(R,f[_.stream]),h.push([R,T,f[_.stream]])):(f.default||(f.default=new e.MediaStream),n(R,f.default),h.push([R,T,f.default]))));else{(S=l.transceivers[c]||l._createTransceiver(p)).mid=w,S.iceGatherer||(S.iceGatherer=l._createIceGatherer(c,y)),L.length&&"new"===S.iceTransport.state&&(!A||y&&0!==c?L.forEach((function(e){s(S.iceTransport,e)})):S.iceTransport.setRemoteCandidates(L)),O=e.RTCRtpReceiver.getCapabilities(p),t<15019&&(O.codecs=O.codecs.filter((function(e){return"rtx"!==e.name}))),P=S.sendEncodingParameters||[{ssrc:1001*(2*c+2)}];var N,B=!1;"sendrecv"===b||"sendonly"===b?(B=!S.rtpReceiver,T=S.rtpReceiver||new e.RTCRtpReceiver(S.dtlsTransport,p),B&&(R=T.track,_&&"-"===_.stream||(_?(f[_.stream]||(f[_.stream]=new e.MediaStream,Object.defineProperty(f[_.stream],"id",{get:function(){return _.stream}})),Object.defineProperty(R,"id",{get:function(){return _.track}}),N=f[_.stream]):(f.default||(f.default=new e.MediaStream),N=f.default)),N&&(n(R,N),S.associatedRemoteMediaStreams.push(N)),h.push([R,T,N]))):S.rtpReceiver&&S.rtpReceiver.track&&(S.associatedRemoteMediaStreams.forEach((function(t){var n,r,i=t.getTracks().find((function(e){return e.id===S.rtpReceiver.track.id}));i&&(n=i,(r=t).removeTrack(n),r.dispatchEvent(new e.MediaStreamTrackEvent("removetrack",{track:n})))})),S.associatedRemoteMediaStreams=[]),S.localCapabilities=O,S.remoteCapabilities=D,S.rtpReceiver=T,S.rtcpParameters=I,S.sendEncodingParameters=P,S.recvEncodingParameters=E,l._transceive(l.transceivers[c],!1,B)}}})),void 0===l._dtlsRole&&(l._dtlsRole="offer"===i.type?"active":"passive"),l._remoteDescription={type:i.type,sdp:i.sdp},"offer"===i.type?l._updateSignalingState("have-remote-offer"):l._updateSignalingState("stable"),Object.keys(f).forEach((function(t){var n=f[t];if(n.getTracks().length){if(-1===l.remoteStreams.indexOf(n)){l.remoteStreams.push(n);var r=new Event("addstream");r.stream=n,e.setTimeout((function(){l._dispatchEvent("addstream",r)}))}h.forEach((function(e){var t=e[0],r=e[1];n.id===e[2].id&&u(l,t,r,[n])}))}})),h.forEach((function(e){e[2]||u(l,e[0],e[1],[])})),e.setTimeout((function(){l&&l.transceivers&&l.transceivers.forEach((function(e){e.iceTransport&&"new"===e.iceTransport.state&&e.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),e.iceTransport.addRemoteCandidate({}))}))}),4e3),Promise.resolve()},l.prototype.close=function(){this.transceivers.forEach((function(e){e.iceTransport&&e.iceTransport.stop(),e.dtlsTransport&&e.dtlsTransport.stop(),e.rtpSender&&e.rtpSender.stop(),e.rtpReceiver&&e.rtpReceiver.stop()})),this._isClosed=!0,this._updateSignalingState("closed")},l.prototype._updateSignalingState=function(e){this.signalingState=e;var t=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",t)},l.prototype._maybeFireNegotiationNeeded=function(){var t=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,e.setTimeout((function(){if(t.needNegotiation){t.needNegotiation=!1;var e=new Event("negotiationneeded");t._dispatchEvent("negotiationneeded",e)}}),0))},l.prototype._updateIceConnectionState=function(){var e,t={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&!e.rejected&&t[e.iceTransport.state]++})),e="new",t.failed>0?e="failed":t.checking>0?e="checking":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0?e="connected":t.completed>0&&(e="completed"),e!==this.iceConnectionState){this.iceConnectionState=e;var n=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",n)}},l.prototype._updateConnectionState=function(){var e,t={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&e.dtlsTransport&&!e.rejected&&(t[e.iceTransport.state]++,t[e.dtlsTransport.state]++)})),t.connected+=t.completed,e="new",t.failed>0?e="failed":t.connecting>0?e="connecting":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0&&(e="connected"),e!==this.connectionState){this.connectionState=e;var n=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",n)}},l.prototype.createOffer=function(){var n=this;if(n._isClosed)return Promise.reject(c("InvalidStateError","Can not call createOffer after close"));var o=n.transceivers.filter((function(e){return"audio"===e.kind})).length,a=n.transceivers.filter((function(e){return"video"===e.kind})).length,s=arguments[0];if(s){if(s.mandatory||s.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==s.offerToReceiveAudio&&(o=!0===s.offerToReceiveAudio?1:!1===s.offerToReceiveAudio?0:s.offerToReceiveAudio),void 0!==s.offerToReceiveVideo&&(a=!0===s.offerToReceiveVideo?1:!1===s.offerToReceiveVideo?0:s.offerToReceiveVideo)}for(n.transceivers.forEach((function(e){"audio"===e.kind?--o<0&&(e.wantReceive=!1):"video"===e.kind&&--a<0&&(e.wantReceive=!1)}));o>0||a>0;)o>0&&(n._createTransceiver("audio"),o--),a>0&&(n._createTransceiver("video"),a--);var u=r.writeSessionBoilerplate(n._sdpSessionId,n._sdpSessionVersion++);n.transceivers.forEach((function(i,o){var a=i.track,s=i.kind,c=i.mid||r.generateIdentifier();i.mid=c,i.iceGatherer||(i.iceGatherer=n._createIceGatherer(o,n.usingBundle));var u=e.RTCRtpSender.getCapabilities(s);t<15019&&(u.codecs=u.codecs.filter((function(e){return"rtx"!==e.name}))),u.codecs.forEach((function(e){"H264"===e.name&&void 0===e.parameters["level-asymmetry-allowed"]&&(e.parameters["level-asymmetry-allowed"]="1"),i.remoteCapabilities&&i.remoteCapabilities.codecs&&i.remoteCapabilities.codecs.forEach((function(t){e.name.toLowerCase()===t.name.toLowerCase()&&e.clockRate===t.clockRate&&(e.preferredPayloadType=t.payloadType)}))})),u.headerExtensions.forEach((function(e){(i.remoteCapabilities&&i.remoteCapabilities.headerExtensions||[]).forEach((function(t){e.uri===t.uri&&(e.id=t.id)}))}));var l=i.sendEncodingParameters||[{ssrc:1001*(2*o+1)}];a&&t>=15019&&"video"===s&&!l[0].rtx&&(l[0].rtx={ssrc:l[0].ssrc+1}),i.wantReceive&&(i.rtpReceiver=new e.RTCRtpReceiver(i.dtlsTransport,s)),i.localCapabilities=u,i.sendEncodingParameters=l})),"max-compat"!==n._config.bundlePolicy&&(u+="a=group:BUNDLE "+n.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),u+="a=ice-options:trickle\r\n",n.transceivers.forEach((function(e,t){u+=i(e,e.localCapabilities,"offer",e.stream,n._dtlsRole),u+="a=rtcp-rsize\r\n",!e.iceGatherer||"new"===n.iceGatheringState||0!==t&&n.usingBundle||(e.iceGatherer.getLocalCandidates().forEach((function(e){e.component=1,u+="a="+r.writeCandidate(e)+"\r\n"})),"completed"===e.iceGatherer.state&&(u+="a=end-of-candidates\r\n"))}));var l=new e.RTCSessionDescription({type:"offer",sdp:u});return Promise.resolve(l)},l.prototype.createAnswer=function(){var n=this;if(n._isClosed)return Promise.reject(c("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==n.signalingState&&"have-local-pranswer"!==n.signalingState)return Promise.reject(c("InvalidStateError","Can not call createAnswer in signalingState "+n.signalingState));var a=r.writeSessionBoilerplate(n._sdpSessionId,n._sdpSessionVersion++);n.usingBundle&&(a+="a=group:BUNDLE "+n.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),a+="a=ice-options:trickle\r\n";var s=r.getMediaSections(n._remoteDescription.sdp).length;n.transceivers.forEach((function(e,r){if(!(r+1>s)){if(e.rejected)return"application"===e.kind?"DTLS/SCTP"===e.protocol?a+="m=application 0 DTLS/SCTP 5000\r\n":a+="m=application 0 "+e.protocol+" webrtc-datachannel\r\n":"audio"===e.kind?a+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===e.kind&&(a+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),void(a+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+e.mid+"\r\n");var c;e.stream&&("audio"===e.kind?c=e.stream.getAudioTracks()[0]:"video"===e.kind&&(c=e.stream.getVideoTracks()[0]),c&&t>=15019&&"video"===e.kind&&!e.sendEncodingParameters[0].rtx&&(e.sendEncodingParameters[0].rtx={ssrc:e.sendEncodingParameters[0].ssrc+1}));var u=o(e.localCapabilities,e.remoteCapabilities);!u.codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length&&e.sendEncodingParameters[0].rtx&&delete e.sendEncodingParameters[0].rtx,a+=i(e,u,"answer",e.stream,n._dtlsRole),e.rtcpParameters&&e.rtcpParameters.reducedSize&&(a+="a=rtcp-rsize\r\n")}}));var u=new e.RTCSessionDescription({type:"answer",sdp:a});return Promise.resolve(u)},l.prototype.addIceCandidate=function(e){var t,n=this;return e&&void 0===e.sdpMLineIndex&&!e.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise((function(i,o){if(!n._remoteDescription)return o(c("InvalidStateError","Can not add ICE candidate without a remote description"));if(e&&""!==e.candidate){var a=e.sdpMLineIndex;if(e.sdpMid)for(var u=0;u<n.transceivers.length;u++)if(n.transceivers[u].mid===e.sdpMid){a=u;break}var l=n.transceivers[a];if(!l)return o(c("OperationError","Can not add ICE candidate"));if(l.rejected)return i();var f=Object.keys(e.candidate).length>0?r.parseCandidate(e.candidate):{};if("tcp"===f.protocol&&(0===f.port||9===f.port))return i();if(f.component&&1!==f.component)return i();if((0===a||a>0&&l.iceTransport!==n.transceivers[0].iceTransport)&&!s(l.iceTransport,f))return o(c("OperationError","Can not add ICE candidate"));var h=e.candidate.trim();0===h.indexOf("a=")&&(h=h.substr(2)),(t=r.getMediaSections(n._remoteDescription.sdp))[a]+="a="+(f.type?h:"end-of-candidates")+"\r\n",n._remoteDescription.sdp=r.getDescription(n._remoteDescription.sdp)+t.join("")}else for(var p=0;p<n.transceivers.length&&(n.transceivers[p].rejected||(n.transceivers[p].iceTransport.addRemoteCandidate({}),(t=r.getMediaSections(n._remoteDescription.sdp))[p]+="a=end-of-candidates\r\n",n._remoteDescription.sdp=r.getDescription(n._remoteDescription.sdp)+t.join(""),!n.usingBundle));p++);i()}))},l.prototype.getStats=function(t){if(t&&t instanceof e.MediaStreamTrack){var n=null;if(this.transceivers.forEach((function(e){e.rtpSender&&e.rtpSender.track===t?n=e.rtpSender:e.rtpReceiver&&e.rtpReceiver.track===t&&(n=e.rtpReceiver)})),!n)throw c("InvalidAccessError","Invalid selector.");return n.getStats()}var r=[];return this.transceivers.forEach((function(e){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach((function(t){e[t]&&r.push(e[t].getStats())}))})),Promise.all(r).then((function(e){var t=new Map;return e.forEach((function(e){e.forEach((function(e){t.set(e.id,e)}))})),t}))},["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach((function(t){var n=e[t];if(n&&n.prototype&&n.prototype.getStats){var r=n.prototype.getStats;n.prototype.getStats=function(){return r.apply(this).then((function(e){var t=new Map;return Object.keys(e).forEach((function(n){e[n].type=function(e){return{inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type}(e[n]),t.set(n,e[n])})),t}))}}}));var f=["createOffer","createAnswer"];return f.forEach((function(e){var t=l.prototype[e];l.prototype[e]=function(){var e=arguments;return"function"==typeof e[0]||"function"==typeof e[1]?t.apply(this,[arguments[2]]).then((function(t){"function"==typeof e[0]&&e[0].apply(null,[t])}),(function(t){"function"==typeof e[1]&&e[1].apply(null,[t])})):t.apply(this,arguments)}})),(f=["setLocalDescription","setRemoteDescription","addIceCandidate"]).forEach((function(e){var t=l.prototype[e];l.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]||"function"==typeof e[2]?t.apply(this,arguments).then((function(){"function"==typeof e[1]&&e[1].apply(null)}),(function(t){"function"==typeof e[2]&&e[2].apply(null,[t])})):t.apply(this,arguments)}})),["getStats"].forEach((function(e){var t=l.prototype[e];l.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]?t.apply(this,arguments).then((function(){"function"==typeof e[1]&&e[1].apply(null)})):t.apply(this,arguments)}})),l}},{sdp:"YHvh"}],YdKx:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetUserMedia=function(e){var t=e&&e.navigator,n=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return n(e).catch((function(e){return Promise.reject(function(e){return{name:{PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:e.message,constraint:e.constraint,toString:function(){return this.name}}}(e))}))}}},{}],"5P3b":[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=function(e){"getDisplayMedia"in e.navigator&&e.navigator.mediaDevices&&(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||(e.navigator.mediaDevices.getDisplayMedia=e.navigator.getDisplayMedia.bind(e.navigator)))}},{}],XRic:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.shimPeerConnection=function(e){var t=r.detectBrowser(e);if(e.RTCIceGatherer&&(e.RTCIceCandidate||(e.RTCIceCandidate=function(e){return e}),e.RTCSessionDescription||(e.RTCSessionDescription=function(e){return e}),t.version<15025)){var n=Object.getOwnPropertyDescriptor(e.MediaStreamTrack.prototype,"enabled");Object.defineProperty(e.MediaStreamTrack.prototype,"enabled",{set:function(e){n.set.call(this,e);var t=new Event("enabled");t.enabled=e,this.dispatchEvent(t)}})}!e.RTCRtpSender||"dtmf"in e.RTCRtpSender.prototype||Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new e.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null)),this._dtmf}}),e.RTCDtmfSender&&!e.RTCDTMFSender&&(e.RTCDTMFSender=e.RTCDtmfSender);var a=(0,o.default)(e,t.version);e.RTCPeerConnection=function(e){return e&&e.iceServers&&(e.iceServers=(0,i.filterIceServers)(e.iceServers,t.version),r.log("ICE servers after filtering:",e.iceServers)),new a(e)},e.RTCPeerConnection.prototype=a.prototype},n.shimReplaceTrack=function(e){!e.RTCRtpSender||"replaceTrack"in e.RTCRtpSender.prototype||(e.RTCRtpSender.prototype.replaceTrack=e.RTCRtpSender.prototype.setTrack)},Object.defineProperty(n,"shimGetUserMedia",{enumerable:!0,get:function(){return a.shimGetUserMedia}}),Object.defineProperty(n,"shimGetDisplayMedia",{enumerable:!0,get:function(){return s.shimGetDisplayMedia}});var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}(e("../utils")),i=e("./filtericeservers"),o=function(e){return e&&e.__esModule?e:{default:e}}(e("rtcpeerconnection-shim")),a=e("./getusermedia"),s=e("./getdisplaymedia")},{"../utils":"iSxC","./filtericeservers":"6NZ1","rtcpeerconnection-shim":"NJ2u","./getusermedia":"YdKx","./getdisplaymedia":"5P3b"}],"/GzS":[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetUserMedia=function(e){var t=r.detectBrowser(e),n=e&&e.navigator,o=e&&e.MediaStreamTrack;if(n.getUserMedia=function(e,t,i){r.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(e).then(t,i)},!(t.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){var a=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])},s=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(e){return"object"===i(e)&&"object"===i(e.audio)&&(e=JSON.parse(JSON.stringify(e)),a(e.audio,"autoGainControl","mozAutoGainControl"),a(e.audio,"noiseSuppression","mozNoiseSuppression")),s(e)},o&&o.prototype.getSettings){var c=o.prototype.getSettings;o.prototype.getSettings=function(){var e=c.apply(this,arguments);return a(e,"mozAutoGainControl","autoGainControl"),a(e,"mozNoiseSuppression","noiseSuppression"),e}}if(o&&o.prototype.applyConstraints){var u=o.prototype.applyConstraints;o.prototype.applyConstraints=function(e){return"audio"===this.kind&&"object"===i(e)&&(e=JSON.parse(JSON.stringify(e)),a(e,"autoGainControl","mozAutoGainControl"),a(e,"noiseSuppression","mozNoiseSuppression")),u.apply(this,[e])}}}};var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}(e("../utils"));function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}},{"../utils":"iSxC"}],UuGU:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(n){if(!n||!n.video){var r=new DOMException("getDisplayMedia without video constraints is undefined");return r.name="NotFoundError",r.code=8,Promise.reject(r)}return!0===n.video?n.video={mediaSource:t}:n.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(n)})}},{}],Fzdr:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.shimOnTrack=function(e){"object"===a(e)&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},n.shimPeerConnection=function(e){var t=r.detectBrowser(e);if("object"===a(e)&&(e.RTCPeerConnection||e.mozRTCPeerConnection)){if(!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){var n=e.RTCPeerConnection.prototype[t],r=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},t,(function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}));e.RTCPeerConnection.prototype[t]=r[t]})),t.version<68){var n=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?arguments[0]&&""===arguments[0].candidate?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}var i={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},o=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var[e,n,r]=arguments;return o.apply(this,[e||null]).then((function(e){if(t.version<53&&!n)try{e.forEach((function(e){e.type=i[e.type]||e.type}))}catch(t){if("TypeError"!==t.name)throw t;e.forEach((function(t,n){e.set(n,Object.assign({},t,{type:i[t.type]||t.type}))}))}return e})).then(n,r)}}},n.shimSenderGetStats=function(e){if("object"===a(e)&&e.RTCPeerConnection&&e.RTCRtpSender&&!(e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,n=t.apply(this,[]);return n.forEach((function(t){return t._pc=e})),n});var n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}},n.shimReceiverGetStats=function(e){if("object"===a(e)&&e.RTCPeerConnection&&e.RTCRtpSender&&!(e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)){var t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,n=t.apply(this,[]);return n.forEach((function(t){return t._pc=e})),n}),r.wrapPeerConnectionEvent(e,"track",(function(e){return e.receiver._pc=e.srcElement,e})),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}},n.shimRemoveStream=function(e){!e.RTCPeerConnection||"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;r.deprecated("removeStream","removeTrack"),this.getSenders().forEach((function(n){n.track&&e.getTracks().includes(n.track)&&t.removeTrack(n)}))})},n.shimRTCDataChannel=function(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)},n.shimAddTransceiver=function(e){if("object"===a(e)&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];var e=arguments[1],n=e&&"sendEncodings"in e;n&&e.sendEncodings.forEach((function(e){if("rid"in e&&!/^[a-z0-9]{0,16}$/i.test(e.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in e&&!(parseFloat(e.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(parseFloat(e.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")}));var r=t.apply(this,arguments);if(n){var{sender:i}=r,o=i.getParameters();"encodings"in o||(o.encodings=e.sendEncodings,this.setParametersPromises.push(i.setParameters(o).catch((function(){}))))}return r})}},n.shimCreateOffer=function(e){if("object"===a(e)&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){var e=this,n=arguments;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((function(){return t.apply(e,n)})).finally((function(){e.setParametersPromises=[]})):t.apply(this,arguments)}}},n.shimCreateAnswer=function(e){if("object"===a(e)&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){var e=this,n=arguments;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((function(){return t.apply(e,n)})).finally((function(){e.setParametersPromises=[]})):t.apply(this,arguments)}}},Object.defineProperty(n,"shimGetUserMedia",{enumerable:!0,get:function(){return i.shimGetUserMedia}}),Object.defineProperty(n,"shimGetDisplayMedia",{enumerable:!0,get:function(){return o.shimGetDisplayMedia}});var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}(e("../utils")),i=e("./getusermedia"),o=e("./getdisplaymedia");function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}},{"../utils":"iSxC","./getusermedia":"/GzS","./getdisplaymedia":"UuGU"}],t1lL:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.shimLocalStreamsAPI=function(e){if("object"===i(e)&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){var n=this;this._localStreams||(this._localStreams=[]),this._localStreams.includes(e)||this._localStreams.push(e),e.getAudioTracks().forEach((function(r){return t.call(n,r,e)})),e.getVideoTracks().forEach((function(r){return t.call(n,r,e)}))},e.RTCPeerConnection.prototype.addTrack=function(e){var n=arguments[1];return n&&(this._localStreams?this._localStreams.includes(n)||this._localStreams.push(n):this._localStreams=[n]),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._localStreams||(this._localStreams=[]);var n=this._localStreams.indexOf(e);if(-1!==n){this._localStreams.splice(n,1);var r=e.getTracks();this.getSenders().forEach((function(e){r.includes(e.track)&&t.removeTrack(e)}))}})}},n.shimRemoteStreamsAPI=function(e){if("object"===i(e)&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(e){var t=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=function(e){e.streams.forEach((function(e){if(t._remoteStreams||(t._remoteStreams=[]),!t._remoteStreams.includes(e)){t._remoteStreams.push(e);var n=new Event("addstream");n.stream=e,t.dispatchEvent(n)}}))})}});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach((function(t){if(e._remoteStreams||(e._remoteStreams=[]),!(e._remoteStreams.indexOf(t)>=0)){e._remoteStreams.push(t);var n=new Event("addstream");n.stream=t,e.dispatchEvent(n)}}))}),t.apply(e,arguments)}}},n.shimCallbacksAPI=function(e){if("object"===i(e)&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype,n=t.createOffer,r=t.createAnswer,o=t.setLocalDescription,a=t.setRemoteDescription,s=t.addIceCandidate;t.createOffer=function(e,t){var r=arguments.length>=2?arguments[2]:arguments[0],i=n.apply(this,[r]);return t?(i.then(e,t),Promise.resolve()):i},t.createAnswer=function(e,t){var n=arguments.length>=2?arguments[2]:arguments[0],i=r.apply(this,[n]);return t?(i.then(e,t),Promise.resolve()):i};var c=function(e,t,n){var r=o.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r};t.setLocalDescription=c,c=function(e,t,n){var r=a.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r},t.setRemoteDescription=c,c=function(e,t,n){var r=s.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r},t.addIceCandidate=c}},n.shimGetUserMedia=function(e){var t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){var n=t.mediaDevices,r=n.getUserMedia.bind(n);t.mediaDevices.getUserMedia=function(e){return r(o(e))}}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,n,r){t.mediaDevices.getUserMedia(e).then(n,r)}.bind(t))},n.shimConstraints=o,n.shimRTCIceServerUrls=function(e){var t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,n){if(e&&e.iceServers){for(var i=[],o=0;o<e.iceServers.length;o++){var a=e.iceServers[o];!a.hasOwnProperty("urls")&&a.hasOwnProperty("url")?(r.deprecated("RTCIceServer.url","RTCIceServer.urls"),(a=JSON.parse(JSON.stringify(a))).urls=a.url,delete a.url,i.push(a)):i.push(e.iceServers[o])}e.iceServers=i}return new t(e,n)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in e.RTCPeerConnection&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return t.generateCertificate}})},n.shimTrackEventTransceiver=function(e){"object"===i(e)&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},n.shimCreateOfferLegacy=function(e){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);var n=this.getTransceivers().find((function(e){return"audio"===e.receiver.track.kind}));!1===e.offerToReceiveAudio&&n?"sendrecv"===n.direction?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":"recvonly"===n.direction&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):!0!==e.offerToReceiveAudio||n||this.addTransceiver("audio"),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);var r=this.getTransceivers().find((function(e){return"video"===e.receiver.track.kind}));!1===e.offerToReceiveVideo&&r?"sendrecv"===r.direction?r.setDirection?r.setDirection("sendonly"):r.direction="sendonly":"recvonly"===r.direction&&(r.setDirection?r.setDirection("inactive"):r.direction="inactive"):!0!==e.offerToReceiveVideo||r||this.addTransceiver("video")}return t.apply(this,arguments)}};var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}(e("../utils"));function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e){return e&&void 0!==e.video?Object.assign({},e,{video:r.compactObject(e.video)}):e}},{"../utils":"iSxC"}],GOQK:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.shimRTCIceCandidate=function(e){if(e.RTCIceCandidate&&!(e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)){var t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"===o(e)&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){var n=new t(e),i=r.default.parseCandidate(e.candidate),a=Object.assign(n,i);return a.toJSON=function(){return{candidate:a.candidate,sdpMid:a.sdpMid,sdpMLineIndex:a.sdpMLineIndex,usernameFragment:a.usernameFragment}},a}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,i.wrapPeerConnectionEvent(e,"icecandidate",(function(t){return t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t}))}},n.shimMaxMessageSize=function(e){if(e.RTCPeerConnection){var t=i.detectBrowser(e);"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp}});var n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===t.browser&&t.version>=76){var{sdpSemantics:e}=this.getConfiguration();"plan-b"===e&&Object.defineProperty(this,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}if(function(e){if(!e||!e.sdp)return!1;var t=r.default.splitSections(e.sdp);return t.shift(),t.some((function(e){var t=r.default.parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")}))}(arguments[0])){var i,o=function(e){var t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;var n=parseInt(t[1],10);return n!=n?-1:n}(arguments[0]),a=(u=o,l=65536,"firefox"===t.browser&&(l=t.version<57?-1===u?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),l),s=function(e,n){var i=65536;"firefox"===t.browser&&57===t.version&&(i=65535);var o=r.default.matchPrefix(e.sdp,"a=max-message-size:");return o.length>0?i=parseInt(o[0].substr(19),10):"firefox"===t.browser&&-1!==n&&(i=2147483637),i}(arguments[0],o);i=0===a&&0===s?Number.POSITIVE_INFINITY:0===a||0===s?Math.max(a,s):Math.min(a,s);var c={};Object.defineProperty(c,"maxMessageSize",{get:function(){return i}}),this._sctp=c}var u,l;return n.apply(this,arguments)}}},n.shimSendThrowTypeError=function(e){if(e.RTCPeerConnection&&"createDataChannel"in e.RTCPeerConnection.prototype){var t=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){var e=t.apply(this,arguments);return n(e,this),e},i.wrapPeerConnectionEvent(e,"datachannel",(function(e){return n(e.channel,e.target),e}))}function n(e,t){var n=e.send;e.send=function(){var r=arguments[0],i=r.length||r.size||r.byteLength;if("open"===e.readyState&&t.sctp&&i>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return n.apply(e,arguments)}}},n.shimConnectionState=function(e){if(e.RTCPeerConnection&&!("connectionState"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get:function(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get:function(){return this._onconnectionstatechange||null},set:function(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach((function(e){var n=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=function(e){var t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;var n=new Event("connectionstatechange",e);t.dispatchEvent(n)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),n.apply(this,arguments)}}))}},n.removeAllowExtmapMixed=function(e){if(e.RTCPeerConnection){var t=i.detectBrowser(e);if(!("chrome"===t.browser&&t.version>=71)){var n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(e){return e&&e.sdp&&-1!==e.sdp.indexOf("\na=extmap-allow-mixed")&&(e.sdp=e.sdp.split("\n").filter((function(e){return"a=extmap-allow-mixed"!==e.trim()})).join("\n")),n.apply(this,arguments)}}}};var r=function(e){return e&&e.__esModule?e:{default:e}}(e("sdp")),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}(e("./utils"));function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}},{sdp:"YHvh","./utils":"iSxC"}],KtlG:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.adapterFactory=function(){var{window:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0},n=r.log,u=r.detectBrowser(e),l={browserDetails:u,commonShim:c,extractVersion:r.extractVersion,disableLog:r.disableLog,disableWarnings:r.disableWarnings};switch(u.browser){case"chrome":if(!i||!i.shimPeerConnection||!t.shimChrome)return n("Chrome shim is not included in this adapter release."),l;n("adapter.js shimming chrome."),l.browserShim=i,i.shimGetUserMedia(e),i.shimMediaStream(e),i.shimPeerConnection(e),i.shimOnTrack(e),i.shimAddTrackRemoveTrack(e),i.shimGetSendersWithDtmf(e),i.shimGetStats(e),i.shimSenderReceiverGetStats(e),i.fixNegotiationNeeded(e),c.shimRTCIceCandidate(e),c.shimConnectionState(e),c.shimMaxMessageSize(e),c.shimSendThrowTypeError(e),c.removeAllowExtmapMixed(e);break;case"firefox":if(!a||!a.shimPeerConnection||!t.shimFirefox)return n("Firefox shim is not included in this adapter release."),l;n("adapter.js shimming firefox."),l.browserShim=a,a.shimGetUserMedia(e),a.shimPeerConnection(e),a.shimOnTrack(e),a.shimRemoveStream(e),a.shimSenderGetStats(e),a.shimReceiverGetStats(e),a.shimRTCDataChannel(e),a.shimAddTransceiver(e),a.shimCreateOffer(e),a.shimCreateAnswer(e),c.shimRTCIceCandidate(e),c.shimConnectionState(e),c.shimMaxMessageSize(e),c.shimSendThrowTypeError(e);break;case"edge":if(!o||!o.shimPeerConnection||!t.shimEdge)return n("MS edge shim is not included in this adapter release."),l;n("adapter.js shimming edge."),l.browserShim=o,o.shimGetUserMedia(e),o.shimGetDisplayMedia(e),o.shimPeerConnection(e),o.shimReplaceTrack(e),c.shimMaxMessageSize(e),c.shimSendThrowTypeError(e);break;case"safari":if(!s||!t.shimSafari)return n("Safari shim is not included in this adapter release."),l;n("adapter.js shimming safari."),l.browserShim=s,s.shimRTCIceServerUrls(e),s.shimCreateOfferLegacy(e),s.shimCallbacksAPI(e),s.shimLocalStreamsAPI(e),s.shimRemoteStreamsAPI(e),s.shimTrackEventTransceiver(e),s.shimGetUserMedia(e),c.shimRTCIceCandidate(e),c.shimMaxMessageSize(e),c.shimSendThrowTypeError(e),c.removeAllowExtmapMixed(e);break;default:n("Unsupported browser!")}return l};var r=u(e("./utils")),i=u(e("./chrome/chrome_shim")),o=u(e("./edge/edge_shim")),a=u(e("./firefox/firefox_shim")),s=u(e("./safari/safari_shim")),c=u(e("./common_shim"));function u(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}},{"./utils":"iSxC","./chrome/chrome_shim":"uI5X","./edge/edge_shim":"XRic","./firefox/firefox_shim":"Fzdr","./safari/safari_shim":"t1lL","./common_shim":"GOQK"}],tI1X:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=(0,e("./adapter_factory.js").adapterFactory)({window:window});n.default=r},{"./adapter_factory.js":"KtlG"}],sXtV:[function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var i=r(e("webrtc-adapter"));n.webRTCAdapter=i.default},{"webrtc-adapter":"tI1X"}],"I+31":[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=e("./adapter");n.Supports=new(function(){function e(){this.isIOS=["iPad","iPhone","iPod"].includes(navigator.platform),this.supportedBrowsers=["firefox","chrome","safari"],this.minFirefoxVersion=59,this.minChromeVersion=72,this.minSafariVersion=605}return e.prototype.isWebRTCSupported=function(){return"undefined"!=typeof RTCPeerConnection},e.prototype.isBrowserSupported=function(){var e=this.getBrowser(),t=this.getVersion();return!!this.supportedBrowsers.includes(e)&&("chrome"===e?t>=this.minChromeVersion:"firefox"===e?t>=this.minFirefoxVersion:"safari"===e&&!this.isIOS&&t>=this.minSafariVersion)},e.prototype.getBrowser=function(){return r.webRTCAdapter.browserDetails.browser},e.prototype.getVersion=function(){return r.webRTCAdapter.browserDetails.version||0},e.prototype.isUnifiedPlanSupported=function(){var e,t=this.getBrowser(),n=r.webRTCAdapter.browserDetails.version||0;if("chrome"===t&&n<72)return!1;if("firefox"===t&&n>=59)return!0;if(!(window.RTCRtpTransceiver&&"currentDirection"in RTCRtpTransceiver.prototype))return!1;var i=!1;try{(e=new RTCPeerConnection).addTransceiver("audio"),i=!0}catch(e){}finally{e&&e.close()}return i},e.prototype.toString=function(){return"Supports: \n    browser:"+this.getBrowser()+" \n    version:"+this.getVersion()+" \n    isIOS:"+this.isIOS+" \n    isWebRTCSupported:"+this.isWebRTCSupported()+" \n    isBrowserSupported:"+this.isBrowserSupported()+" \n    isUnifiedPlanSupported:"+this.isUnifiedPlanSupported()},e}())},{"./adapter":"sXtV"}],BHXf:[function(e,t,n){var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(n,"__esModule",{value:!0});var i=r(e("peerjs-js-binarypack")),o=e("./supports"),a={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"turn:0.peerjs.com:3478",username:"peerjs",credential:"peerjsp"}],sdpSemantics:"unified-plan"};n.util=new(function(){function e(){this.CLOUD_HOST="0.peerjs.com",this.CLOUD_PORT=443,this.chunkedBrowsers={Chrome:1,chrome:1},this.chunkedMTU=16300,this.defaultConfig=a,this.browser=o.Supports.getBrowser(),this.browserVersion=o.Supports.getVersion(),this.supports=function(){var e,t={browser:o.Supports.isBrowserSupported(),webRTC:o.Supports.isWebRTCSupported(),audioVideo:!1,data:!1,binaryBlob:!1,reliable:!1};if(!t.webRTC)return t;try{e=new RTCPeerConnection(a),t.audioVideo=!0;var n=void 0;try{n=e.createDataChannel("_PEERJSTEST",{ordered:!0}),t.data=!0,t.reliable=!!n.ordered;try{n.binaryType="blob",t.binaryBlob=!o.Supports.isIOS}catch(e){}}catch(e){}finally{n&&n.close()}}catch(e){}finally{e&&e.close()}return t}(),this.pack=i.pack,this.unpack=i.unpack,this._dataCount=1}return e.prototype.noop=function(){},e.prototype.validateId=function(e){return!e||/^[A-Za-z0-9]+(?:[ _-][A-Za-z0-9]+)*$/.test(e)},e.prototype.chunk=function(e){for(var t=[],r=e.size,i=Math.ceil(r/n.util.chunkedMTU),o=0,a=0;a<r;){var s=Math.min(r,a+n.util.chunkedMTU),c=e.slice(a,s),u={__peerData:this._dataCount,n:o,data:c,total:i};t.push(u),a=s,o++}return this._dataCount++,t},e.prototype.blobToArrayBuffer=function(e,t){var n=new FileReader;return n.onload=function(e){e.target&&t(e.target.result)},n.readAsArrayBuffer(e),n},e.prototype.binaryStringToArrayBuffer=function(e){for(var t=new Uint8Array(e.length),n=0;n<e.length;n++)t[n]=255&e.charCodeAt(n);return t.buffer},e.prototype.randomToken=function(){return Math.random().toString(36).substr(2)},e.prototype.isSecure=function(){return"https:"===location.protocol},e}())},{"peerjs-js-binarypack":"kdPp","./supports":"I+31"}],"2JJl":[function(e,t,n){var r=Object.prototype.hasOwnProperty,i="~";function o(){}function a(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function s(e,t,n,r,o){if("function"!=typeof n)throw new TypeError("The listener must be a function");var s=new a(n,r||e,o),c=i?i+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],s]:e._events[c].push(s):(e._events[c]=s,e._eventsCount++),e}function c(e,t){0==--e._eventsCount?e._events=new o:delete e._events[t]}function u(){this._events=new o,this._eventsCount=0}Object.create&&(o.prototype=Object.create(null),(new o).__proto__||(i=!1)),u.prototype.eventNames=function(){var e,t,n=[];if(0===this._eventsCount)return n;for(t in e=this._events)r.call(e,t)&&n.push(i?t.slice(1):t);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(e)):n},u.prototype.listeners=function(e){var t=i?i+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var r=0,o=n.length,a=new Array(o);r<o;r++)a[r]=n[r].fn;return a},u.prototype.listenerCount=function(e){var t=i?i+e:e,n=this._events[t];return n?n.fn?1:n.length:0},u.prototype.emit=function(e,t,n,r,o,a){var s=i?i+e:e;if(!this._events[s])return!1;var c,u,l=this._events[s],f=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),f){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,n),!0;case 4:return l.fn.call(l.context,t,n,r),!0;case 5:return l.fn.call(l.context,t,n,r,o),!0;case 6:return l.fn.call(l.context,t,n,r,o,a),!0}for(u=1,c=new Array(f-1);u<f;u++)c[u-1]=arguments[u];l.fn.apply(l.context,c)}else{var h,p=l.length;for(u=0;u<p;u++)switch(l[u].once&&this.removeListener(e,l[u].fn,void 0,!0),f){case 1:l[u].fn.call(l[u].context);break;case 2:l[u].fn.call(l[u].context,t);break;case 3:l[u].fn.call(l[u].context,t,n);break;case 4:l[u].fn.call(l[u].context,t,n,r);break;default:if(!c)for(h=1,c=new Array(f-1);h<f;h++)c[h-1]=arguments[h];l[u].fn.apply(l[u].context,c)}}return!0},u.prototype.on=function(e,t,n){return s(this,e,t,n,!1)},u.prototype.once=function(e,t,n){return s(this,e,t,n,!0)},u.prototype.removeListener=function(e,t,n,r){var o=i?i+e:e;if(!this._events[o])return this;if(!t)return c(this,o),this;var a=this._events[o];if(a.fn)a.fn!==t||r&&!a.once||n&&a.context!==n||c(this,o);else{for(var s=0,u=[],l=a.length;s<l;s++)(a[s].fn!==t||r&&!a[s].once||n&&a[s].context!==n)&&u.push(a[s]);u.length?this._events[o]=1===u.length?u[0]:u:c(this,o)}return this},u.prototype.removeAllListeners=function(e){var t;return e?(t=i?i+e:e,this._events[t]&&c(this,t)):(this._events=new o,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=i,u.EventEmitter=u,void 0!==t&&(t.exports=u)},{}],"8WOs":[function(e,t,n){var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},i=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(r(arguments[t]));return e};Object.defineProperty(n,"__esModule",{value:!0});var o,a="PeerJS: ";!function(e){e[e.Disabled=0]="Disabled",e[e.Errors=1]="Errors",e[e.Warnings=2]="Warnings",e[e.All=3]="All"}(o=n.LogLevel||(n.LogLevel={}));var s=function(){function e(){this._logLevel=o.Disabled}return Object.defineProperty(e.prototype,"logLevel",{get:function(){return this._logLevel},set:function(e){this._logLevel=e},enumerable:!0,configurable:!0}),e.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logLevel>=o.All&&this._print.apply(this,i([o.All],e))},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logLevel>=o.Warnings&&this._print.apply(this,i([o.Warnings],e))},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logLevel>=o.Errors&&this._print.apply(this,i([o.Errors],e))},e.prototype.setLogFunction=function(e){this._print=e},e.prototype._print=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=i([a],t);for(var s in r)r[s]instanceof Error&&(r[s]="("+r[s].name+") "+r[s].message);e>=o.All?console.log.apply(console,i(r)):e>=o.Warnings?console.warn.apply(console,i(["WARNING"],r)):e>=o.Errors&&console.error.apply(console,i(["ERROR"],r))},e}();n.default=new s},{}],"9ZRY":[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),function(e){e.Open="open",e.Stream="stream",e.Data="data",e.Close="close",e.Error="error",e.IceStateChanged="iceStateChanged"}(n.ConnectionEventType||(n.ConnectionEventType={})),function(e){e.Data="data",e.Media="media"}(n.ConnectionType||(n.ConnectionType={})),function(e){e.Open="open",e.Close="close",e.Connection="connection",e.Call="call",e.Disconnected="disconnected",e.Error="error"}(n.PeerEventType||(n.PeerEventType={})),function(e){e.BrowserIncompatible="browser-incompatible",e.Disconnected="disconnected",e.InvalidID="invalid-id",e.InvalidKey="invalid-key",e.Network="network",e.PeerUnavailable="peer-unavailable",e.SslUnavailable="ssl-unavailable",e.ServerError="server-error",e.SocketError="socket-error",e.SocketClosed="socket-closed",e.UnavailableID="unavailable-id",e.WebRTC="webrtc"}(n.PeerErrorType||(n.PeerErrorType={})),function(e){e.Binary="binary",e.BinaryUTF8="binary-utf8",e.JSON="json"}(n.SerializationType||(n.SerializationType={})),function(e){e.Message="message",e.Disconnected="disconnected",e.Error="error",e.Close="close"}(n.SocketEventType||(n.SocketEventType={})),function(e){e.Heartbeat="HEARTBEAT",e.Candidate="CANDIDATE",e.Offer="OFFER",e.Answer="ANSWER",e.Open="OPEN",e.Error="ERROR",e.IdTaken="ID-TAKEN",e.InvalidKey="INVALID-KEY",e.Leave="LEAVE",e.Expire="EXPIRE"}(n.ServerMessageType||(n.ServerMessageType={}))},{}],wJlv:[function(e,t,n){var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},o=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(i(arguments[t]));return e},a=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var c=e("eventemitter3"),u=s(e("./logger")),l=e("./enums"),f=function(e){function t(t,n,r,i,o,a){void 0===a&&(a=5e3);var s=e.call(this)||this;s.pingInterval=a,s._disconnected=!1,s._messagesQueue=[];var c=t?"wss://":"ws://";return s._wsUrl=c+n+":"+r+i+"peerjs?key="+o,s}return r(t,e),t.prototype.start=function(e,t){this._id=e,this._wsUrl+="&id="+e+"&token="+t,this._startWebSocket()},t.prototype._startWebSocket=function(){var e=this;this._socket||(this._socket=new WebSocket(this._wsUrl),this._socket.onmessage=function(t){var n;try{n=JSON.parse(t.data),u.default.log("Server message received:",n)}catch(e){return void u.default.log("Invalid server message",t.data)}e.emit(l.SocketEventType.Message,n)},this._socket.onclose=function(t){u.default.log("Socket closed.",t),e._disconnected=!0,clearTimeout(e._wsPingTimer),e.emit(l.SocketEventType.Disconnected)},this._socket.onopen=function(){e._disconnected||(e._sendQueuedMessages(),u.default.log("Socket open"),e._scheduleHeartbeat())})},t.prototype._scheduleHeartbeat=function(){var e=this;this._wsPingTimer=setTimeout((function(){e._sendHeartbeat()}),this.pingInterval)},t.prototype._sendHeartbeat=function(){if(this._wsOpen()){var e=JSON.stringify({type:l.ServerMessageType.Heartbeat});this._socket.send(e),this._scheduleHeartbeat()}else u.default.log("Cannot send heartbeat, because socket closed")},t.prototype._wsOpen=function(){return!!this._socket&&1===this._socket.readyState},t.prototype._sendQueuedMessages=function(){var e,t,n=o(this._messagesQueue);this._messagesQueue=[];try{for(var r=a(n),i=r.next();!i.done;i=r.next()){var s=i.value;this.send(s)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}},t.prototype.send=function(e){if(!this._disconnected)if(this._id)if(e.type){if(this._wsOpen()){var t=JSON.stringify(e);this._socket.send(t)}}else this.emit(l.SocketEventType.Error,"Invalid message");else this._messagesQueue.push(e)},t.prototype.close=function(){!this._disconnected&&this._socket&&(this._socket.close(),this._disconnected=!0,clearTimeout(this._wsPingTimer))},t}(c.EventEmitter);n.Socket=f},{eventemitter3:"2JJl","./logger":"8WOs","./enums":"9ZRY"}],HCdX:[function(e,t,n){var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var s=e("./util"),c=a(e("./logger")),u=e("./enums"),l=function(){function e(e){this.connection=e}return e.prototype.startConnection=function(e){var t=this._startPeerConnection();if(this.connection.peerConnection=t,this.connection.type===u.ConnectionType.Media&&e._stream&&this._addTracksToConnection(e._stream,t),e.originator){if(this.connection.type===u.ConnectionType.Data){var n=this.connection,r={ordered:!!e.reliable},i=t.createDataChannel(n.label,r);n.initialize(i)}this._makeOffer()}else this.handleSDP("OFFER",e.sdp)},e.prototype._startPeerConnection=function(){c.default.log("Creating RTCPeerConnection.");var e=new RTCPeerConnection(this.connection.provider.options.config);return this._setupListeners(e),e},e.prototype._setupListeners=function(e){var t=this,n=this.connection.peer,r=this.connection.connectionId,i=this.connection.type,o=this.connection.provider;c.default.log("Listening for ICE candidates."),e.onicecandidate=function(e){e.candidate&&e.candidate.candidate&&(c.default.log("Received ICE candidates for "+n+":",e.candidate),o.socket.send({type:u.ServerMessageType.Candidate,payload:{candidate:e.candidate,type:i,connectionId:r},dst:n}))},e.oniceconnectionstatechange=function(){switch(e.iceConnectionState){case"failed":c.default.log("iceConnectionState is failed, closing connections to "+n),t.connection.emit(u.ConnectionEventType.Error,new Error("Negotiation of connection to "+n+" failed.")),t.connection.close();break;case"closed":c.default.log("iceConnectionState is closed, closing connections to "+n),t.connection.emit(u.ConnectionEventType.Error,new Error("Connection to "+n+" closed.")),t.connection.close();break;case"disconnected":c.default.log("iceConnectionState is disconnected, closing connections to "+n),t.connection.emit(u.ConnectionEventType.Error,new Error("Connection to "+n+" disconnected.")),t.connection.close();break;case"completed":e.onicecandidate=s.util.noop}t.connection.emit(u.ConnectionEventType.IceStateChanged,e.iceConnectionState)},c.default.log("Listening for data channel"),e.ondatachannel=function(e){c.default.log("Received data channel");var t=e.channel;o.getConnection(n,r).initialize(t)},c.default.log("Listening for remote stream"),e.ontrack=function(e){c.default.log("Received remote stream");var i=e.streams[0],a=o.getConnection(n,r);if(a.type===u.ConnectionType.Media){var s=a;t._addStreamToMediaConnection(i,s)}}},e.prototype.cleanup=function(){c.default.log("Cleaning up PeerConnection to "+this.connection.peer);var e=this.connection.peerConnection;if(e){this.connection.peerConnection=null,e.onicecandidate=e.oniceconnectionstatechange=e.ondatachannel=e.ontrack=function(){};var t="closed"!==e.signalingState,n=!1;if(this.connection.type===u.ConnectionType.Data){var r=this.connection.dataChannel;r&&(n=!!r.readyState&&"closed"!==r.readyState)}(t||n)&&e.close()}},e.prototype._makeOffer=function(){return i(this,void 0,Promise,(function(){var e,t,n,i,a,l,f;return o(this,(function(o){switch(o.label){case 0:e=this.connection.peerConnection,t=this.connection.provider,o.label=1;case 1:return o.trys.push([1,7,,8]),[4,e.createOffer(this.connection.options.constraints)];case 2:n=o.sent(),c.default.log("Created offer."),this.connection.options.sdpTransform&&"function"==typeof this.connection.options.sdpTransform&&(n.sdp=this.connection.options.sdpTransform(n.sdp)||n.sdp),o.label=3;case 3:return o.trys.push([3,5,,6]),[4,e.setLocalDescription(n)];case 4:return o.sent(),c.default.log("Set localDescription:",n,"for:"+this.connection.peer),i={sdp:n,type:this.connection.type,connectionId:this.connection.connectionId,metadata:this.connection.metadata,browser:s.util.browser},this.connection.type===u.ConnectionType.Data&&(a=this.connection,i=r(r({},i),{label:a.label,reliable:a.reliable,serialization:a.serialization})),t.socket.send({type:u.ServerMessageType.Offer,payload:i,dst:this.connection.peer}),[3,6];case 5:return"OperationError: Failed to set local offer sdp: Called in wrong state: kHaveRemoteOffer"!=(l=o.sent())&&(t.emitError(u.PeerErrorType.WebRTC,l),c.default.log("Failed to setLocalDescription, ",l)),[3,6];case 6:return[3,8];case 7:return f=o.sent(),t.emitError(u.PeerErrorType.WebRTC,f),c.default.log("Failed to createOffer, ",f),[3,8];case 8:return[2]}}))}))},e.prototype._makeAnswer=function(){return i(this,void 0,Promise,(function(){var e,t,n,r,i;return o(this,(function(o){switch(o.label){case 0:e=this.connection.peerConnection,t=this.connection.provider,o.label=1;case 1:return o.trys.push([1,7,,8]),[4,e.createAnswer()];case 2:n=o.sent(),c.default.log("Created answer."),this.connection.options.sdpTransform&&"function"==typeof this.connection.options.sdpTransform&&(n.sdp=this.connection.options.sdpTransform(n.sdp)||n.sdp),o.label=3;case 3:return o.trys.push([3,5,,6]),[4,e.setLocalDescription(n)];case 4:return o.sent(),c.default.log("Set localDescription:",n,"for:"+this.connection.peer),t.socket.send({type:u.ServerMessageType.Answer,payload:{sdp:n,type:this.connection.type,connectionId:this.connection.connectionId,browser:s.util.browser},dst:this.connection.peer}),[3,6];case 5:return r=o.sent(),t.emitError(u.PeerErrorType.WebRTC,r),c.default.log("Failed to setLocalDescription, ",r),[3,6];case 6:return[3,8];case 7:return i=o.sent(),t.emitError(u.PeerErrorType.WebRTC,i),c.default.log("Failed to create answer, ",i),[3,8];case 8:return[2]}}))}))},e.prototype.handleSDP=function(e,t){return i(this,void 0,Promise,(function(){var n,r,i,a;return o(this,(function(o){switch(o.label){case 0:t=new RTCSessionDescription(t),n=this.connection.peerConnection,r=this.connection.provider,c.default.log("Setting remote description",t),i=this,o.label=1;case 1:return o.trys.push([1,5,,6]),[4,n.setRemoteDescription(t)];case 2:return o.sent(),c.default.log("Set remoteDescription:"+e+" for:"+this.connection.peer),"OFFER"!==e?[3,4]:[4,i._makeAnswer()];case 3:o.sent(),o.label=4;case 4:return[3,6];case 5:return a=o.sent(),r.emitError(u.PeerErrorType.WebRTC,a),c.default.log("Failed to setRemoteDescription, ",a),[3,6];case 6:return[2]}}))}))},e.prototype.handleCandidate=function(e){return i(this,void 0,Promise,(function(){var t,n,r,i,a,s;return o(this,(function(o){switch(o.label){case 0:c.default.log("handleCandidate:",e),t=e.candidate,n=e.sdpMLineIndex,r=e.sdpMid,i=this.connection.peerConnection,a=this.connection.provider,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,i.addIceCandidate(new RTCIceCandidate({sdpMid:r,sdpMLineIndex:n,candidate:t}))];case 2:return o.sent(),c.default.log("Added ICE candidate for:"+this.connection.peer),[3,4];case 3:return s=o.sent(),a.emitError(u.PeerErrorType.WebRTC,s),c.default.log("Failed to handleCandidate, ",s),[3,4];case 4:return[2]}}))}))},e.prototype._addTracksToConnection=function(e,t){if(c.default.log("add tracks from stream "+e.id+" to peer connection"),!t.addTrack)return c.default.error("Your browser does't support RTCPeerConnection#addTrack. Ignored.");e.getTracks().forEach((function(n){t.addTrack(n,e)}))},e.prototype._addStreamToMediaConnection=function(e,t){c.default.log("add stream "+e.id+" to media connection "+t.connectionId),t.addStream(e)},e}();n.Negotiator=l},{"./util":"BHXf","./logger":"8WOs","./enums":"9ZRY"}],tQFK:[function(e,t,n){var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=function(e){function t(t,n,r){var i=e.call(this)||this;return i.peer=t,i.provider=n,i.options=r,i._open=!1,i.metadata=r.metadata,i}return r(t,e),Object.defineProperty(t.prototype,"open",{get:function(){return this._open},enumerable:!0,configurable:!0}),t}(e("eventemitter3").EventEmitter);n.BaseConnection=i},{eventemitter3:"2JJl"}],dbHP:[function(e,t,n){var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},o=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var s=e("./util"),c=a(e("./logger")),u=e("./negotiator"),l=e("./enums"),f=function(e){function t(n,r,i){var o=e.call(this,n,r,i)||this;return o._localStream=o.options._stream,o.connectionId=o.options.connectionId||t.ID_PREFIX+s.util.randomToken(),o._negotiator=new u.Negotiator(o),o._localStream&&o._negotiator.startConnection({_stream:o._localStream,originator:!0}),o}return r(t,e),Object.defineProperty(t.prototype,"type",{get:function(){return l.ConnectionType.Media},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"localStream",{get:function(){return this._localStream},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"remoteStream",{get:function(){return this._remoteStream},enumerable:!0,configurable:!0}),t.prototype.addStream=function(t){c.default.log("Receiving stream",t),this._remoteStream=t,e.prototype.emit.call(this,l.ConnectionEventType.Stream,t)},t.prototype.handleMessage=function(e){var t=e.type,n=e.payload;switch(e.type){case l.ServerMessageType.Answer:this._negotiator.handleSDP(t,n.sdp),this._open=!0;break;case l.ServerMessageType.Candidate:this._negotiator.handleCandidate(n.candidate);break;default:c.default.warn("Unrecognized message type:"+t+" from peer:"+this.peer)}},t.prototype.answer=function(e,t){var n,r;if(void 0===t&&(t={}),this._localStream)c.default.warn("Local stream already exists on this MediaConnection. Are you answering a call twice?");else{this._localStream=e,t&&t.sdpTransform&&(this.options.sdpTransform=t.sdpTransform),this._negotiator.startConnection(i(i({},this.options._payload),{_stream:e}));var a=this.provider._getMessages(this.connectionId);try{for(var s=o(a),u=s.next();!u.done;u=s.next()){var l=u.value;this.handleMessage(l)}}catch(e){n={error:e}}finally{try{u&&!u.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}this._open=!0}},t.prototype.close=function(){this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this._localStream=null,this._remoteStream=null,this.provider&&(this.provider._removeConnection(this),this.provider=null),this.options&&this.options._stream&&(this.options._stream=null),this.open&&(this._open=!1,e.prototype.emit.call(this,l.ConnectionEventType.Close))},t.ID_PREFIX="mc_",t}(e("./baseconnection").BaseConnection);n.MediaConnection=f},{"./util":"BHXf","./logger":"8WOs","./negotiator":"HCdX","./enums":"9ZRY","./baseconnection":"tQFK"}],GGp6:[function(e,t,n){var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var o=e("eventemitter3"),a=i(e("./logger")),s=function(e){function t(){var t=e.call(this)||this;return t.fileReader=new FileReader,t._queue=[],t._processing=!1,t.fileReader.onload=function(e){t._processing=!1,e.target&&t.emit("done",e.target.result),t.doNextTask()},t.fileReader.onerror=function(e){a.default.error("EncodingQueue error:",e),t._processing=!1,t.destroy(),t.emit("error",e)},t}return r(t,e),Object.defineProperty(t.prototype,"queue",{get:function(){return this._queue},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.queue.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"processing",{get:function(){return this._processing},enumerable:!0,configurable:!0}),t.prototype.enque=function(e){this.queue.push(e),this.processing||this.doNextTask()},t.prototype.destroy=function(){this.fileReader.abort(),this._queue=[]},t.prototype.doNextTask=function(){0!==this.size&&(this.processing||(this._processing=!0,this.fileReader.readAsArrayBuffer(this.queue.shift())))},t}(o.EventEmitter);n.EncodingQueue=s},{eventemitter3:"2JJl","./logger":"8WOs"}],GBTQ:[function(e,t,n){var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var a=e("./util"),s=o(e("./logger")),c=e("./negotiator"),u=e("./enums"),l=e("./baseconnection"),f=e("./encodingQueue"),h=function(e){function t(n,r,i){var o=e.call(this,n,r,i)||this;return o._buffer=[],o._bufferSize=0,o._buffering=!1,o._chunkedData={},o._encodingQueue=new f.EncodingQueue,o.connectionId=o.options.connectionId||t.ID_PREFIX+a.util.randomToken(),o.label=o.options.label||o.connectionId,o.serialization=o.options.serialization||u.SerializationType.Binary,o.reliable=!!o.options.reliable,o.options._payload&&(o._peerBrowser=o.options._payload.browser),o._encodingQueue.on("done",(function(e){o._bufferedSend(e)})),o._encodingQueue.on("error",(function(){s.default.error("DC#"+o.connectionId+": Error occured in encoding from blob to arraybuffer, close DC"),o.close()})),o._negotiator=new c.Negotiator(o),o._negotiator.startConnection(o.options._payload||{originator:!0}),o}return r(t,e),Object.defineProperty(t.prototype,"type",{get:function(){return u.ConnectionType.Data},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dataChannel",{get:function(){return this._dc},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bufferSize",{get:function(){return this._bufferSize},enumerable:!0,configurable:!0}),t.prototype.initialize=function(e){this._dc=e,this._configureDataChannel()},t.prototype._configureDataChannel=function(){var e=this;a.util.supports.binaryBlob&&!a.util.supports.reliable||(this.dataChannel.binaryType="arraybuffer"),this.dataChannel.onopen=function(){s.default.log("DC#"+e.connectionId+" dc connection success"),e._open=!0,e.emit(u.ConnectionEventType.Open)},this.dataChannel.onmessage=function(t){s.default.log("DC#"+e.connectionId+" dc onmessage:",t.data),e._handleDataMessage(t)},this.dataChannel.onclose=function(){s.default.log("DC#"+e.connectionId+" dc closed for:",e.peer),e.close()}},t.prototype._handleDataMessage=function(t){var n=this,r=t.data,i=r.constructor,o=r;if(this.serialization===u.SerializationType.Binary||this.serialization===u.SerializationType.BinaryUTF8){if(i===Blob)return void a.util.blobToArrayBuffer(r,(function(e){var t=a.util.unpack(e);n.emit(u.ConnectionEventType.Data,t)}));if(i===ArrayBuffer)o=a.util.unpack(r);else if(i===String){var s=a.util.binaryStringToArrayBuffer(r);o=a.util.unpack(s)}}else this.serialization===u.SerializationType.JSON&&(o=JSON.parse(r));o.__peerData?this._handleChunk(o):e.prototype.emit.call(this,u.ConnectionEventType.Data,o)},t.prototype._handleChunk=function(e){var t=e.__peerData,n=this._chunkedData[t]||{data:[],count:0,total:e.total};if(n.data[e.n]=e.data,n.count++,this._chunkedData[t]=n,n.total===n.count){delete this._chunkedData[t];var r=new Blob(n.data);this._handleDataMessage({data:r})}},t.prototype.close=function(){this._buffer=[],this._bufferSize=0,this._chunkedData={},this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this.provider&&(this.provider._removeConnection(this),this.provider=null),this.dataChannel&&(this.dataChannel.onopen=null,this.dataChannel.onmessage=null,this.dataChannel.onclose=null,this._dc=null),this._encodingQueue&&(this._encodingQueue.destroy(),this._encodingQueue.removeAllListeners(),this._encodingQueue=null),this.open&&(this._open=!1,e.prototype.emit.call(this,u.ConnectionEventType.Close))},t.prototype.send=function(t,n){if(this.open)if(this.serialization===u.SerializationType.JSON)this._bufferedSend(JSON.stringify(t));else if(this.serialization===u.SerializationType.Binary||this.serialization===u.SerializationType.BinaryUTF8){var r=a.util.pack(t);if(!n&&r.size>a.util.chunkedMTU)return void this._sendChunks(r);a.util.supports.binaryBlob?this._bufferedSend(r):this._encodingQueue.enque(r)}else this._bufferedSend(t);else e.prototype.emit.call(this,u.ConnectionEventType.Error,new Error("Connection is not open. You should listen for the `open` event before sending messages."))},t.prototype._bufferedSend=function(e){!this._buffering&&this._trySend(e)||(this._buffer.push(e),this._bufferSize=this._buffer.length)},t.prototype._trySend=function(e){var n=this;if(!this.open)return!1;if(this.dataChannel.bufferedAmount>t.MAX_BUFFERED_AMOUNT)return this._buffering=!0,setTimeout((function(){n._buffering=!1,n._tryBuffer()}),50),!1;try{this.dataChannel.send(e)}catch(e){return s.default.error("DC#:"+this.connectionId+" Error when sending:",e),this._buffering=!0,this.close(),!1}return!0},t.prototype._tryBuffer=function(){if(this.open&&0!==this._buffer.length){var e=this._buffer[0];this._trySend(e)&&(this._buffer.shift(),this._bufferSize=this._buffer.length,this._tryBuffer())}},t.prototype._sendChunks=function(e){var t,n,r=a.util.chunk(e);s.default.log("DC#"+this.connectionId+" Try to send "+r.length+" chunks...");try{for(var o=i(r),c=o.next();!c.done;c=o.next()){var u=c.value;this.send(u,!0)}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}},t.prototype.handleMessage=function(e){var t=e.payload;switch(e.type){case u.ServerMessageType.Answer:this._peerBrowser=t.browser,this._negotiator.handleSDP(e.type,t.sdp);break;case u.ServerMessageType.Candidate:this._negotiator.handleCandidate(t.candidate);break;default:s.default.warn("Unrecognized message type:",e.type,"from peer:",this.peer)}},t.ID_PREFIX="dc_",t.MAX_BUFFERED_AMOUNT=8388608,t}(l.BaseConnection);n.DataConnection=h},{"./util":"BHXf","./logger":"8WOs","./negotiator":"HCdX","./enums":"9ZRY","./baseconnection":"tQFK","./encodingQueue":"GGp6"}],in7L:[function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var a=e("./util"),s=o(e("./logger")),c=function(){function e(e){this._options=e}return e.prototype._buildUrl=function(e){return(this._options.secure?"https://":"http://")+this._options.host+":"+this._options.port+this._options.path+this._options.key+"/"+e+"?ts="+(new Date).getTime()+Math.random()},e.prototype.retrieveId=function(){return r(this,void 0,Promise,(function(){var e,t,n,r;return i(this,(function(i){switch(i.label){case 0:e=this._buildUrl("id"),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,fetch(e)];case 2:if(200!==(t=i.sent()).status)throw new Error("Error. Status:"+t.status);return[2,t.text()];case 3:throw n=i.sent(),s.default.error("Error retrieving ID",n),r="","/"===this._options.path&&this._options.host!==a.util.CLOUD_HOST&&(r=" If you passed in a `path` to your self-hosted PeerServer, you'll also need to pass in that same path when creating a new Peer."),new Error("Could not get an ID from the server."+r);case 4:return[2]}}))}))},e.prototype.listAllPeers=function(){return r(this,void 0,Promise,(function(){var e,t,n,r;return i(this,(function(i){switch(i.label){case 0:e=this._buildUrl("peers"),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,fetch(e)];case 2:if(200!==(t=i.sent()).status){if(401===t.status)throw"",n=this._options.host===a.util.CLOUD_HOST?"It looks like you're using the cloud server. You can email team@peerjs.com to enable peer listing for your API key.":"You need to enable `allow_discovery` on your self-hosted PeerServer to use this feature.",new Error("It doesn't look like you have permission to list peers IDs. "+n);throw new Error("Error. Status:"+t.status)}return[2,t.json()];case 3:throw r=i.sent(),s.default.error("Error retrieving list peers",r),new Error("Could not get list peers from the server."+r);case 4:return[2]}}))}))},e}();n.API=c},{"./util":"BHXf","./logger":"8WOs"}],Hxpd:[function(e,t,n){var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},o=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var c=e("eventemitter3"),u=e("./util"),l=s(e("./logger")),f=e("./socket"),h=e("./mediaconnection"),p=e("./dataconnection"),d=e("./enums"),v=e("./api"),y=function(e){function t(n,r){var o,a=e.call(this)||this;return a._destroyed=!1,a._disconnected=!1,a._open=!1,a._connections=new Map,a._lostMessages=new Map,n&&n.constructor==Object?r=n:n&&(o=n.toString()),r=i({debug:0,host:u.util.CLOUD_HOST,port:u.util.CLOUD_PORT,path:"/",key:t.DEFAULT_KEY,token:u.util.randomToken(),config:u.util.defaultConfig},r),a._options=r,"/"===a._options.host&&(a._options.host=window.location.hostname),a._options.path&&("/"!==a._options.path[0]&&(a._options.path="/"+a._options.path),"/"!==a._options.path[a._options.path.length-1]&&(a._options.path+="/")),void 0===a._options.secure&&a._options.host!==u.util.CLOUD_HOST?a._options.secure=u.util.isSecure():a._options.host==u.util.CLOUD_HOST&&(a._options.secure=!0),a._options.logFunction&&l.default.setLogFunction(a._options.logFunction),l.default.logLevel=a._options.debug||0,u.util.supports.audioVideo||u.util.supports.data?o&&!u.util.validateId(o)?(a._delayedAbort(d.PeerErrorType.InvalidID,'ID "'+o+'" is invalid'),a):(a._api=new v.API(r),a._initializeServerConnection(),o?a._initialize(o):a._api.retrieveId().then((function(e){return a._initialize(e)})).catch((function(e){return a._abort(d.PeerErrorType.ServerError,e)})),a):(a._delayedAbort(d.PeerErrorType.BrowserIncompatible,"The current browser does not support WebRTC"),a)}return r(t,e),Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"open",{get:function(){return this._open},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"socket",{get:function(){return this._socket},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"connections",{get:function(){var e,t,n=Object.create(null);try{for(var r=o(this._connections),i=r.next();!i.done;i=r.next()){var s=a(i.value,2),c=s[0],u=s[1];n[c]=u}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"destroyed",{get:function(){return this._destroyed},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"disconnected",{get:function(){return this._disconnected},enumerable:!0,configurable:!0}),t.prototype._initializeServerConnection=function(){var e=this;this._socket=new f.Socket(this._options.secure,this._options.host,this._options.port,this._options.path,this._options.key,this._options.pingInterval),this.socket.on(d.SocketEventType.Message,(function(t){e._handleMessage(t)})),this.socket.on(d.SocketEventType.Error,(function(t){e._abort(d.PeerErrorType.SocketError,t)})),this.socket.on(d.SocketEventType.Disconnected,(function(){e.disconnected||(e.emitError(d.PeerErrorType.Network,"Lost connection to server."),e.disconnect())})),this.socket.on(d.SocketEventType.Close,(function(){e.disconnected||e._abort(d.PeerErrorType.SocketClosed,"Underlying socket is already closed.")}))},t.prototype._initialize=function(e){this._id=e,this.socket.start(this.id,this._options.token)},t.prototype._handleMessage=function(e){var t,n,r=e.type,i=e.payload,a=e.src;switch(r){case d.ServerMessageType.Open:this.emit(d.PeerEventType.Open,this.id),this._open=!0;break;case d.ServerMessageType.Error:this._abort(d.PeerErrorType.ServerError,i.msg);break;case d.ServerMessageType.IdTaken:this._abort(d.PeerErrorType.UnavailableID,'ID "'+this.id+'" is taken');break;case d.ServerMessageType.InvalidKey:this._abort(d.PeerErrorType.InvalidKey,'API KEY "'+this._options.key+'" is invalid');break;case d.ServerMessageType.Leave:l.default.log("Received leave message from",a),this._cleanupPeer(a),this._connections.delete(a);break;case d.ServerMessageType.Expire:this.emitError(d.PeerErrorType.PeerUnavailable,"Could not connect to peer "+a);break;case d.ServerMessageType.Offer:var s=i.connectionId;if((y=this.getConnection(a,s))&&(y.close(),l.default.warn("Offer received for existing Connection ID:",s)),i.type===d.ConnectionType.Media)y=new h.MediaConnection(a,this,{connectionId:s,_payload:i,metadata:i.metadata}),this._addConnection(a,y),this.emit(d.PeerEventType.Call,y);else{if(i.type!==d.ConnectionType.Data)return void l.default.warn("Received malformed connection type:",i.type);y=new p.DataConnection(a,this,{connectionId:s,_payload:i,metadata:i.metadata,label:i.label,serialization:i.serialization,reliable:i.reliable}),this._addConnection(a,y),this.emit(d.PeerEventType.Connection,y)}var c=this._getMessages(s);try{for(var u=o(c),f=u.next();!f.done;f=u.next()){var v=f.value;y.handleMessage(v)}}catch(e){t={error:e}}finally{try{f&&!f.done&&(n=u.return)&&n.call(u)}finally{if(t)throw t.error}}break;default:if(!i)return void l.default.warn("You received a malformed message from "+a+" of type "+r);var y;s=i.connectionId,(y=this.getConnection(a,s))&&y.peerConnection?y.handleMessage(e):s?this._storeMessage(s,e):l.default.warn("You received an unrecognized message:",e)}},t.prototype._storeMessage=function(e,t){this._lostMessages.has(e)||this._lostMessages.set(e,[]),this._lostMessages.get(e).push(t)},t.prototype._getMessages=function(e){var t=this._lostMessages.get(e);return t?(this._lostMessages.delete(e),t):[]},t.prototype.connect=function(e,t){if(void 0===t&&(t={}),this.disconnected)return l.default.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect, or call reconnect on this peer if you believe its ID to still be available."),void this.emitError(d.PeerErrorType.Disconnected,"Cannot connect to new Peer after disconnecting from server.");var n=new p.DataConnection(e,this,t);return this._addConnection(e,n),n},t.prototype.call=function(e,t,n){if(void 0===n&&(n={}),this.disconnected)return l.default.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect."),void this.emitError(d.PeerErrorType.Disconnected,"Cannot connect to new Peer after disconnecting from server.");if(t){n._stream=t;var r=new h.MediaConnection(e,this,n);return this._addConnection(e,r),r}l.default.error("To call a peer, you must provide a stream from your browser's `getUserMedia`.")},t.prototype._addConnection=function(e,t){l.default.log("add connection "+t.type+":"+t.connectionId+"\n       to peerId:"+e),this._connections.has(e)||this._connections.set(e,[]),this._connections.get(e).push(t)},t.prototype._removeConnection=function(e){var t=this._connections.get(e.peer);if(t){var n=t.indexOf(e);-1!==n&&t.splice(n,1)}this._lostMessages.delete(e.connectionId)},t.prototype.getConnection=function(e,t){var n,r,i=this._connections.get(e);if(!i)return null;try{for(var a=o(i),s=a.next();!s.done;s=a.next()){var c=s.value;if(c.connectionId===t)return c}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return null},t.prototype._delayedAbort=function(e,t){var n=this;setTimeout((function(){n._abort(e,t)}),0)},t.prototype._abort=function(e,t){l.default.error("Aborting!"),this.emitError(e,t),this._lastServerId?this.disconnect():this.destroy()},t.prototype.emitError=function(e,t){l.default.error("Error:",t),"string"==typeof t&&(t=new Error(t)),t.type=e,this.emit(d.PeerEventType.Error,t)},t.prototype.destroy=function(){this.destroyed||(this._cleanup(),this.disconnect(),this._destroyed=!0)},t.prototype._cleanup=function(){var e,t;try{for(var n=o(this._connections.keys()),r=n.next();!r.done;r=n.next()){var i=r.value;this._cleanupPeer(i),this._connections.delete(i)}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.emit(d.PeerEventType.Close)},t.prototype._cleanupPeer=function(e){var t,n,r=this._connections.get(e);if(r)try{for(var i=o(r),a=i.next();!a.done;a=i.next())a.value.close()}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}},t.prototype.disconnect=function(){var e=this;setTimeout((function(){e.disconnected||(e._disconnected=!0,e._open=!1,e.socket&&e.socket.close(),e.emit(d.PeerEventType.Disconnected,e.id),e._lastServerId=e.id,e._id=null)}),0)},t.prototype.reconnect=function(){if(this.disconnected&&!this.destroyed)l.default.log("Attempting reconnection to server with ID "+this._lastServerId),this._disconnected=!1,this._initializeServerConnection(),this._initialize(this._lastServerId);else{if(this.destroyed)throw new Error("This peer cannot reconnect to the server. It has already been destroyed.");if(this.disconnected||this.open)throw new Error("Peer "+this.id+" cannot reconnect because it is not disconnected from the server!");l.default.error("In a hurry? We're still trying to make the initial connection!")}},t.prototype.listAllPeers=function(e){var t=this;void 0===e&&(e=function(e){}),this._api.listAllPeers().then((function(t){return e(t)})).catch((function(e){return t._abort(d.PeerErrorType.ServerError,e)}))},t.DEFAULT_KEY="peerjs",t}(c.EventEmitter);n.Peer=y},{eventemitter3:"2JJl","./util":"BHXf","./logger":"8WOs","./socket":"wJlv","./mediaconnection":"dbHP","./dataconnection":"GBTQ","./enums":"9ZRY","./api":"in7L"}],iTK6:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=e("./util"),i=e("./peer");n.peerjs={Peer:i.Peer,util:r.util},n.default=i.Peer,window.peerjs=n.peerjs,window.Peer=i.Peer},{"./util":"BHXf","./peer":"Hxpd"}]},{},["iTK6"])}))),z=function(e,t){return function(e,t){e.exports=function(){var e={},t="Array Object String Date RegExp Function Boolean Number Null Undefined".split(" ");function n(){return Object.prototype.toString.call(this).slice(8,-1)}for(var r=t.length;r--;)e["is"+t[r]]=function(e){return function(t){return n.call(t)===e}}(t[r]);return e}()}(t={exports:{}}),t.exports}(),G=z.isObject,q=z.isNumber,U=z.isArray,H=z.isString;function V(e,t){return t+e*(1&t)>>1}function $(e,t){return(e%t+t)%t}function Y(e,t){if(!/^(N|S)?(E|W)?$/i.test(e))throw new Error("Invalid compass direction: ".concat(e,". Choose from E, SE, S, SW, W, NW, N or NE."));if(t=t.toLowerCase(),e=e.toUpperCase(),"pointy"===t&&["N","S"].includes(e))throw new Error("Direction ".concat(e," is ambiguous for pointy hexes. Did you mean ").concat(e,"E or ").concat(e,"W?"));if("flat"===t&&["E","W"].includes(e))throw new Error("Direction ".concat(e," is ambiguous for flat hexes. Did you mean N").concat(e," or S").concat(e,"?"));return{pointy:{E:0,SE:1,SW:2,W:3,NW:4,NE:5},flat:{SE:0,S:1,SW:2,NW:3,N:4,NE:5}}[t][e]}function W(e,t){return q(e)||q(t)?q(e)?q(t)||(t=e):e=t:e=t=0,{x:e,y:t}}const X=[{q:1,r:0,s:-1},{q:0,r:1,s:-1},{q:-1,r:1,s:0},{q:-1,r:0,s:1},{q:0,r:-1,s:1},{q:1,r:-1,s:0}],J=[{q:2,r:-1,s:-1},{q:1,r:1,s:-2},{q:-1,r:2,s:-1},{q:-2,r:1,s:1},{q:-1,r:-1,s:2},{q:1,r:-2,s:1}],Q={x:1e-6,y:1e-6};function K(e){return q(e)?this[e]:this[this.indexOf(e)]}function Z(e){let{isValidHex:t}=e;return function(e,n){if(!t(n))return this;const r=q(e)?e:this.indexOf(e);return r<0?this.push(n):this[r]=n,this}}function ee(e,t){const n=e.distance(t),r=1/Math.max(n,1);let i=[];for(let o=0;o<=n;o++){const n=e.nudge().lerp(t.nudge(),r*o).round();i.push(this.get(n))}return i}function te(e){let{isValidHex:t}=e;return function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!t(e))throw new Error("Invalid center hex: ".concat(e,"."));if(!this.get(e))throw new Error("Center hex with coordinates ".concat(e," not present in grid."));let i=[];for(let t=-n;t<=n;t++)for(let o=Math.max(-n,-t-n);o<=Math.min(n,-t+n);o++){const n=this.get(e.cubeToCartesian({q:e.q+t,r:e.r+o}));e.equals(n)&&!r||i.push(n)}return i.filter(Boolean)}}function ne(e){let{isValidHex:t,signedModulo:n,compassToNumberDirection:r}=e;return function(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"all",o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!t(e))throw new Error("Invalid hex: ".concat(e,"."));const a=o?J:X;return"all"===i&&(i=[0,1,2,3,4,5]),[].concat(i).map(t=>{H(t)&&(t=r(t,e.orientation)),(t<0||t>5)&&(t=n(t,6));const{q:i,r:o}=a[t];return this.get(e.cubeToCartesian({q:e.q+i,r:e.r+o}))})}}function re(){if(0===this.length)return 0;const{0:e,length:t,[t-1]:n}=this[0].isPointy()?[...this].sort((e,t)=>t.s-e.s||e.q-t.q):[...this].sort((e,t)=>e.q-t.q);return n.toPoint().x-e.toPoint().x+this[0].width()}function ie(){if(0===this.length)return 0;const{0:e,length:t,[t-1]:n}=this[0].isPointy()?[...this].sort((e,t)=>e.r-t.r):[...this].sort((e,t)=>t.s-e.s||e.r-t.r);return n.toPoint().y-e.toPoint().y+this[0].height()}function oe(e){let{Hex:t}=e;return function(e,n){return t().fromPoint(e,n)}}function ae(e){let{Grid:t,Hex:n}=e;return function(e){let{width:r,height:i,start:o,direction:a=1,onCreate:s=(()=>{})}=e;o=n(o);const[c,u,l]={1:["q","r","s"],3:["r","s","q"],5:["s","q","r"]}[a],f=new t;f.width=r,f.height=i,f.start=o,f.direction=a;for(let e=0;e<r;e++)for(let t=0;t<i;t++){const r=n({[c]:e+o[c],[u]:t+o[u],[l]:-e-t+o[l]});s(r,f),f.push(r)}return f}}function se(e){let{Grid:t,Hex:n}=e;return function(e){let{size:r,start:i,direction:o=1,onCreate:a=(()=>{})}=e;i=n(i);const s={1:{rStart:()=>0,rEnd:e=>r-e},5:{rStart:e=>r-e,rEnd:()=>r+1}},{rStart:c,rEnd:u}=s[o],l=new t;l.size=r,l.start=i,l.direction=o;for(let e=0;e<r;e++)for(let t=c(e);t<u(e);t++){const r=n({q:e+i.q,r:t+i.r,s:-e-t+i.s});a(r,l),l.push(r)}return l}}function ce(e){let{Grid:t,Hex:n}=e;return function(e){let{radius:r,center:i,onCreate:o=(()=>{})}=e;i=n(i);const a=new t;a.radius=r,a.center=i;for(let e=-r;e<=r;e++){const t=Math.max(-r,-e-r),s=Math.min(r,-e+r);for(let r=t;r<=s;r++){const t=n({q:e+i.q,r:r+i.r,s:-e-r+i.s});o(t,a),a.push(t)}}return a}}function ue(e){let{Grid:t,Hex:n,compassToNumberDirection:r,signedModulo:i}=e;return function(e){let{width:o,height:a,start:s,direction:c=(n().isPointy()?0:1),onCreate:u=(()=>{})}=e;s=n(s),H(c)&&(c=r(c,s.orientation)),(c<0||c>5)&&(c=i(c,6));const[l,f,h]=[["q","r","s"],["r","q","s"],["r","s","q"],["s","r","q"],["s","q","r"],["q","s","r"]][c],[p,d]=s.isPointy()?[o,a]:[a,o],v=new t;v.width=o,v.height=a,v.start=s,v.direction=c;for(let e=0;e<d;e++){const t=V(s.offset,e);for(let r=-t;r<p-t;r++){const t=n({[l]:r+s[l],[f]:e+s[f],[h]:-r-e+s[h]});u(t,v),v.push(t)}}return v}}function le(e){let{Grid:t,Hex:n}=e;return function(e){let{radius:r,center:i,onCreate:o=(()=>{})}=e;i=n(i);const a=new t;a.radius=r,a.center=i;const{q:s,r:c,s:u}=i;let l=n({q:s,r:c-r,s:u+r});for(let e=0;e<6;e++)for(let t=0;t<r;t++){o(l,a),a.push(l);const{q:t,r:r,s:i}=X[e];l=n({q:l.q+t,r:l.r+r,s:l.s+i})}return a}}function fe(e){let{Grid:t,Hex:n}=e;return function(e){let{radius:r,center:i,onCreate:o=(()=>{})}=e;i=n(i);let a=new t;o(i,a),a.push(i);for(let e=1;e<=r;e++)a=a.concat(this.ring({radius:e,center:i,onCreate:o}));return a.radius=r,a.center=i,a}}function he(e){let{Point:t}=e;return function(e,n){let r;return({x:r,y:n}=t(e,n)),t(this.x+r,this.y+n)}}function pe(e){let{Point:t}=e;return function(e,n){let r;return({x:r,y:n}=t(e,n)),t(this.x-r,this.y-n)}}function de(e){let{Point:t}=e;return function(e,n){let r;return({x:r,y:n}=t(e,n)),t(this.x*r,this.y*n)}}function ve(e){let{Point:t}=e;return function(e,n){let r;return({x:r,y:n}=t(e,n)),t(this.x/r,this.y/n)}}function ye(e){let{ensureXY:t}=e;const n={add:he({Point:r}),subtract:pe({Point:r}),multiply:de({Point:r}),divide:ve({Point:r})};function r(e,r){let i;return i=q(e)?t(e,r):U(e)?t(...e):G(e)?t(e.x,e.y):t(0),Object.assign(Object.create(n),i)}return r}const me=ye({ensureXY:W});class ge extends Array{static isValidHex(e){return!0===(e||{}).__isHoneycombHex}fill(){throw new TypeError("Grid.prototype.fill is not implemented")}includes(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return!!(this.indexOf(e,t)+1)}indexOf(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const{length:n}=this;let r=Number(t);for(e=me(e),r=Math.max(r>=0?r:n+r,0);r<n;r++)if(this[r].equals(e))return r;return-1}lastIndexOf(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.length-1;const{length:n}=this;let r=Number(t);for(e=me(e),r=r>=0?Math.min(r,n-1):n+r;r>=0;r--)if(this[r].equals(e))return r;return-1}push(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return super.push(...t.filter(ge.isValidHex))}splice(e,t){if(null==t)return super.splice(e);for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return super.splice(e,t,...r.filter(ge.isValidHex))}unshift(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return super.unshift(...t.filter(ge.isValidHex))}}function be(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function we(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_e(n,!0).forEach((function(t){be(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_e(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Se(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function Ce(e){let{Hex:t}=e;return function(){return Object.assign(this,t(...arguments))}}function ke(){return{x:this.x,y:this.y}}function xe(){return{q:this.q,r:this.r,s:this.s}}function Te(e){let t,n,{q:r,r:i}=e;return this.isPointy()?(t=r+V(this.offset,i),n=i):(t=r,n=i+V(this.offset,r)),{x:t,y:n}}function Pe(e){let{Point:t}=e;return function(e,n){let r,i,o;return({x:r,y:n}=t(e,n)),this.isPointy()?(i=r-V(this.offset,n),o=n):(i=r,o=n-V(this.offset,r)),{q:i,r:o,s:-i-o}}}function Ee(){return"pointy"===this.orientation.toLowerCase()}function Oe(){return"flat"===this.orientation.toLowerCase()}function Re(){const{xRadius:e}=this.size;return this.isPointy()?e*Math.sqrt(3):2*e}function Me(){const{yRadius:e}=this.size;return this.isPointy()?2*e:e*Math.sqrt(3)}function je(e){let{Point:t}=e;return function(){const e=this.width(),n=this.height(),{x:r,y:i}=this.origin;return this.isPointy()?[t(e-r,.25*n-i),t(e-r,.75*n-i),t(.5*e-r,n-i),t(0-r,.75*n-i),t(0-r,.25*n-i),t(.5*e-r,0-i)]:[t(e-r,.5*n-i),t(.75*e-r,n-i),t(.25*e-r,n-i),t(0-r,.5*n-i),t(.25*e-r,0-i),t(.75*e-r,0-i)]}}function De(e){let{Point:t}=e;return function(){const{x:e,y:n}=this.origin;return t(this.width()/2-e,this.height()/2-n)}}function Ie(e){let{Point:t}=e;return function(){const{q:e,r:n,size:r}=this,{xRadius:i,yRadius:o}=r;let a,s;return this.isPointy()?(a=i*Math.sqrt(3)*(e+n/2),s=3*o/2*n):(a=3*i/2*e,s=o*Math.sqrt(3)*(n+e/2)),t(a,s)}}function Ae(e){let{Point:t,Hex:n}=e;return function(e,r){const{xRadius:i,yRadius:o}=this.size;let a,s,c;return({x:a,y:r}=t(e,r).subtract(this.center())),this.isPointy()?(s=Math.sqrt(3)*a/(3*i)-r/(3*o),c=2/3*(r/o)):(s=2/3*(a/i),c=Math.sqrt(3)*r/(3*o)-a/(3*i)),n({q:s,r:c,s:-s-c}).round()}}function Le(e){let{Hex:t,Point:n}=e;return function(e){const{x:r,y:i}=n(e);return t(this.x+r,this.y+i,we({},this))}}function Ne(e){let{Hex:t,Point:n}=e;return function(e){const{x:r,y:i}=n(e);return t(this.x-r,this.y-i,we({},this))}}function Be(e){let{Point:t}=e;return function(e){if(null!=e&&(U(e)||q(e.x)&&q(e.y))){const{x:n,y:r}=t(e);return this.x===n&&this.y===r}return!1}}function Fe(e){return Math.max(Math.abs(this.q-e.q),Math.abs(this.r-e.r),Math.abs(this.s-e.s))}function ze(e){let{Hex:t}=e;return function(){let{q:e,r:n,s:r}=this,i=Math.round(e),o=Math.round(n),a=Math.round(r);const s=Math.abs(e-i),c=Math.abs(n-o),u=Math.abs(r-a);return s>c&&s>u?i=-o-a:c>u?o=-i-a:a=-i-o,t(we({},this,{q:i,r:o,s:a}))}}function Ge(e){let{Hex:t}=e;return function(e,n){const r=this.q*(1-n)+e.q*n,i=this.r*(1-n)+e.r*n;return t(we({},this,{q:r,r:i,s:-r-i}))}}function qe(){return this.add(Q)}function Ue(){return"".concat(this.x,",").concat(this.y)}const He={thirdCoordinate:function(e,t){return-e-t}},Ve=ye({ensureXY:W}),$e=function(e){let{ensureXY:t,normalizeRadiuses:n,Point:r}=e;return function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const i=Pe({Point:r}),o={__isHoneycombHex:!0,orientation:"pointy",origin:0,size:{xRadius:1,yRadius:1},offset:-1,get q(){return this.cartesianToCube(this).q},get r(){return this.cartesianToCube(this).r},get s(){return this.cartesianToCube(this).s},add:Le({Hex:s,Point:r}),cartesian:ke,cartesianToCube:i,center:De({Point:r}),coordinates:ke,corners:je({Point:r}),cube:xe,cubeToCartesian:Te,distance:Fe,equals:Be({Point:r}),fromPoint:Ae({Point:r,Hex:s}),height:Me,isFlat:Oe,isPointy:Ee,lerp:Ge({Hex:s}),nudge:qe,round:ze({Hex:s}),set:Ce({Hex:s}),subtract:Ne({Hex:s,Point:r}),toCartesian:Te,toCube:i,toPoint:Ie({Point:r}),toString:Ue,width:Re},a=Object.assign(o,e);function s(e,n){let r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(G(e)){let{q:t,r:o,s:s}=e,c=Se(e,["q","r","s"]);if(q(t)||q(o)||q(s)){if(t+o+s!==0)throw new Error("Cube coordinates must have a sum of 0. q: ".concat(t,", r: ").concat(o,", s: ").concat(s,", sum: ").concat(t+o+s,"."));({x:r,y:n}=a.cubeToCartesian({q:t,r:o,s:s}))}else({x:r,y:n}=e);i=c}else U(e)?([r,n]=e,i={}):r=e;return Object.assign(Object.create(a),Object.assign(i,t(r,n)))}return a.size=n(a.size,a.isPointy()),a.origin=r(a.origin),Object.assign(s,He,{toJSON:()=>e}),s}}({ensureXY:W,normalizeRadiuses:function(e,t){if(G(e)){if(q(e.xRadius)&&q(e.yRadius))return e;const{width:n,height:r}=e;if(q(n)&&q(r))return t?{xRadius:n/Math.sqrt(3),yRadius:r/2}:{xRadius:n/2,yRadius:r/Math.sqrt(3)}}if(q(e))return{xRadius:e,yRadius:e};throw new Error("Invalid size: ".concat(e,". Set it as a number or as an object containing width and height."))},Point:Ve}),Ye=function(e){let{extendHex:t,Grid:n,Point:r}=e;const{isValidHex:i}=n;return function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t();function o(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return r=r.filter(Boolean),U(r[0])&&(0===r[0].length||r[0].some(e=>!q(e)))&&(r=r[0]),new n(...r.map(t=>e(t)))}return Object.assign(o,{Hex:e,isValidHex:i,pointToHex:oe({Point:r,Hex:e}),parallelogram:ae({Grid:n,Hex:e}),triangle:se({Grid:n,Hex:e}),hexagon:ce({Grid:n,Hex:e}),rectangle:ue({Grid:n,Hex:e,compassToNumberDirection:Y,signedModulo:$}),ring:le({Grid:n,Hex:e}),spiral:fe({Grid:n,Hex:e})}),Object.assign(n.prototype,{get:K,hexesBetween:ee,hexesInRange:te({isValidHex:i}),neighborsOf:ne({isValidHex:i,signedModulo:$,compassToNumberDirection:Y}),pointHeight:ie,pointWidth:re,set:Z({isValidHex:i})}),o}}({extendHex:$e,Grid:ge,Point:Ve}),We=9,Xe={1:"#000000",2:"#FF0000"};class Je{constructor(){this.peer=null,this.connections=[],this.players=[],this.createGame()}start(){return new Promise((e,t)=>{this.peer=new F,this.peer.on("open",(function(t){e(t)})),this.peer.on("connection",e=>{this.connections.push(e),this.players.push({peerId:e.peer,playerId:this.players.length?Math.max(this.players.map(e=>e.playerId))+1:1}),e.on("data",t=>{t.request&&this.handleRequest(e,t.request),t.action&&this.handleAction(e,t.action,t.data)})})})}createGame(){const e=Ye(),t=[];e.parallelogram({width:We,height:We}).forEach(e=>{t.push({x:e.x,y:e.y,playerPiece:null})}),this.gameState={playerTurn:1,grid:t}}resetGame(){this.createGame(),this.broadcastGameState()}handleRequest(e,t){switch(t){case"state":e.send({type:"state",data:this.gameState});break;default:console.error("Unable to handle request: "+t)}}handleAction(e,t,n){const r=this.getPlayerFromConnection(e);if(r)switch(t){case"play":if(r.playerId!==this.gameState.playerTurn)return;this.gameState.grid.find(e=>n.x===e.x&&n.y===e.y).playerPiece=r.playerId,this.gameState.playerTurn=this.gameState.playerTurn%this.playerCount()+1,this.broadcastGameState();break;default:console.error("Unable to handle action: "+t)}}broadcastGameState(){this.connections.forEach(e=>{e.send({type:"state",data:this.gameState})})}getPlayerFromConnection(e){return this.players.find(t=>t.peerId===e.peer)}playerCount(){return this.players.length}}function Qe(t){let n,r;return{c(){(n=u("button")).textContent="Restart the game",r=h(n,"click",t.restartGame)},m(e,t){s(e,n,t)},p:e,d(e){e&&c(n),r()}}}function Ke(t){let n,r;return{c(){(n=u("button")).textContent="Create a host server and start game",r=h(n,"click",t.createGameHost)},m(e,t){s(e,n,t)},p:e,d(e){e&&c(n),r()}}}function Ze(t){let n,r,i,o,h,p;function d(e,t){return t.hostId?Qe:Ke}let v=d(0,t),y=v(t);return{c(){(n=u("h1")).textContent="Host",r=f(),y.c(),i=f(),o=u("p"),h=l("Id : "),p=l(t.hostId)},m(e,t){s(e,n,t),s(e,r,t),y.m(e,t),s(e,i,t),s(e,o,t),a(o,h),a(o,p)},p(e,t){v===(v=d(0,t))&&y?y.p(e,t):(y.d(1),(y=v(t))&&(y.c(),y.m(i.parentNode,i))),e.hostId&&function(e,t){t=""+t,e.data!==t&&(e.data=t)}(p,t.hostId)},i:e,o:e,d(e){e&&c(n),e&&c(r),y.d(e),e&&c(i),e&&c(o)}}}function et(e,t,n){const r=new Je;let i;return{hostId:i,createGameHost:function(){r.start().then(e=>n("hostId",i=e))},restartGame:function(){r.resetGame()}}}class tt extends N{constructor(e){super(),L(this,e,et,Ze,o,{})}}var nt="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function rt(e,t){return e(t={exports:{}},t.exports),t.exports}var it,ot,at,st=function(e){return e&&e.Math==Math&&e},ct=st("object"==typeof globalThis&&globalThis)||st("object"==typeof window&&window)||st("object"==typeof self&&self)||st("object"==typeof nt&&nt)||Function("return this")(),ut=function(e){try{return!!e()}catch(e){return!0}},lt=!ut((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})),ft={}.propertyIsEnumerable,ht=Object.getOwnPropertyDescriptor,pt={f:ht&&!ft.call({1:2},1)?function(e){var t=ht(this,e);return!!t&&t.enumerable}:ft},dt=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},vt={}.toString,yt=function(e){return vt.call(e).slice(8,-1)},mt="".split,gt=ut((function(){return!Object("z").propertyIsEnumerable(0)}))?function(e){return"String"==yt(e)?mt.call(e,""):Object(e)}:Object,bt=function(e){if(null==e)throw TypeError("Can't call method on "+e);return e},_t=function(e){return gt(bt(e))},wt=function(e){return"object"==typeof e?null!==e:"function"==typeof e},St=function(e,t){if(!wt(e))return e;var n,r;if(t&&"function"==typeof(n=e.toString)&&!wt(r=n.call(e)))return r;if("function"==typeof(n=e.valueOf)&&!wt(r=n.call(e)))return r;if(!t&&"function"==typeof(n=e.toString)&&!wt(r=n.call(e)))return r;throw TypeError("Can't convert object to primitive value")},Ct={}.hasOwnProperty,kt=function(e,t){return Ct.call(e,t)},xt=ct.document,Tt=wt(xt)&&wt(xt.createElement),Pt=function(e){return Tt?xt.createElement(e):{}},Et=!lt&&!ut((function(){return 7!=Object.defineProperty(Pt("div"),"a",{get:function(){return 7}}).a})),Ot=Object.getOwnPropertyDescriptor,Rt={f:lt?Ot:function(e,t){if(e=_t(e),t=St(t,!0),Et)try{return Ot(e,t)}catch(e){}if(kt(e,t))return dt(!pt.f.call(e,t),e[t])}},Mt=function(e){if(!wt(e))throw TypeError(String(e)+" is not an object");return e},jt=Object.defineProperty,Dt={f:lt?jt:function(e,t,n){if(Mt(e),t=St(t,!0),Mt(n),Et)try{return jt(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},It=lt?function(e,t,n){return Dt.f(e,t,dt(1,n))}:function(e,t,n){return e[t]=n,e},At=function(e,t){try{It(ct,e,t)}catch(n){ct[e]=t}return t},Lt=ct["__core-js_shared__"]||At("__core-js_shared__",{}),Nt=rt((function(e){(e.exports=function(e,t){return Lt[e]||(Lt[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.3.6",mode:"global",copyright:" 2019 Denis Pushkarev (zloirock.ru)"})})),Bt=Nt("native-function-to-string",Function.toString),Ft=ct.WeakMap,zt="function"==typeof Ft&&/native code/.test(Bt.call(Ft)),Gt=0,qt=Math.random(),Ut=function(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++Gt+qt).toString(36)},Ht=Nt("keys"),Vt=function(e){return Ht[e]||(Ht[e]=Ut(e))},$t={},Yt=ct.WeakMap;if(zt){var Wt=new Yt,Xt=Wt.get,Jt=Wt.has,Qt=Wt.set;it=function(e,t){return Qt.call(Wt,e,t),t},ot=function(e){return Xt.call(Wt,e)||{}},at=function(e){return Jt.call(Wt,e)}}else{var Kt=Vt("state");$t[Kt]=!0,it=function(e,t){return It(e,Kt,t),t},ot=function(e){return kt(e,Kt)?e[Kt]:{}},at=function(e){return kt(e,Kt)}}var Zt,en,tn={set:it,get:ot,has:at,enforce:function(e){return at(e)?ot(e):it(e,{})},getterFor:function(e){return function(t){var n;if(!wt(t)||(n=ot(t)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return n}}},nn=rt((function(e){var t=tn.get,n=tn.enforce,r=String(Bt).split("toString");Nt("inspectSource",(function(e){return Bt.call(e)})),(e.exports=function(e,t,i,o){var a=!!o&&!!o.unsafe,s=!!o&&!!o.enumerable,c=!!o&&!!o.noTargetGet;"function"==typeof i&&("string"!=typeof t||kt(i,"name")||It(i,"name",t),n(i).source=r.join("string"==typeof t?t:"")),e!==ct?(a?!c&&e[t]&&(s=!0):delete e[t],s?e[t]=i:It(e,t,i)):s?e[t]=i:At(t,i)})(Function.prototype,"toString",(function(){return"function"==typeof this&&t(this).source||Bt.call(this)}))})),rn=ct,on=function(e){return"function"==typeof e?e:void 0},an=function(e,t){return arguments.length<2?on(rn[e])||on(ct[e]):rn[e]&&rn[e][t]||ct[e]&&ct[e][t]},sn=Math.ceil,cn=Math.floor,un=function(e){return isNaN(e=+e)?0:(e>0?cn:sn)(e)},ln=Math.min,fn=function(e){return e>0?ln(un(e),9007199254740991):0},hn=Math.max,pn=Math.min,dn=function(e,t){var n=un(e);return n<0?hn(n+t,0):pn(n,t)},vn=function(e){return function(t,n,r){var i,o=_t(t),a=fn(o.length),s=dn(r,a);if(e&&n!=n){for(;a>s;)if((i=o[s++])!=i)return!0}else for(;a>s;s++)if((e||s in o)&&o[s]===n)return e||s||0;return!e&&-1}},yn={includes:vn(!0),indexOf:vn(!1)},mn=yn.indexOf,gn=function(e,t){var n,r=_t(e),i=0,o=[];for(n in r)!kt($t,n)&&kt(r,n)&&o.push(n);for(;t.length>i;)kt(r,n=t[i++])&&(~mn(o,n)||o.push(n));return o},bn=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],_n=bn.concat("length","prototype"),wn={f:Object.getOwnPropertyNames||function(e){return gn(e,_n)}},Sn={f:Object.getOwnPropertySymbols},Cn=an("Reflect","ownKeys")||function(e){var t=wn.f(Mt(e)),n=Sn.f;return n?t.concat(n(e)):t},kn=function(e,t){for(var n=Cn(t),r=Dt.f,i=Rt.f,o=0;o<n.length;o++){var a=n[o];kt(e,a)||r(e,a,i(t,a))}},xn=/#|\.prototype\./,Tn=function(e,t){var n=En[Pn(e)];return n==Rn||n!=On&&("function"==typeof t?ut(t):!!t)},Pn=Tn.normalize=function(e){return String(e).replace(xn,".").toLowerCase()},En=Tn.data={},On=Tn.NATIVE="N",Rn=Tn.POLYFILL="P",Mn=Tn,jn=Rt.f,Dn=function(e,t){var n,r,i,o,a,s=e.target,c=e.global,u=e.stat;if(n=c?ct:u?ct[s]||At(s,{}):(ct[s]||{}).prototype)for(r in t){if(o=t[r],i=e.noTargetGet?(a=jn(n,r))&&a.value:n[r],!Mn(c?r:s+(u?".":"#")+r,e.forced)&&void 0!==i){if(typeof o==typeof i)continue;kn(o,i)}(e.sham||i&&i.sham)&&It(o,"sham",!0),nn(n,r,o,e)}},In=Array.isArray||function(e){return"Array"==yt(e)},An=function(e,t,n){var r=St(t);r in e?Dt.f(e,r,dt(0,n)):e[r]=n},Ln=!!Object.getOwnPropertySymbols&&!ut((function(){return!String(Symbol())})),Nn=ct.Symbol,Bn=Nt("wks"),Fn=function(e){return Bn[e]||(Bn[e]=Ln&&Nn[e]||(Ln?Nn:Ut)("Symbol."+e))},zn=an("navigator","userAgent")||"",Gn=ct.process,qn=Gn&&Gn.versions,Un=qn&&qn.v8;Un?en=(Zt=Un.split("."))[0]+Zt[1]:zn&&(!(Zt=zn.match(/Edge\/(\d+)/))||Zt[1]>=74)&&(Zt=zn.match(/Chrome\/(\d+)/))&&(en=Zt[1]);var Hn=en&&+en,Vn=Fn("species"),$n=function(e){return Hn>=51||!ut((function(){var t=[];return(t.constructor={})[Vn]=function(){return{foo:1}},1!==t[e](Boolean).foo}))},Yn=Fn("species"),Wn=[].slice,Xn=Math.max;Dn({target:"Array",proto:!0,forced:!$n("slice")},{slice:function(e,t){var n,r,i,o=_t(this),a=fn(o.length),s=dn(e,a),c=dn(void 0===t?a:t,a);if(In(o)&&("function"!=typeof(n=o.constructor)||n!==Array&&!In(n.prototype)?wt(n)&&null===(n=n[Yn])&&(n=void 0):n=void 0,n===Array||void 0===n))return Wn.call(o,s,c);for(r=new(void 0===n?Array:n)(Xn(c-s,0)),i=0;s<c;s++,i++)s in o&&An(r,i,o[s]);return r.length=i,r}});var Jn=Dt.f,Qn=Function.prototype,Kn=Qn.toString,Zn=/^\s*function ([^ (]*)/;!lt||"name"in Qn||Jn(Qn,"name",{configurable:!0,get:function(){try{return Kn.call(this).match(Zn)[1]}catch(e){return""}}});var er=wn.f,tr={}.toString,nr="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],rr={f:function(e){return nr&&"[object Window]"==tr.call(e)?function(e){try{return er(e)}catch(e){return nr.slice()}}(e):er(_t(e))}},ir=rr.f,or=ut((function(){return!Object.getOwnPropertyNames(1)}));function ar(e){return(ar="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function sr(e){return(sr="function"==typeof Symbol&&"symbol"===ar(Symbol.iterator)?function(e){return ar(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":ar(e)})(e)}Dn({target:"Object",stat:!0,forced:or},{getOwnPropertyNames:ir});var cr=function(e){return Object(bt(e))},ur=Object.keys||function(e){return gn(e,bn)},lr=lt?Object.defineProperties:function(e,t){Mt(e);for(var n,r=ur(t),i=r.length,o=0;i>o;)Dt.f(e,n=r[o++],t[n]);return e},fr=an("document","documentElement"),hr=Vt("IE_PROTO"),pr=function(){},dr=function(){var e,t=Pt("iframe"),n=bn.length;for(t.style.display="none",fr.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),dr=e.F;n--;)delete dr.prototype[bn[n]];return dr()},vr=Object.create||function(e,t){var n;return null!==e?(pr.prototype=Mt(e),n=new pr,pr.prototype=null,n[hr]=e):n=dr(),void 0===t?n:lr(n,t)};$t[hr]=!0;var yr={f:Fn},mr=Dt.f,gr=function(e){var t=rn.Symbol||(rn.Symbol={});kt(t,e)||mr(t,e,{value:yr.f(e)})},br=Dt.f,_r=Fn("toStringTag"),wr=function(e,t,n){e&&!kt(e=n?e:e.prototype,_r)&&br(e,_r,{configurable:!0,value:t})},Sr=function(e){if("function"!=typeof e)throw TypeError(String(e)+" is not a function");return e},Cr=function(e,t,n){if(Sr(e),void 0===t)return e;switch(n){case 0:return function(){return e.call(t)};case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}},kr=Fn("species"),xr=function(e,t){var n;return In(e)&&("function"!=typeof(n=e.constructor)||n!==Array&&!In(n.prototype)?wt(n)&&null===(n=n[kr])&&(n=void 0):n=void 0),new(void 0===n?Array:n)(0===t?0:t)},Tr=[].push,Pr=function(e){var t=1==e,n=2==e,r=3==e,i=4==e,o=6==e,a=5==e||o;return function(s,c,u,l){for(var f,h,p=cr(s),d=gt(p),v=Cr(c,u,3),y=fn(d.length),m=0,g=l||xr,b=t?g(s,y):n?g(s,0):void 0;y>m;m++)if((a||m in d)&&(h=v(f=d[m],m,p),e))if(t)b[m]=h;else if(h)switch(e){case 3:return!0;case 5:return f;case 6:return m;case 2:Tr.call(b,f)}else if(i)return!1;return o?-1:r||i?i:b}},Er={forEach:Pr(0),map:Pr(1),filter:Pr(2),some:Pr(3),every:Pr(4),find:Pr(5),findIndex:Pr(6)},Or=Er.forEach,Rr=Vt("hidden"),Mr=Fn("toPrimitive"),jr=tn.set,Dr=tn.getterFor("Symbol"),Ir=Object.prototype,Ar=ct.Symbol,Lr=ct.JSON,Nr=Lr&&Lr.stringify,Br=Rt.f,Fr=Dt.f,zr=rr.f,Gr=pt.f,qr=Nt("symbols"),Ur=Nt("op-symbols"),Hr=Nt("string-to-symbol-registry"),Vr=Nt("symbol-to-string-registry"),$r=Nt("wks"),Yr=ct.QObject,Wr=!Yr||!Yr.prototype||!Yr.prototype.findChild,Xr=lt&&ut((function(){return 7!=vr(Fr({},"a",{get:function(){return Fr(this,"a",{value:7}).a}})).a}))?function(e,t,n){var r=Br(Ir,t);r&&delete Ir[t],Fr(e,t,n),r&&e!==Ir&&Fr(Ir,t,r)}:Fr,Jr=function(e,t){var n=qr[e]=vr(Ar.prototype);return jr(n,{type:"Symbol",tag:e,description:t}),lt||(n.description=t),n},Qr=Ln&&"symbol"==typeof Ar.iterator?function(e){return"symbol"==typeof e}:function(e){return Object(e)instanceof Ar},Kr=function(e,t,n){e===Ir&&Kr(Ur,t,n),Mt(e);var r=St(t,!0);return Mt(n),kt(qr,r)?(n.enumerable?(kt(e,Rr)&&e[Rr][r]&&(e[Rr][r]=!1),n=vr(n,{enumerable:dt(0,!1)})):(kt(e,Rr)||Fr(e,Rr,dt(1,{})),e[Rr][r]=!0),Xr(e,r,n)):Fr(e,r,n)},Zr=function(e,t){Mt(e);var n=_t(t),r=ur(n).concat(ri(n));return Or(r,(function(t){lt&&!ei.call(n,t)||Kr(e,t,n[t])})),e},ei=function(e){var t=St(e,!0),n=Gr.call(this,t);return!(this===Ir&&kt(qr,t)&&!kt(Ur,t))&&(!(n||!kt(this,t)||!kt(qr,t)||kt(this,Rr)&&this[Rr][t])||n)},ti=function(e,t){var n=_t(e),r=St(t,!0);if(n!==Ir||!kt(qr,r)||kt(Ur,r)){var i=Br(n,r);return!i||!kt(qr,r)||kt(n,Rr)&&n[Rr][r]||(i.enumerable=!0),i}},ni=function(e){var t=zr(_t(e)),n=[];return Or(t,(function(e){kt(qr,e)||kt($t,e)||n.push(e)})),n},ri=function(e){var t=e===Ir,n=zr(t?Ur:_t(e)),r=[];return Or(n,(function(e){!kt(qr,e)||t&&!kt(Ir,e)||r.push(qr[e])})),r};Ln||(nn((Ar=function(){if(this instanceof Ar)throw TypeError("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?String(arguments[0]):void 0,t=Ut(e),n=function(e){this===Ir&&n.call(Ur,e),kt(this,Rr)&&kt(this[Rr],t)&&(this[Rr][t]=!1),Xr(this,t,dt(1,e))};return lt&&Wr&&Xr(Ir,t,{configurable:!0,set:n}),Jr(t,e)}).prototype,"toString",(function(){return Dr(this).tag})),pt.f=ei,Dt.f=Kr,Rt.f=ti,wn.f=rr.f=ni,Sn.f=ri,lt&&(Fr(Ar.prototype,"description",{configurable:!0,get:function(){return Dr(this).description}}),nn(Ir,"propertyIsEnumerable",ei,{unsafe:!0})),yr.f=function(e){return Jr(Fn(e),e)}),Dn({global:!0,wrap:!0,forced:!Ln,sham:!Ln},{Symbol:Ar}),Or(ur($r),(function(e){gr(e)})),Dn({target:"Symbol",stat:!0,forced:!Ln},{for:function(e){var t=String(e);if(kt(Hr,t))return Hr[t];var n=Ar(t);return Hr[t]=n,Vr[n]=t,n},keyFor:function(e){if(!Qr(e))throw TypeError(e+" is not a symbol");if(kt(Vr,e))return Vr[e]},useSetter:function(){Wr=!0},useSimple:function(){Wr=!1}}),Dn({target:"Object",stat:!0,forced:!Ln,sham:!lt},{create:function(e,t){return void 0===t?vr(e):Zr(vr(e),t)},defineProperty:Kr,defineProperties:Zr,getOwnPropertyDescriptor:ti}),Dn({target:"Object",stat:!0,forced:!Ln},{getOwnPropertyNames:ni,getOwnPropertySymbols:ri}),Dn({target:"Object",stat:!0,forced:ut((function(){Sn.f(1)}))},{getOwnPropertySymbols:function(e){return Sn.f(cr(e))}}),Lr&&Dn({target:"JSON",stat:!0,forced:!Ln||ut((function(){var e=Ar();return"[null]"!=Nr([e])||"{}"!=Nr({a:e})||"{}"!=Nr(Object(e))}))},{stringify:function(e){for(var t,n,r=[e],i=1;arguments.length>i;)r.push(arguments[i++]);if(n=t=r[1],(wt(t)||void 0!==e)&&!Qr(e))return In(t)||(t=function(e,t){if("function"==typeof n&&(t=n.call(this,e,t)),!Qr(t))return t}),r[1]=t,Nr.apply(Lr,r)}}),Ar.prototype[Mr]||It(Ar.prototype,Mr,Ar.prototype.valueOf),wr(Ar,"Symbol"),$t[Rr]=!0;var ii=Dt.f,oi=ct.Symbol;if(lt&&"function"==typeof oi&&(!("description"in oi.prototype)||void 0!==oi().description)){var ai={},si=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),t=this instanceof si?new oi(e):void 0===e?oi():oi(e);return""===e&&(ai[t]=!0),t};kn(si,oi);var ci=si.prototype=oi.prototype;ci.constructor=si;var ui=ci.toString,li="Symbol(test)"==String(oi("test")),fi=/^Symbol\((.*)\)[^)]+$/;ii(ci,"description",{configurable:!0,get:function(){var e=wt(this)?this.valueOf():this,t=ui.call(e);if(kt(ai,e))return"";var n=li?t.slice(7,-1):t.replace(fi,"$1");return""===n?void 0:n}}),Dn({global:!0,forced:!0},{Symbol:si})}gr("iterator");var hi=Fn("unscopables"),pi=Array.prototype;null==pi[hi]&&It(pi,hi,vr(null));var di,vi,yi,mi=function(e){pi[hi][e]=!0},gi={},bi=!ut((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})),_i=Vt("IE_PROTO"),wi=Object.prototype,Si=bi?Object.getPrototypeOf:function(e){return e=cr(e),kt(e,_i)?e[_i]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?wi:null},Ci=Fn("iterator"),ki=!1;[].keys&&("next"in(yi=[].keys())?(vi=Si(Si(yi)))!==Object.prototype&&(di=vi):ki=!0),null==di&&(di={}),kt(di,Ci)||It(di,Ci,(function(){return this}));var xi={IteratorPrototype:di,BUGGY_SAFARI_ITERATORS:ki},Ti=xi.IteratorPrototype,Pi=function(){return this},Ei=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(n,[]),t=n instanceof Array}catch(e){}return function(n,r){return Mt(n),function(e){if(!wt(e)&&null!==e)throw TypeError("Can't set "+String(e)+" as a prototype")}(r),t?e.call(n,r):n.__proto__=r,n}}():void 0),Oi=xi.IteratorPrototype,Ri=xi.BUGGY_SAFARI_ITERATORS,Mi=Fn("iterator"),ji=function(){return this},Di=function(e,t,n,r,i,o,a){!function(e,t,n){var r=t+" Iterator";e.prototype=vr(Ti,{next:dt(1,n)}),wr(e,r,!1),gi[r]=Pi}(n,t,r);var s,c,u,l=function(e){if(e===i&&v)return v;if(!Ri&&e in p)return p[e];switch(e){case"keys":case"values":case"entries":return function(){return new n(this,e)}}return function(){return new n(this)}},f=t+" Iterator",h=!1,p=e.prototype,d=p[Mi]||p["@@iterator"]||i&&p[i],v=!Ri&&d||l(i),y="Array"==t&&p.entries||d;if(y&&(s=Si(y.call(new e)),Oi!==Object.prototype&&s.next&&(Si(s)!==Oi&&(Ei?Ei(s,Oi):"function"!=typeof s[Mi]&&It(s,Mi,ji)),wr(s,f,!0))),"values"==i&&d&&"values"!==d.name&&(h=!0,v=function(){return d.call(this)}),p[Mi]!==v&&It(p,Mi,v),gi[t]=v,i)if(c={values:l("values"),keys:o?v:l("keys"),entries:l("entries")},a)for(u in c)!Ri&&!h&&u in p||nn(p,u,c[u]);else Dn({target:t,proto:!0,forced:Ri||h},c);return c},Ii=tn.set,Ai=tn.getterFor("Array Iterator"),Li=Di(Array,"Array",(function(e,t){Ii(this,{type:"Array Iterator",target:_t(e),index:0,kind:t})}),(function(){var e=Ai(this),t=e.target,n=e.kind,r=e.index++;return!t||r>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:r,done:!1}:"values"==n?{value:t[r],done:!1}:{value:[r,t[r]],done:!1}}),"values");gi.Arguments=gi.Array,mi("keys"),mi("values"),mi("entries");var Ni=Object.assign,Bi=!Ni||ut((function(){var e={},t={},n=Symbol();return e[n]=7,"abcdefghijklmnopqrst".split("").forEach((function(e){t[e]=e})),7!=Ni({},e)[n]||"abcdefghijklmnopqrst"!=ur(Ni({},t)).join("")}))?function(e,t){for(var n=cr(e),r=arguments.length,i=1,o=Sn.f,a=pt.f;r>i;)for(var s,c=gt(arguments[i++]),u=o?ur(c).concat(o(c)):ur(c),l=u.length,f=0;l>f;)s=u[f++],lt&&!a.call(c,s)||(n[s]=c[s]);return n}:Ni;Dn({target:"Object",stat:!0,forced:Object.assign!==Bi},{assign:Bi});var Fi=Fn("toStringTag"),zi="Arguments"==yt(function(){return arguments}()),Gi=function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),Fi))?n:zi?yt(t):"Object"==(r=yt(t))&&"function"==typeof t.callee?"Arguments":r},qi={};qi[Fn("toStringTag")]="z";var Ui="[object z]"!==String(qi)?function(){return"[object "+Gi(this)+"]"}:qi.toString,Hi=Object.prototype;Ui!==Hi.toString&&nn(Hi,"toString",Ui,{unsafe:!0});var Vi=!ut((function(){return Object.isExtensible(Object.preventExtensions({}))})),$i=rt((function(e){var t=Dt.f,n=Ut("meta"),r=0,i=Object.isExtensible||function(){return!0},o=function(e){t(e,n,{value:{objectID:"O"+ ++r,weakData:{}}})},a=e.exports={REQUIRED:!1,fastKey:function(e,t){if(!wt(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!kt(e,n)){if(!i(e))return"F";if(!t)return"E";o(e)}return e[n].objectID},getWeakData:function(e,t){if(!kt(e,n)){if(!i(e))return!0;if(!t)return!1;o(e)}return e[n].weakData},onFreeze:function(e){return Vi&&a.REQUIRED&&i(e)&&!kt(e,n)&&o(e),e}};$t[n]=!0})),Yi=Fn("iterator"),Wi=Array.prototype,Xi=Fn("iterator"),Ji=function(e,t,n,r){try{return r?t(Mt(n)[0],n[1]):t(n)}catch(t){var i=e.return;throw void 0!==i&&Mt(i.call(e)),t}},Qi=rt((function(e){var t=function(e,t){this.stopped=e,this.result=t};(e.exports=function(e,n,r,i,o){var a,s,c,u,l,f,h,p=Cr(n,r,i?2:1);if(o)a=e;else{if("function"!=typeof(s=function(e){if(null!=e)return e[Xi]||e["@@iterator"]||gi[Gi(e)]}(e)))throw TypeError("Target is not iterable");if(function(e){return void 0!==e&&(gi.Array===e||Wi[Yi]===e)}(s)){for(c=0,u=fn(e.length);u>c;c++)if((l=i?p(Mt(h=e[c])[0],h[1]):p(e[c]))&&l instanceof t)return l;return new t(!1)}a=s.call(e)}for(f=a.next;!(h=f.call(a)).done;)if("object"==typeof(l=Ji(a,p,h.value,i))&&l&&l instanceof t)return l;return new t(!1)}).stop=function(e){return new t(!0,e)}})),Ki=function(e,t,n){if(!(e instanceof t))throw TypeError("Incorrect "+(n?n+" ":"")+"invocation");return e},Zi=Fn("iterator"),eo=!1;try{var to=0,no={next:function(){return{done:!!to++}},return:function(){eo=!0}};no[Zi]=function(){return this},Array.from(no,(function(){throw 2}))}catch(e){}var ro=function(e,t,n){var r,i;return Ei&&"function"==typeof(r=t.constructor)&&r!==n&&wt(i=r.prototype)&&i!==n.prototype&&Ei(e,i),e},io=function(e,t,n){for(var r in t)nn(e,r,t[r],n);return e},oo=Fn("species"),ao=Dt.f,so=$i.fastKey,co=tn.set,uo=tn.getterFor,lo=(function(e,t,n,r,i){var o=ct[e],a=o&&o.prototype,s=o,c=r?"set":"add",u={},l=function(e){var t=a[e];nn(a,e,"add"==e?function(e){return t.call(this,0===e?0:e),this}:"delete"==e?function(e){return!(i&&!wt(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return i&&!wt(e)?void 0:t.call(this,0===e?0:e)}:"has"==e?function(e){return!(i&&!wt(e))&&t.call(this,0===e?0:e)}:function(e,n){return t.call(this,0===e?0:e,n),this})};if(Mn(e,"function"!=typeof o||!(i||a.forEach&&!ut((function(){(new o).entries().next()})))))s=n.getConstructor(t,e,r,c),$i.REQUIRED=!0;else if(Mn(e,!0)){var f=new s,h=f[c](i?{}:-0,1)!=f,p=ut((function(){f.has(1)})),d=function(e,t){if(!t&&!eo)return!1;var n=!1;try{var r={};r[Zi]=function(){return{next:function(){return{done:n=!0}}}},e(r)}catch(e){}return n}((function(e){new o(e)})),v=!i&&ut((function(){for(var e=new o,t=5;t--;)e[c](t,t);return!e.has(-0)}));d||((s=t((function(t,n){Ki(t,s,e);var i=ro(new o,t,s);return null!=n&&Qi(n,i[c],i,r),i}))).prototype=a,a.constructor=s),(p||v)&&(l("delete"),l("has"),r&&l("get")),(v||h)&&l(c),i&&a.clear&&delete a.clear}u[e]=s,Dn({global:!0,forced:s!=o},u),wr(s,e),i||n.setStrong(s,e,r)}("Set",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),{getConstructor:function(e,t,n,r){var i=e((function(e,o){Ki(e,i,t),co(e,{type:t,index:vr(null),first:void 0,last:void 0,size:0}),lt||(e.size=0),null!=o&&Qi(o,e[r],e,n)})),o=uo(t),a=function(e,t,n){var r,i,a=o(e),c=s(e,t);return c?c.value=n:(a.last=c={index:i=so(t,!0),key:t,value:n,previous:r=a.last,next:void 0,removed:!1},a.first||(a.first=c),r&&(r.next=c),lt?a.size++:e.size++,"F"!==i&&(a.index[i]=c)),e},s=function(e,t){var n,r=o(e),i=so(t);if("F"!==i)return r.index[i];for(n=r.first;n;n=n.next)if(n.key==t)return n};return io(i.prototype,{clear:function(){for(var e=o(this),t=e.index,n=e.first;n;)n.removed=!0,n.previous&&(n.previous=n.previous.next=void 0),delete t[n.index],n=n.next;e.first=e.last=void 0,lt?e.size=0:this.size=0},delete:function(e){var t=o(this),n=s(this,e);if(n){var r=n.next,i=n.previous;delete t.index[n.index],n.removed=!0,i&&(i.next=r),r&&(r.previous=i),t.first==n&&(t.first=r),t.last==n&&(t.last=i),lt?t.size--:this.size--}return!!n},forEach:function(e){for(var t,n=o(this),r=Cr(e,arguments.length>1?arguments[1]:void 0,3);t=t?t.next:n.first;)for(r(t.value,t.key,this);t&&t.removed;)t=t.previous},has:function(e){return!!s(this,e)}}),io(i.prototype,n?{get:function(e){var t=s(this,e);return t&&t.value},set:function(e,t){return a(this,0===e?0:e,t)}}:{add:function(e){return a(this,e=0===e?0:e,e)}}),lt&&ao(i.prototype,"size",{get:function(){return o(this).size}}),i},setStrong:function(e,t,n){var r=t+" Iterator",i=uo(t),o=uo(r);Di(e,t,(function(e,t){co(this,{type:r,target:e,state:i(e),kind:t,last:void 0})}),(function(){for(var e=o(this),t=e.kind,n=e.last;n&&n.removed;)n=n.previous;return e.target&&(e.last=n=n?n.next:e.state.first)?"keys"==t?{value:n.key,done:!1}:"values"==t?{value:n.value,done:!1}:{value:[n.key,n.value],done:!1}:(e.target=void 0,{value:void 0,done:!0})}),n?"entries":"values",!n,!0),function(e){var t=an(e),n=Dt.f;lt&&t&&!t[oo]&&n(t,oo,{configurable:!0,get:function(){return this}})}(t)}}),function(e){return function(t,n){var r,i,o=String(bt(t)),a=un(n),s=o.length;return a<0||a>=s?e?"":void 0:(r=o.charCodeAt(a))<55296||r>56319||a+1===s||(i=o.charCodeAt(a+1))<56320||i>57343?e?o.charAt(a):r:e?o.slice(a,a+2):i-56320+(r-55296<<10)+65536}}),fo={codeAt:lo(!1),charAt:lo(!0)},ho=fo.charAt,po=tn.set,vo=tn.getterFor("String Iterator");Di(String,"String",(function(e){po(this,{type:"String Iterator",string:String(e),index:0})}),(function(){var e,t=vo(this),n=t.string,r=t.index;return r>=n.length?{value:void 0,done:!0}:(e=ho(n,r),t.index+=e.length,{value:e,done:!1})}));var yo={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},mo=Fn("iterator"),go=Fn("toStringTag"),bo=Li.values;for(var _o in yo){var wo=ct[_o],So=wo&&wo.prototype;if(So){if(So[mo]!==bo)try{It(So,mo,bo)}catch(e){So[mo]=bo}if(So[go]||It(So,go,_o),yo[_o])for(var Co in Li)if(So[Co]!==Li[Co])try{It(So,Co,Li[Co])}catch(e){So[Co]=Li[Co]}}}function ko(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var xo={},To=[];function Po(e,t){if(Array.isArray(e)){var n=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){Po(o.value,t)}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}}else if("object"!==sr(e))Oo(Object.getOwnPropertyNames(t)),xo[e]=Object.assign(xo[e]||{},t);else for(var s in e)Po(s,e[s])}function Eo(e){return xo[e]||{}}function Oo(e){To.push.apply(To,ko(e))}var Ro=yn.includes;Dn({target:"Array",proto:!0},{includes:function(e){return Ro(this,e,arguments.length>1?arguments[1]:void 0)}}),mi("includes");var Mo,jo,Do=function(){var e=Mt(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t},Io=RegExp.prototype.exec,Ao=String.prototype.replace,Lo=Io,No=(Mo=/a/,jo=/b*/g,Io.call(Mo,"a"),Io.call(jo,"a"),0!==Mo.lastIndex||0!==jo.lastIndex),Bo=void 0!==/()??/.exec("")[1];(No||Bo)&&(Lo=function(e){var t,n,r,i,o=this;return Bo&&(n=new RegExp("^"+o.source+"$(?!\\s)",Do.call(o))),No&&(t=o.lastIndex),r=Io.call(o,e),No&&r&&(o.lastIndex=o.global?r.index+r[0].length:t),Bo&&r&&r.length>1&&Ao.call(r[0],n,(function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(r[i]=void 0)})),r});var Fo=Lo;Dn({target:"RegExp",proto:!0,forced:/./.exec!==Fo},{exec:Fo});var zo=Fn("match"),Go=function(e){var t;return wt(e)&&(void 0!==(t=e[zo])?!!t:"RegExp"==yt(e))},qo=function(e){if(Go(e))throw TypeError("The method doesn't accept regular expressions");return e},Uo=Fn("match");Dn({target:"String",proto:!0,forced:!function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[Uo]=!1,"/./"[e](t)}catch(e){}}return!1}("includes")},{includes:function(e){return!!~String(bt(this)).indexOf(qo(e),arguments.length>1?arguments[1]:void 0)}});var Ho=Fn("species"),Vo=!ut((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})),$o=!ut((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var n="ab".split(e);return 2!==n.length||"a"!==n[0]||"b"!==n[1]})),Yo=function(e,t,n,r){var i=Fn(e),o=!ut((function(){var t={};return t[i]=function(){return 7},7!=""[e](t)})),a=o&&!ut((function(){var t=!1,n=/a/;return"split"===e&&((n={}).constructor={},n.constructor[Ho]=function(){return n},n.flags="",n[i]=/./[i]),n.exec=function(){return t=!0,null},n[i](""),!t}));if(!o||!a||"replace"===e&&!Vo||"split"===e&&!$o){var s=/./[i],c=n(i,""[e],(function(e,t,n,r,i){return t.exec===Fo?o&&!i?{done:!0,value:s.call(t,n,r)}:{done:!0,value:e.call(n,t,r)}:{done:!1}})),u=c[0],l=c[1];nn(String.prototype,e,u),nn(RegExp.prototype,i,2==t?function(e,t){return l.call(e,this,t)}:function(e){return l.call(e,this)}),r&&It(RegExp.prototype[i],"sham",!0)}},Wo=fo.charAt,Xo=function(e,t,n){return t+(n?Wo(e,t).length:1)},Jo=function(e,t){var n=e.exec;if("function"==typeof n){var r=n.call(e,t);if("object"!=typeof r)throw TypeError("RegExp exec method returned something other than an Object or null");return r}if("RegExp"!==yt(e))throw TypeError("RegExp#exec called on incompatible receiver");return Fo.call(e,t)},Qo=Math.max,Ko=Math.min,Zo=Math.floor,ea=/\$([$&'`]|\d\d?|<[^>]*>)/g,ta=/\$([$&'`]|\d\d?)/g,na=function(e){return void 0===e?e:String(e)};Yo("replace",2,(function(e,t,n){return[function(n,r){var i=bt(this),o=null==n?void 0:n[e];return void 0!==o?o.call(n,i,r):t.call(String(i),n,r)},function(e,i){var o=n(t,e,this,i);if(o.done)return o.value;var a=Mt(e),s=String(this),c="function"==typeof i;c||(i=String(i));var u=a.global;if(u){var l=a.unicode;a.lastIndex=0}for(var f=[];;){var h=Jo(a,s);if(null===h)break;if(f.push(h),!u)break;""===String(h[0])&&(a.lastIndex=Xo(s,fn(a.lastIndex),l))}for(var p="",d=0,v=0;v<f.length;v++){h=f[v];for(var y=String(h[0]),m=Qo(Ko(un(h.index),s.length),0),g=[],b=1;b<h.length;b++)g.push(na(h[b]));var _=h.groups;if(c){var w=[y].concat(g,m,s);void 0!==_&&w.push(_);var S=String(i.apply(void 0,w))}else S=r(y,s,m,g,_,i);m>=d&&(p+=s.slice(d,m)+S,d=m+y.length)}return p+s.slice(d)}];function r(e,n,r,i,o,a){var s=r+e.length,c=i.length,u=ta;return void 0!==o&&(o=cr(o),u=ea),t.call(a,u,(function(t,a){var u;switch(a.charAt(0)){case"$":return"$";case"&":return e;case"`":return n.slice(0,r);case"'":return n.slice(s);case"<":u=o[a.slice(1,-1)];break;default:var l=+a;if(0===l)return t;if(l>c){var f=Zo(l/10);return 0===f?t:f<=c?void 0===i[f-1]?a.charAt(1):i[f-1]+a.charAt(1):t}u=i[l-1]}return void 0===u?"":u}))}}));var ra="\t\n\v\f\r \u2028\u2029\ufeff",ia="["+ra+"]",oa=RegExp("^"+ia+ia+"*"),aa=RegExp(ia+ia+"*$"),sa=function(e){return function(t){var n=String(bt(t));return 1&e&&(n=n.replace(oa,"")),2&e&&(n=n.replace(aa,"")),n}},ca={start:sa(1),end:sa(2),trim:sa(3)},ua=ca.trim;function la(e,t){var n,r=e.length,i=[];for(n=0;n<r;n++)i.push(t(e[n]));return i}function fa(e){return e%360*Math.PI/180}function ha(e){return e.toLowerCase().replace(/-(.)/g,(function(e,t){return t.toUpperCase()}))}function pa(e){return e.replace(/([A-Z])/g,(function(e,t){return"-"+t.toLowerCase()}))}function da(e){return e.charAt(0).toUpperCase()+e.slice(1)}function va(e,t,n,r){return null!=t&&null!=n||(r=r||e.bbox(),null==t?t=r.width/r.height*n:null==n&&(n=r.height/r.width*t)),{width:t,height:n}}function ya(e,t){var n,r,i=e.origin;if("string"==typeof i||null==i){var o=(i||"center").toLowerCase().trim(),a=t.bbox(),s=a.height,c=a.width,u=a.x,l=a.y,f=o.includes("left")?u:o.includes("right")?u+c:u+c/2,h=o.includes("top")?l:o.includes("bottom")?l+s:l+s/2;n=null!=e.ox?e.ox:f,r=null!=e.oy?e.oy:h}else n=i[0],r=i[1];return[n,r]}Dn({target:"String",proto:!0,forced:function(e){return ut((function(){return!!ra[e]()||""!=""[e]()||ra[e].name!==e}))}("trim")},{trim:function(){return ua(this)}});var ma="http://www.w3.org/2000/svg",ga="http://www.w3.org/2000/xmlns/",ba="http://www.w3.org/1999/xlink",_a={window:"undefined"==typeof window?null:window,document:"undefined"==typeof document?null:document};function wa(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var Sa=function e(){wa(this,e)},Ca={},ka="___SYMBOL___ROOT___";function xa(e){return _a.document.createElementNS(ma,e)}function Ta(e){if(e instanceof Sa)return e;if("object"===sr(e))return Oa(e);if(null==e)return new Ca[ka];if("string"==typeof e&&"<"!==e.charAt(0))return Oa(_a.document.querySelector(e));var t=xa("svg");return t.innerHTML=e,e=Oa(t.firstChild)}function Pa(e,t){return t instanceof _a.window.Node?t:xa(e)}function Ea(e){if(!e)return null;if(e.instance instanceof Sa)return e.instance;var t=da(e.nodeName||"Dom");return"LinearGradient"===t||"RadialGradient"===t?t="Gradient":Ca[t]||(t="Dom"),new Ca[t](e)}var Oa=Ea;function Ra(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.name,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Ca[t]=e,n&&(Ca[ka]=e),Oo(Object.getOwnPropertyNames(e.prototype)),e}var Ma=1e3;function ja(e){return"Svgjs"+da(e)+Ma++}function Da(e,t,n){var r,i;for(i=(e=Array.isArray(e)?e:[e]).length-1;i>=0;i--)for(r in t){var o=t[r];n&&(o=Ia(t[r])),e[i].prototype[r]=o}}function Ia(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=n[n.length-1];return!i||i.constructor!==Object||i instanceof Array?e.apply(this,n):e.apply(this,n.slice(0,-1)).attr(i)}}Po("Dom",{siblings:function(){return this.parent().children()},position:function(){return this.parent().index(this)},next:function(){return this.siblings()[this.position()+1]},prev:function(){return this.siblings()[this.position()-1]},forward:function(){var e=this.position()+1,t=this.parent();return t.removeElement(this).add(this,e),"function"==typeof t.isRoot&&t.isRoot()&&t.node.appendChild(t.defs().node),this},backward:function(){var e=this.position();return e>0&&this.parent().removeElement(this).add(this,e-1),this},front:function(){var e=this.parent();return e.node.appendChild(this.node),"function"==typeof e.isRoot&&e.isRoot()&&e.node.appendChild(e.defs().node),this},back:function(){return this.position()>0&&this.parent().removeElement(this).add(this,0),this},before:function(e){(e=Ta(e)).remove();var t=this.position();return this.parent().add(e,t),this},after:function(e){(e=Ta(e)).remove();var t=this.position();return this.parent().add(e,t+1),this},insertBefore:function(e){return(e=Ta(e)).before(this),this},insertAfter:function(e){return(e=Ta(e)).after(this),this}});var Aa=Er.filter;Dn({target:"Array",proto:!0,forced:!$n("filter")},{filter:function(e){return Aa(this,e,arguments.length>1?arguments[1]:void 0)}});var La=function(e,t){var n=[][e];return!n||!ut((function(){n.call(null,t||function(){throw 1},1)}))},Na=yn.indexOf,Ba=[].indexOf,Fa=!!Ba&&1/[1].indexOf(1,-0)<0,za=La("indexOf");Dn({target:"Array",proto:!0,forced:Fa||za},{indexOf:function(e){return Fa?Ba.apply(this,arguments)||0:Na(this,e,arguments.length>1?arguments[1]:void 0)}});var Ga=[].join,qa=gt!=Object,Ua=La("join",",");Dn({target:"Array",proto:!0,forced:qa||Ua},{join:function(e){return Ga.call(_t(this),void 0===e?",":e)}});var Ha=Fn("species"),Va=[].push,$a=Math.min,Ya=!ut((function(){return!RegExp(4294967295,"y")}));Yo("split",2,(function(e,t,n){var r;return r="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,n){var r=String(bt(this)),i=void 0===n?4294967295:n>>>0;if(0===i)return[];if(void 0===e)return[r];if(!Go(e))return t.call(r,e,i);for(var o,a,s,c=[],u=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),l=0,f=new RegExp(e.source,u+"g");(o=Fo.call(f,r))&&!((a=f.lastIndex)>l&&(c.push(r.slice(l,o.index)),o.length>1&&o.index<r.length&&Va.apply(c,o.slice(1)),s=o[0].length,l=a,c.length>=i));)f.lastIndex===o.index&&f.lastIndex++;return l===r.length?!s&&f.test("")||c.push(""):c.push(r.slice(l)),c.length>i?c.slice(0,i):c}:"0".split(void 0,0).length?function(e,n){return void 0===e&&0===n?[]:t.call(this,e,n)}:t,[function(t,n){var i=bt(this),o=null==t?void 0:t[e];return void 0!==o?o.call(t,i,n):r.call(String(i),t,n)},function(e,i){var o=n(r,e,this,i,r!==t);if(o.done)return o.value;var a=Mt(e),s=String(this),c=function(e,t){var n,r=Mt(e).constructor;return void 0===r||null==(n=Mt(r)[Ha])?t:Sr(n)}(a,RegExp),u=a.unicode,l=(a.ignoreCase?"i":"")+(a.multiline?"m":"")+(a.unicode?"u":"")+(Ya?"y":"g"),f=new c(Ya?a:"^(?:"+a.source+")",l),h=void 0===i?4294967295:i>>>0;if(0===h)return[];if(0===s.length)return null===Jo(f,s)?[s]:[];for(var p=0,d=0,v=[];d<s.length;){f.lastIndex=Ya?d:0;var y,m=Jo(f,Ya?s:s.slice(d));if(null===m||(y=$a(fn(f.lastIndex+(Ya?0:d)),s.length))===p)d=Xo(s,d,u);else{if(v.push(s.slice(p,d)),v.length===h)return v;for(var g=1;g<=m.length-1;g++)if(v.push(m[g]),v.length===h)return v;d=p=y}}return v.push(s.slice(p)),v}]}),!Ya);var Wa=/^([+-]?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?)([a-z%]*)$/i,Xa=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,Ja=/rgb\((\d+),(\d+),(\d+)\)/,Qa=/(#[a-z0-9\-_]+)/i,Ka=/\)\s*,?\s*/,Za=/\s/g,es=/^#[a-f0-9]{3,6}$/i,ts=/^rgb\(/,ns=/^(\s+)?$/,rs=/^[+-]?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,is=/\.(jpg|jpeg|png|gif|svg)(\?[^=]+.*)?/i,os=/[\s,]+/,as=/([^e])-/gi,ss=/[MLHVCSQTAZ]/gi,cs=/[MLHVCSQTAZ]/i,us=/((\d?\.\d+(?:e[+-]?\d+)?)((?:\.\d+(?:e[+-]?\d+)?)+))+/gi,ls=/\./g;Po("Dom",{classes:function(){var e=this.attr("class");return null==e?[]:e.trim().split(os)},hasClass:function(e){return-1!==this.classes().indexOf(e)},addClass:function(e){if(!this.hasClass(e)){var t=this.classes();t.push(e),this.attr("class",t.join(" "))}return this},removeClass:function(e){return this.hasClass(e)&&this.attr("class",this.classes().filter((function(t){return t!==e})).join(" ")),this},toggleClass:function(e){return this.hasClass(e)?this.removeClass(e):this.addClass(e)}});var fs=Er.forEach,hs=La("forEach")?function(e){return fs(this,e,arguments.length>1?arguments[1]:void 0)}:[].forEach;for(var ps in Dn({target:"Array",proto:!0,forced:[].forEach!=hs},{forEach:hs}),yo){var ds=ct[ps],vs=ds&&ds.prototype;if(vs&&vs.forEach!==hs)try{It(vs,"forEach",hs)}catch(e){vs.forEach=hs}}Po("Dom",{css:function(e,t){var n={};if(0===arguments.length)return this.node.style.cssText.split(/\s*;\s*/).filter((function(e){return!!e.length})).forEach((function(e){var t=e.split(/\s*:\s*/);n[t[0]]=t[1]})),n;if(arguments.length<2){if(Array.isArray(e)){var r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var c=ha(a.value);n[c]=this.node.style[c]}}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}if("string"==typeof e)return this.node.style[ha(e)];if("object"===sr(e))for(var u in e)this.node.style[ha(u)]=null==e[u]||ns.test(e[u])?"":e[u]}return 2===arguments.length&&(this.node.style[ha(e)]=null==t||ns.test(t)?"":t),this},show:function(){return this.css("display","")},hide:function(){return this.css("display","none")},visible:function(){return"none"!==this.css("display")}}),Po("Dom",{data:function(e,t,n){if("object"===sr(e))for(t in e)this.data(t,e[t]);else if(arguments.length<2)try{return JSON.parse(this.attr("data-"+e))}catch(t){return this.attr("data-"+e)}else this.attr("data-"+e,null===t?null:!0===n||"string"==typeof t||"number"==typeof t?t:JSON.stringify(t));return this}}),Po("Dom",{remember:function(e,t){if("object"===sr(arguments[0]))for(var n in e)this.remember(n,e[n]);else{if(1===arguments.length)return this.memory()[e];this.memory()[e]=t}return this},forget:function(){if(0===arguments.length)this._memory={};else for(var e=arguments.length-1;e>=0;e--)delete this.memory()[arguments[e]];return this},memory:function(){return this._memory=this._memory||{}}});var ys=function(e){return function(t,n,r,i){Sr(n);var o=cr(t),a=gt(o),s=fn(o.length),c=e?s-1:0,u=e?-1:1;if(r<2)for(;;){if(c in a){i=a[c],c+=u;break}if(c+=u,e?c<0:s<=c)throw TypeError("Reduce of empty array with no initial value")}for(;e?c>=0:s>c;c+=u)c in a&&(i=n(i,a[c],c,o));return i}},ms={left:ys(!1),right:ys(!0)}.left;Dn({target:"Array",proto:!0,forced:La("reduce")},{reduce:function(e){return ms(this,e,arguments.length,arguments.length>1?arguments[1]:void 0)}});var gs=0,bs={};function _s(e){var t=e.getEventHolder();return t===_a.window&&(t=bs),t.events||(t.events={}),t.events}function ws(e){return e.getEventTarget()}function Ss(e,t,n,r,i){var o=n.bind(r||e),a=Ta(e),s=_s(a),c=ws(a);t=Array.isArray(t)?t:t.split(os),n._svgjsListenerId||(n._svgjsListenerId=++gs),t.forEach((function(e){var t=e.split(".")[0],r=e.split(".")[1]||"*";s[t]=s[t]||{},s[t][r]=s[t][r]||{},s[t][r][n._svgjsListenerId]=o,c.addEventListener(t,o,i||!1)}))}function Cs(e,t,n,r){var i=Ta(e),o=_s(i),a=ws(i);("function"!=typeof n||(n=n._svgjsListenerId))&&(t=Array.isArray(t)?t:(t||"").split(os)).forEach((function(e){var t,s,c=e&&e.split(".")[0],u=e&&e.split(".")[1];if(n)o[c]&&o[c][u||"*"]&&(a.removeEventListener(c,o[c][u||"*"][n],r||!1),delete o[c][u||"*"][n]);else if(c&&u){if(o[c]&&o[c][u]){for(s in o[c][u])Cs(a,[c,u].join("."),s);delete o[c][u]}}else if(u)for(e in o)for(t in o[e])u===t&&Cs(a,[e,u].join("."));else if(c){if(o[c]){for(t in o[c])Cs(a,[c,t].join("."));delete o[c]}}else{for(e in o)Cs(a,e);!function(e){var t=e.getEventHolder();t.events&&(t.events={})}(i)}}))}var ks=Fn("isConcatSpreadable"),xs=Hn>=51||!ut((function(){var e=[];return e[ks]=!1,e.concat()[0]!==e})),Ts=$n("concat"),Ps=function(e){if(!wt(e))return!1;var t=e[ks];return void 0!==t?!!t:In(e)};Dn({target:"Array",proto:!0,forced:!xs||!Ts},{concat:function(e){var t,n,r,i,o,a=cr(this),s=xr(a,0),c=0;for(t=-1,r=arguments.length;t<r;t++)if(o=-1===t?a:arguments[t],Ps(o)){if(c+(i=fn(o.length))>9007199254740991)throw TypeError("Maximum allowed index exceeded");for(n=0;n<i;n++,c++)n in o&&An(s,c,o[n])}else{if(c>=9007199254740991)throw TypeError("Maximum allowed index exceeded");An(s,c++,o)}return s.length=c,s}});var Es=Er.map;Dn({target:"Array",proto:!0,forced:!$n("map")},{map:function(e){return Es(this,e,arguments.length>1?arguments[1]:void 0)}});var Os=Date.prototype,Rs=Os.toString,Ms=Os.getTime;new Date(NaN)+""!="Invalid Date"&&nn(Os,"toString",(function(){var e=Ms.call(this);return e==e?Rs.call(this):"Invalid Date"}));var js=ca.trim,Ds=ct.parseInt,Is=/^[+-]?0[Xx]/,As=8!==Ds(ra+"08")||22!==Ds(ra+"0x16")?function(e,t){var n=js(String(e));return Ds(n,t>>>0||(Is.test(n)?16:10))}:Ds;Dn({global:!0,forced:parseInt!=As},{parseInt:As});var Ls=RegExp.prototype,Ns=Ls.toString,Bs=ut((function(){return"/a/b"!=Ns.call({source:"a",flags:"b"})})),Fs="toString"!=Ns.name;function zs(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Gs(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function qs(e,t,n){return t&&Gs(e.prototype,t),n&&Gs(e,n),e}function Us(e){return 4===e.length?["#",e.substring(1,2),e.substring(1,2),e.substring(2,3),e.substring(2,3),e.substring(3,4),e.substring(3,4)].join(""):e}function Hs(e){var t=Math.round(e),n=Math.max(0,Math.min(255,t)).toString(16);return 1===n.length?"0"+n:n}function Vs(e,t){for(var n=t.length;n--;)if(null==e[t[n]])return!1;return!0}function $s(e,t){var n=Vs(e,"rgb")?{_a:e.r,_b:e.g,_c:e.b,space:"rgb"}:Vs(e,"xyz")?{_a:e.x,_b:e.y,_c:e.z,_d:0,space:"xyz"}:Vs(e,"hsl")?{_a:e.h,_b:e.s,_c:e.l,_d:0,space:"hsl"}:Vs(e,"lab")?{_a:e.l,_b:e.a,_c:e.b,_d:0,space:"lab"}:Vs(e,"lch")?{_a:e.l,_b:e.c,_c:e.h,_d:0,space:"lch"}:Vs(e,"cmyk")?{_a:e.c,_b:e.m,_c:e.y,_d:e.k,space:"cmyk"}:{_a:0,_b:0,_c:0,space:"rgb"};return n.space=t||n.space,n}function Ys(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}(Bs||Fs)&&nn(RegExp.prototype,"toString",(function(){var e=Mt(this),t=String(e.source),n=e.flags;return"/"+t+"/"+String(void 0===n&&e instanceof RegExp&&!("flags"in Ls)?Do.call(e):n)}),{unsafe:!0});var Ws=function(){function e(){wa(this,e),this.init.apply(this,arguments)}return qs(e,[{key:"init",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"rgb";if(e=e||0,this.space)for(var o in this.space)delete this[this.space[o]];if("number"==typeof e)i="string"==typeof r?r:i,r="string"==typeof r?0:r,Object.assign(this,{_a:e,_b:t,_c:n,_d:r,space:i});else if(e instanceof Array)this.space=t||("string"==typeof e[3]?e[3]:e[4])||"rgb",Object.assign(this,{_a:e[0],_b:e[1],_c:e[2],_d:e[3]||0});else if(e instanceof Object){var a=$s(e,t);Object.assign(this,a)}else if("string"==typeof e)if(ts.test(e)){var s=e.replace(Za,""),c=Ja.exec(s).slice(1,4).map((function(e){return parseInt(e)})),u=zs(c,3),l=u[0],f=u[1],h=u[2];Object.assign(this,{_a:l,_b:f,_c:h,_d:0,space:"rgb"})}else{if(!es.test(e))throw Error("Unsupported string format, can't construct Color");var p=function(e){return parseInt(e,16)},d=Xa.exec(Us(e)).map(p),v=zs(d,4),y=v[1],m=v[2],g=v[3];Object.assign(this,{_a:y,_b:m,_c:g,_d:0,space:"rgb"})}var b=this._a,_=this._b,w=this._c,S=this._d,C="rgb"===this.space?{r:b,g:_,b:w}:"xyz"===this.space?{x:b,y:_,z:w}:"hsl"===this.space?{h:b,s:_,l:w}:"lab"===this.space?{l:b,a:_,b:w}:"lch"===this.space?{l:b,c:_,h:w}:"cmyk"===this.space?{c:b,m:_,y:w,k:S}:{};Object.assign(this,C)}},{key:"rgb",value:function(){if("rgb"===this.space)return this;if(function(e){return"lab"===e||"xyz"===e||"lch"===e}(this.space)){var t=this.x,n=this.y,r=this.z;if("lab"===this.space||"lch"===this.space){var i=this.l,o=this.a,a=this.b;if("lch"===this.space){var s=this.c,c=this.h,u=Math.PI/180;o=s*Math.cos(u*c),a=s*Math.sin(u*c)}var l=(i+16)/116,f=o/500+l,h=l-a/200,p=16/116,d=.008856;t=.95047*(Math.pow(f,3)>d?Math.pow(f,3):(f-p)/7.787),n=1*(Math.pow(l,3)>d?Math.pow(l,3):(l-p)/7.787),r=1.08883*(Math.pow(h,3)>d?Math.pow(h,3):(h-p)/7.787)}var v=3.2406*t+-1.5372*n+-.4986*r,y=-.9689*t+1.8758*n+.0415*r,m=.0557*t+-.204*n+1.057*r,g=Math.pow,b=.0031308;return new e(255*(v>b?1.055*g(v,1/2.4)-.055:12.92*v),255*(y>b?1.055*g(y,1/2.4)-.055:12.92*y),255*(m>b?1.055*g(m,1/2.4)-.055:12.92*m))}if("hsl"===this.space){var _=this.h,w=this.s,S=this.l;if(_/=360,S/=100,0===(w/=100))return new e(S*=255,S,S);var C=S<.5?S*(1+w):S+w-S*w,k=2*S-C;return new e(255*Ys(k,C,_+1/3),255*Ys(k,C,_),255*Ys(k,C,_-1/3))}if("cmyk"===this.space){var x=this.c,T=this.m,P=this.y,E=this.k;return new e(255*(1-Math.min(1,x*(1-E)+E)),255*(1-Math.min(1,T*(1-E)+E)),255*(1-Math.min(1,P*(1-E)+E)))}return this}},{key:"lab",value:function(){var t=this.xyz(),n=t.x,r=t.y;return new e(116*r-16,500*(n-r),200*(r-t.z),"lab")}},{key:"xyz",value:function(){var t=this.rgb(),n=zs([t._a,t._b,t._c].map((function(e){return e/255})),3),r=n[0],i=n[1],o=n[2],a=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92,s=i>.04045?Math.pow((i+.055)/1.055,2.4):i/12.92,c=o>.04045?Math.pow((o+.055)/1.055,2.4):o/12.92,u=(.4124*a+.3576*s+.1805*c)/.95047,l=(.2126*a+.7152*s+.0722*c)/1,f=(.0193*a+.1192*s+.9505*c)/1.08883;return new e(u>.008856?Math.pow(u,1/3):7.787*u+16/116,l>.008856?Math.pow(l,1/3):7.787*l+16/116,f>.008856?Math.pow(f,1/3):7.787*f+16/116,"xyz")}},{key:"lch",value:function(){var t=this.lab(),n=t.l,r=t.a,i=t.b,o=Math.sqrt(Math.pow(r,2)+Math.pow(i,2)),a=180*Math.atan2(i,r)/Math.PI;return a<0&&(a=360-(a*=-1)),new e(n,o,a,"lch")}},{key:"hsl",value:function(){var t=this.rgb(),n=zs([t._a,t._b,t._c].map((function(e){return e/255})),3),r=n[0],i=n[1],o=n[2],a=Math.max(r,i,o),s=Math.min(r,i,o),c=(a+s)/2,u=a===s,l=a-s;return new e(360*(u?0:a===r?((i-o)/l+(i<o?6:0))/6:a===i?((o-r)/l+2)/6:a===o?((r-i)/l+4)/6:0),100*(u?0:c>.5?l/(2-a-s):l/(a+s)),100*c,"hsl")}},{key:"cmyk",value:function(){var t=this.rgb(),n=zs([t._a,t._b,t._c].map((function(e){return e/255})),3),r=n[0],i=n[1],o=n[2],a=Math.min(1-r,1-i,1-o);return 1===a?new e(0,0,0,1,"cmyk"):new e((1-r-a)/(1-a),(1-i-a)/(1-a),(1-o-a)/(1-a),a,"cmyk")}},{key:"_clamped",value:function(){var e=this.rgb(),t=e._a,n=e._b,r=e._c,i=Math.max,o=Math.min,a=Math.round;return[t,n,r].map((function(e){return i(0,o(a(e),255))}))}},{key:"toHex",value:function(){var e=zs(this._clamped().map(Hs),3),t=e[0],n=e[1],r=e[2];return"#".concat(t).concat(n).concat(r)}},{key:"toString",value:function(){return this.toHex()}},{key:"toRgb",value:function(){var e=zs(this._clamped(),3),t=e[0],n=e[1],r=e[2];return"rgb(".concat(t,",").concat(n,",").concat(r,")")}},{key:"toArray",value:function(){return[this._a,this._b,this._c,this._d,this.space]}}],[{key:"random",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"vibrant",n=arguments.length>1?arguments[1]:void 0,r=Math.random,i=Math.round,o=Math.sin,a=Math.PI;if("vibrant"===t){var s=24*r()+57,c=38*r()+45,u=360*r(),l=new e(s,c,u,"lch");return l}if("sine"===t){var f=i(80*o(2*a*(n=null==n?r():n)/.5+.01)+150),h=i(50*o(2*a*n/.5+4.6)+200),p=i(100*o(2*a*n/.5+2.3)+150),d=new e(f,h,p);return d}if("pastel"===t){var v=8*r()+86,y=17*r()+9,m=360*r(),g=new e(v,y,m,"lch");return g}if("dark"===t){var b=10+10*r(),_=50*r()+86,w=360*r(),S=new e(b,_,w,"lch");return S}if("rgb"===t){var C=255*r(),k=255*r(),x=255*r(),T=new e(C,k,x);return T}if("lab"===t){var P=100*r(),E=256*r()-128,O=256*r()-128,R=new e(P,E,O,"lab");return R}if("grey"===t){var M=255*r(),j=new e(M,M,M);return j}}},{key:"test",value:function(e){return"string"==typeof e&&(es.test(e)||ts.test(e))}},{key:"isRgb",value:function(e){return e&&"number"==typeof e.r&&"number"==typeof e.g&&"number"==typeof e.b}},{key:"isColor",value:function(t){return t&&(t instanceof e||this.isRgb(t)||this.test(t))}}]),e}(),Xs=ut((function(){ur(1)}));function Js(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Qs(e,t){return!t||"object"!==sr(t)&&"function"!=typeof t?Js(e):t}function Ks(e){return(Ks=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Zs(e,t,n){return(Zs="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Ks(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function ec(e,t){return(ec=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function tc(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ec(e,t)}Dn({target:"Object",stat:!0,forced:Xs},{keys:function(e){return ur(cr(e))}}),Yo("match",1,(function(e,t,n){return[function(t){var n=bt(this),r=null==t?void 0:t[e];return void 0!==r?r.call(t,n):new RegExp(t)[e](String(n))},function(e){var r=n(t,e,this);if(r.done)return r.value;var i=Mt(e),o=String(this);if(!i.global)return Jo(i,o);var a=i.unicode;i.lastIndex=0;for(var s,c=[],u=0;null!==(s=Jo(i,o));){var l=String(s[0]);c[u]=l,""===l&&(i.lastIndex=Xo(o,fn(i.lastIndex),a)),u++}return 0===u?null:c}]}));var nc=wn.f,rc=Rt.f,ic=Dt.f,oc=ca.trim,ac=ct.Number,sc=ac.prototype,cc="Number"==yt(vr(sc)),uc=function(e){var t,n,r,i,o,a,s,c,u=St(e,!1);if("string"==typeof u&&u.length>2)if(43===(t=(u=oc(u)).charCodeAt(0))||45===t){if(88===(n=u.charCodeAt(2))||120===n)return NaN}else if(48===t){switch(u.charCodeAt(1)){case 66:case 98:r=2,i=49;break;case 79:case 111:r=8,i=55;break;default:return+u}for(a=(o=u.slice(2)).length,s=0;s<a;s++)if((c=o.charCodeAt(s))<48||c>i)return NaN;return parseInt(o,r)}return+u};if(Mn("Number",!ac(" 0o1")||!ac("0b1")||ac("+0x1"))){for(var lc,fc=function(e){var t=arguments.length<1?0:e,n=this;return n instanceof fc&&(cc?ut((function(){sc.valueOf.call(n)})):"Number"!=yt(n))?ro(new ac(uc(t)),n,fc):uc(t)},hc=lt?nc(ac):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),pc=0;hc.length>pc;pc++)kt(ac,lc=hc[pc])&&!kt(fc,lc)&&ic(fc,lc,rc(ac,lc));fc.prototype=sc,sc.constructor=fc,nn(ct,"Number",fc)}var dc=ca.trim,vc=ct.parseFloat,yc=1/vc(ra+"-0")!=-1/0?function(e){var t=dc(String(e)),n=vc(t);return 0===n&&"-"==t.charAt(0)?-0:n}:vc;Dn({global:!0,forced:parseFloat!=yc},{parseFloat:yc});var mc=function(){function e(){wa(this,e),this.init.apply(this,arguments)}return qs(e,[{key:"init",value:function(e,t){var n=0,r=0,i=Array.isArray(e)?{x:e[0],y:e[1]}:"object"===sr(e)?{x:e.x,y:e.y}:{x:e,y:t};return this.x=null==i.x?n:i.x,this.y=null==i.y?r:i.y,this}},{key:"clone",value:function(){return new e(this)}},{key:"transform",value:function(e){return this.clone().transformO(e)}},{key:"transformO",value:function(e){bc.isMatrixLike(e)||(e=new bc(e));var t=this.x,n=this.y;return this.x=e.a*t+e.c*n+e.e,this.y=e.b*t+e.d*n+e.f,this}},{key:"toArray",value:function(){return[this.x,this.y]}}]),e}();function gc(e,t,n){return Math.abs(t-e)<(n||1e-6)}var bc=function(){function e(){wa(this,e),this.init.apply(this,arguments)}return qs(e,[{key:"init",value:function(t){var n=e.fromArray([1,0,0,1,0,0]);return t=t instanceof Lc?t.matrixify():"string"==typeof t?e.fromArray(t.split(os).map(parseFloat)):Array.isArray(t)?e.fromArray(t):"object"===sr(t)&&e.isMatrixLike(t)?t:"object"===sr(t)?(new e).transform(t):6===arguments.length?e.fromArray([].slice.call(arguments)):n,this.a=null!=t.a?t.a:n.a,this.b=null!=t.b?t.b:n.b,this.c=null!=t.c?t.c:n.c,this.d=null!=t.d?t.d:n.d,this.e=null!=t.e?t.e:n.e,this.f=null!=t.f?t.f:n.f,this}},{key:"clone",value:function(){return new e(this)}},{key:"transform",value:function(t){if(e.isMatrixLike(t))return new e(t).multiplyO(this);var n=e.formatTransforms(t),r=new mc(n.ox,n.oy).transform(this),i=r.x,o=r.y,a=(new e).translateO(n.rx,n.ry).lmultiplyO(this).translateO(-i,-o).scaleO(n.scaleX,n.scaleY).skewO(n.skewX,n.skewY).shearO(n.shear).rotateO(n.theta).translateO(i,o);if(isFinite(n.px)||isFinite(n.py)){var s=new mc(i,o).transform(a),c=n.px?n.px-s.x:0,u=n.py?n.py-s.y:0;a.translateO(c,u)}return a.translateO(n.tx,n.ty),a}},{key:"compose",value:function(t){t.origin&&(t.originX=t.origin[0],t.originY=t.origin[1]);var n=t.originX||0,r=t.originY||0,i=t.scaleX||1,o=t.scaleY||1,a=t.shear||0,s=t.rotate||0,c=t.translateX||0,u=t.translateY||0;return(new e).translateO(-n,-r).scaleO(i,o).shearO(a).rotateO(s).translateO(c,u).lmultiplyO(this).translateO(n,r)}},{key:"decompose",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.a,r=this.b,i=this.c,o=this.d,a=this.e,s=this.f,c=n*o-r*i,u=c>0?1:-1,l=u*Math.sqrt(n*n+r*r),f=Math.atan2(u*r,u*n),h=180/Math.PI*f,p=Math.cos(f),d=Math.sin(f),v=(n*i+r*o)/c,y=i*l/(v*n-r)||o*l/(v*r+n),m=a-e+e*p*l+t*(v*p*l-d*y),g=s-t+e*d*l+t*(v*d*l+p*y);return{scaleX:l,scaleY:y,shear:v,rotate:h,translateX:m,translateY:g,originX:e,originY:t,a:this.a,b:this.b,c:this.c,d:this.d,e:this.e,f:this.f}}},{key:"multiply",value:function(e){return this.clone().multiplyO(e)}},{key:"multiplyO",value:function(t){var n=t instanceof e?t:new e(t);return e.matrixMultiply(this,n,this)}},{key:"lmultiply",value:function(e){return this.clone().lmultiplyO(e)}},{key:"lmultiplyO",value:function(t){var n=t instanceof e?t:new e(t);return e.matrixMultiply(n,this,this)}},{key:"inverseO",value:function(){var e=this.a,t=this.b,n=this.c,r=this.d,i=this.e,o=this.f,a=e*r-t*n;if(!a)throw new Error("Cannot invert "+this);var s=r/a,c=-t/a,u=-n/a,l=e/a,f=-(s*i+u*o),h=-(c*i+l*o);return this.a=s,this.b=c,this.c=u,this.d=l,this.e=f,this.f=h,this}},{key:"inverse",value:function(){return this.clone().inverseO()}},{key:"translate",value:function(e,t){return this.clone().translateO(e,t)}},{key:"translateO",value:function(e,t){return this.e+=e||0,this.f+=t||0,this}},{key:"scale",value:function(e,t,n,r){var i;return(i=this.clone()).scaleO.apply(i,arguments)}},{key:"scaleO",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;3===arguments.length&&(r=n,n=t,t=e);var i=this.a,o=this.b,a=this.c,s=this.d,c=this.e,u=this.f;return this.a=i*e,this.b=o*t,this.c=a*e,this.d=s*t,this.e=c*e-n*e+n,this.f=u*t-r*t+r,this}},{key:"rotate",value:function(e,t,n){return this.clone().rotateO(e,t,n)}},{key:"rotateO",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;e=fa(e);var r=Math.cos(e),i=Math.sin(e),o=this.a,a=this.b,s=this.c,c=this.d,u=this.e,l=this.f;return this.a=o*r-a*i,this.b=a*r+o*i,this.c=s*r-c*i,this.d=c*r+s*i,this.e=u*r-l*i+n*i-t*r+t,this.f=l*r+u*i-t*i-n*r+n,this}},{key:"flip",value:function(e,t){return this.clone().flipO(e,t)}},{key:"flipO",value:function(e,t){return"x"===e?this.scaleO(-1,1,t,0):"y"===e?this.scaleO(1,-1,0,t):this.scaleO(-1,-1,e,t||e)}},{key:"shear",value:function(e,t,n){return this.clone().shearO(e,t,n)}},{key:"shearO",value:function(e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=this.a,r=this.b,i=this.c,o=this.d,a=this.e,s=this.f;return this.a=n+r*e,this.c=i+o*e,this.e=a+s*e-t*e,this}},{key:"skew",value:function(e,t,n,r){var i;return(i=this.clone()).skewO.apply(i,arguments)}},{key:"skewO",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;3===arguments.length&&(r=n,n=t,t=e),e=fa(e),t=fa(t);var i=Math.tan(e),o=Math.tan(t),a=this.a,s=this.b,c=this.c,u=this.d,l=this.e,f=this.f;return this.a=a+s*i,this.b=s+a*o,this.c=c+u*i,this.d=u+c*o,this.e=l+f*i-r*i,this.f=f+l*o-n*o,this}},{key:"skewX",value:function(e,t,n){return this.skew(e,0,t,n)}},{key:"skewXO",value:function(e,t,n){return this.skewO(e,0,t,n)}},{key:"skewY",value:function(e,t,n){return this.skew(0,e,t,n)}},{key:"skewYO",value:function(e,t,n){return this.skewO(0,e,t,n)}},{key:"aroundO",value:function(e,t,n){var r=e||0,i=t||0;return this.translateO(-r,-i).lmultiplyO(n).translateO(r,i)}},{key:"around",value:function(e,t,n){return this.clone().aroundO(e,t,n)}},{key:"equals",value:function(t){var n=new e(t);return gc(this.a,n.a)&&gc(this.b,n.b)&&gc(this.c,n.c)&&gc(this.d,n.d)&&gc(this.e,n.e)&&gc(this.f,n.f)}},{key:"toString",value:function(){return"matrix("+this.a+","+this.b+","+this.c+","+this.d+","+this.e+","+this.f+")"}},{key:"toArray",value:function(){return[this.a,this.b,this.c,this.d,this.e,this.f]}},{key:"valueOf",value:function(){return{a:this.a,b:this.b,c:this.c,d:this.d,e:this.e,f:this.f}}}],[{key:"fromArray",value:function(e){return{a:e[0],b:e[1],c:e[2],d:e[3],e:e[4],f:e[5]}}},{key:"isMatrixLike",value:function(e){return null!=e.a||null!=e.b||null!=e.c||null!=e.d||null!=e.e||null!=e.f}},{key:"formatTransforms",value:function(e){var t="both"===e.flip||!0===e.flip,n=e.flip&&(t||"x"===e.flip)?-1:1,r=e.flip&&(t||"y"===e.flip)?-1:1,i=e.skew&&e.skew.length?e.skew[0]:isFinite(e.skew)?e.skew:isFinite(e.skewX)?e.skewX:0,o=e.skew&&e.skew.length?e.skew[1]:isFinite(e.skew)?e.skew:isFinite(e.skewY)?e.skewY:0,a=e.scale&&e.scale.length?e.scale[0]*n:isFinite(e.scale)?e.scale*n:isFinite(e.scaleX)?e.scaleX*n:n,s=e.scale&&e.scale.length?e.scale[1]*r:isFinite(e.scale)?e.scale*r:isFinite(e.scaleY)?e.scaleY*r:r,c=e.shear||0,u=e.rotate||e.theta||0,l=new mc(e.origin||e.around||e.ox||e.originX,e.oy||e.originY),f=l.x,h=l.y,p=new mc(e.position||e.px||e.positionX,e.py||e.positionY),d=p.x,v=p.y,y=new mc(e.translate||e.tx||e.translateX,e.ty||e.translateY),m=y.x,g=y.y,b=new mc(e.relative||e.rx||e.relativeX,e.ry||e.relativeY);return{scaleX:a,scaleY:s,skewX:i,skewY:o,shear:c,theta:u,rx:b.x,ry:b.y,tx:m,ty:g,ox:f,oy:h,px:d,py:v}}},{key:"matrixMultiply",value:function(e,t,n){var r=e.a*t.a+e.c*t.b,i=e.b*t.a+e.d*t.b,o=e.a*t.c+e.c*t.d,a=e.b*t.c+e.d*t.d,s=e.e+e.a*t.e+e.c*t.f,c=e.f+e.b*t.e+e.d*t.f;return n.a=r,n.b=i,n.c=o,n.d=a,n.e=s,n.f=c,n}}]),e}();function _c(){if(!_c.nodes){var e=Ta().size(2,0);e.node.style.cssText=["opacity: 0","position: absolute","left: -100%","top: -100%","overflow: hidden"].join(";"),e.attr("focusable","false"),e.attr("aria-hidden","true");var t=e.path().node;_c.nodes={svg:e,path:t}}if(!_c.nodes.svg.node.parentNode){var n=_a.document.body||_a.document.documentElement;_c.nodes.svg.addTo(n)}return _c.nodes}function wc(e){return!(e.width||e.height||e.x||e.y)}Ra(bc,"Matrix");var Sc=function(){function e(){wa(this,e),this.init.apply(this,arguments)}return qs(e,[{key:"init",value:function(e){var t=[0,0,0,0];return e="string"==typeof e?e.split(os).map(parseFloat):Array.isArray(e)?e:"object"===sr(e)?[null!=e.left?e.left:e.x,null!=e.top?e.top:e.y,e.width,e.height]:4===arguments.length?[].slice.call(arguments):t,this.x=e[0]||0,this.y=e[1]||0,this.width=this.w=e[2]||0,this.height=this.h=e[3]||0,this.x2=this.x+this.w,this.y2=this.y+this.h,this.cx=this.x+this.w/2,this.cy=this.y+this.h/2,this}},{key:"merge",value:function(t){var n=Math.min(this.x,t.x),r=Math.min(this.y,t.y);return new e(n,r,Math.max(this.x+this.width,t.x+t.width)-n,Math.max(this.y+this.height,t.y+t.height)-r)}},{key:"transform",value:function(t){t instanceof bc||(t=new bc(t));var n=1/0,r=-1/0,i=1/0,o=-1/0;return[new mc(this.x,this.y),new mc(this.x2,this.y),new mc(this.x,this.y2),new mc(this.x2,this.y2)].forEach((function(e){e=e.transform(t),n=Math.min(n,e.x),r=Math.max(r,e.x),i=Math.min(i,e.y),o=Math.max(o,e.y)})),new e(n,i,r-n,o-i)}},{key:"addOffset",value:function(){return this.x+=_a.window.pageXOffset,this.y+=_a.window.pageYOffset,this}},{key:"toString",value:function(){return this.x+" "+this.y+" "+this.width+" "+this.height}},{key:"toArray",value:function(){return[this.x,this.y,this.width,this.height]}},{key:"isNulled",value:function(){return wc(this)}}]),e}();function Cc(e,t){var n,r;try{if(wc(n=e(this.node))&&((r=this.node)!==_a.document&&!(_a.document.documentElement.contains||function(e){for(;e.parentNode;)e=e.parentNode;return e===_a.document}).call(_a.document.documentElement,r)))throw new Error("Element not in the dom")}catch(e){n=t(this)}return n}Po({viewbox:{viewbox:function(e,t,n,r){return null==e?new Sc(this.attr("viewBox")):this.attr("viewBox",new Sc(e,t,n,r))},zoom:function(e,t){var n=this.node.clientWidth,r=this.node.clientHeight,i=this.viewbox();if(!n&&!r){var o=window.getComputedStyle(this.node);n=parseFloat(o.getPropertyValue("width")),r=parseFloat(o.getPropertyValue("height"))}var a=n/i.width,s=r/i.height,c=Math.min(a,s);if(null==e)return c;var u=c/e;u===1/0&&(u=Number.MIN_VALUE),t=t||new mc(n/2/a+i.x,r/2/s+i.y);var l=new Sc(i).transform(new bc({scale:u,origin:t}));return this.viewbox(l)}}}),Ra(Sc,"Box");var kc=function(){try{return Function("name","baseClass","_constructor",["baseClass = baseClass || Array","return {","  [name]: class extends baseClass {","    constructor (...args) {","      super(...args)","      _constructor && _constructor.apply(this, args)","    }","  }","}[name]"].join("\n"))}catch(e){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Array,n=arguments.length>2?arguments[2]:void 0,r=function(){t.apply(this,arguments),n&&n.apply(this,arguments)};return r.prototype=Object.create(t.prototype),r.prototype.constructor=r,r.prototype.map=function(e){var t=new r;return t.push.apply(t,Array.prototype.map.call(this,e)),t},r}}}(),xc=kc("List",Array,(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if("number"==typeof e)return this;this.length=0,this.push.apply(this,ko(e))}));Da(xc,{each:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return"function"==typeof e?this.map((function(t){return e.call(t,t)})):this.map((function(t){return t[e].apply(t,n)}))},toArray:function(){return Array.prototype.concat.apply([],this)}});var Tc=["toArray","constructor","each"];function Pc(e,t){return new xc(la((t||_a.document).querySelectorAll(e),(function(e){return Ea(e)})))}xc.extend=function(e){e=e.reduce((function(e,t){return Tc.includes(t)?e:"_"===t[0]?e:(e[t]=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.each.apply(this,[t].concat(n))},e)}),{}),Da(xc,e)};var Ec=function(e){function t(){var e,n=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).events,r=void 0===n?{}:n;return wa(this,t),(e=Qs(this,Ks(t).call(this))).events=r,e}return tc(t,e),qs(t,[{key:"addEventListener",value:function(){}},{key:"dispatch",value:function(e,t){return function(e,t,n){var r=ws(e);return t instanceof _a.window.Event?r.dispatchEvent(t):(t=new _a.window.CustomEvent(t,{detail:n,cancelable:!0}),r.dispatchEvent(t)),t}(this,e,t)}},{key:"dispatchEvent",value:function(e){var t=this.getEventHolder().events;if(!t)return!0;var n=t[e.type];for(var r in n)for(var i in n[r])n[r][i](e);return!e.defaultPrevented}},{key:"fire",value:function(e,t){return this.dispatch(e,t),this}},{key:"getEventHolder",value:function(){return this}},{key:"getEventTarget",value:function(){return this}},{key:"off",value:function(e,t){return Cs(this,e,t),this}},{key:"on",value:function(e,t,n,r){return Ss(this,e,t,n,r),this}},{key:"removeEventListener",value:function(){}}]),t}(Sa);function Oc(){}Ra(Ec,"EventTarget");var Rc={duration:400,ease:">",delay:0},Mc={"fill-opacity":1,"stroke-opacity":1,"stroke-width":0,"stroke-linejoin":"miter","stroke-linecap":"butt",fill:"#000000",stroke:"#000000",opacity:1,x:0,y:0,cx:0,cy:0,width:0,height:0,r:0,rx:0,ry:0,offset:0,"stop-opacity":1,"stop-color":"#000000","text-anchor":"start"},jc=kc("SVGArray",Array,(function(e){this.init(e)}));Da(jc,{init:function(e){return"number"==typeof e?this:(this.length=0,this.push.apply(this,ko(this.parse(e))),this)},toArray:function(){return Array.prototype.concat.apply([],this)},toString:function(){return this.join(" ")},valueOf:function(){var e=[];return e.push.apply(e,ko(this)),e},parse:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e instanceof Array?e:e.trim().split(os).map(parseFloat)},clone:function(){return new this.constructor(this)},toSet:function(){return new Set(this)}});var Dc=function(){function e(){wa(this,e),this.init.apply(this,arguments)}return qs(e,[{key:"init",value:function(t,n){return n=Array.isArray(t)?t[1]:n,t=Array.isArray(t)?t[0]:t,this.value=0,this.unit=n||"","number"==typeof t?this.value=isNaN(t)?0:isFinite(t)?t:t<0?-34e37:34e37:"string"==typeof t?(n=t.match(Wa))&&(this.value=parseFloat(n[1]),"%"===n[5]?this.value/=100:"s"===n[5]&&(this.value*=1e3),this.unit=n[5]):t instanceof e&&(this.value=t.valueOf(),this.unit=t.unit),this}},{key:"toString",value:function(){return("%"===this.unit?~~(1e8*this.value)/1e6:"s"===this.unit?this.value/1e3:this.value)+this.unit}},{key:"toJSON",value:function(){return this.toString()}},{key:"toArray",value:function(){return[this.value,this.unit]}},{key:"valueOf",value:function(){return this.value}},{key:"plus",value:function(t){return t=new e(t),new e(this+t,this.unit||t.unit)}},{key:"minus",value:function(t){return t=new e(t),new e(this-t,this.unit||t.unit)}},{key:"times",value:function(t){return t=new e(t),new e(this*t,this.unit||t.unit)}},{key:"divide",value:function(t){return t=new e(t),new e(this/t,this.unit||t.unit)}},{key:"convert",value:function(t){return new e(this.value,t)}}]),e}(),Ic=[];var Ac=function(e){function t(e,n){var r;return wa(this,t),(r=Qs(this,Ks(t).call(this,e))).node=e,r.type=e.nodeName,n&&e!==n&&r.attr(n),r}return tc(t,e),qs(t,[{key:"add",value:function(e,t){return e=Ta(e),null==t?this.node.appendChild(e.node):e.node!==this.node.childNodes[t]&&this.node.insertBefore(e.node,this.node.childNodes[t]),this}},{key:"addTo",value:function(e){return Ta(e).put(this)}},{key:"children",value:function(){return new xc(la(this.node.children,(function(e){return Ea(e)})))}},{key:"clear",value:function(){for(;this.node.hasChildNodes();)this.node.removeChild(this.node.lastChild);return this}},{key:"clone",value:function(){return this.writeDataToDom(),function e(t){for(var n=t.children.length-1;n>=0;n--)e(t.children[n]);return t.id?Ea(t).id(ja(t.nodeName)):Ea(t)}(this.node.cloneNode(!0))}},{key:"each",value:function(e,t){var n,r,i=this.children();for(n=0,r=i.length;n<r;n++)e.apply(i[n],[n,i]),t&&i[n].each(e,t);return this}},{key:"element",value:function(e){return this.put(new t(xa(e)))}},{key:"first",value:function(){return Ea(this.node.firstChild)}},{key:"get",value:function(e){return Ea(this.node.childNodes[e])}},{key:"getEventHolder",value:function(){return this.node}},{key:"getEventTarget",value:function(){return this.node}},{key:"has",value:function(e){return this.index(e)>=0}},{key:"id",value:function(e){return void 0!==e||this.node.id||(this.node.id=ja(this.type)),this.attr("id",e)}},{key:"index",value:function(e){return[].slice.call(this.node.childNodes).indexOf(e.node)}},{key:"last",value:function(){return Ea(this.node.lastChild)}},{key:"matches",value:function(e){var t=this.node;return(t.matches||t.matchesSelector||t.msMatchesSelector||t.mozMatchesSelector||t.webkitMatchesSelector||t.oMatchesSelector).call(t,e)}},{key:"parent",value:function(e){var t=this;if(!t.node.parentNode)return null;if(t=Ea(t.node.parentNode),!e)return t;for(;t;){if("string"==typeof e?t.matches(e):t instanceof e)return t;if(!t.node.parentNode||"#document"===t.node.parentNode.nodeName||"#document-fragment"===t.node.parentNode.nodeName)return null;t=Ea(t.node.parentNode)}}},{key:"put",value:function(e,t){return this.add(e,t),e}},{key:"putIn",value:function(e){return Ta(e).add(this)}},{key:"remove",value:function(){return this.parent()&&this.parent().removeElement(this),this}},{key:"removeElement",value:function(e){return this.node.removeChild(e.node),this}},{key:"replace",value:function(e){return e=Ta(e),this.node.parentNode.replaceChild(e.node,this.node),e}},{key:"round",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2,t=arguments.length>1?arguments[1]:void 0,n=Math.pow(10,e),r=this.attr();t||(t=Object.keys(r));var i={};return t.forEach((function(e){i[e]=Math.round(r[e]*n)/n})),this.attr(i),this}},{key:"toString",value:function(){return this.id()}},{key:"svg",value:function(e,t){var n,r,i;if(!1===e&&(t=!1,e=null),null==e||"function"==typeof e){t=null==t||t,this.writeDataToDom();var o=this;if(null!=e){if(o=Ea(o.node.cloneNode(!0)),t){var a=e(o);if(o=a||o,!1===a)return""}o.each((function(){var t=e(this),n=t||this;!1===t?this.remove():t&&this!==n&&this.replace(n)}),!0)}return t?o.node.outerHTML:o.node.innerHTML}for(t=null!=t&&t,n=_a.document.createElementNS(ma,"svg"),i=_a.document.createDocumentFragment(),n.innerHTML=e,r=n.children.length;r--;)i.appendChild(n.firstElementChild);var s=this.parent();return t?this.replace(i)&&s:this.add(i)}},{key:"words",value:function(e){return this.node.textContent=e,this}},{key:"writeDataToDom",value:function(){return this.each((function(){this.writeDataToDom()})),this}}]),t}(Ec);Da(Ac,{attr:function(e,t,n){var r=this;if(null==e){e={},t=this.node.attributes;var i=!0,o=!1,a=void 0;try{for(var s,c=t[Symbol.iterator]();!(i=(s=c.next()).done);i=!0){var u=s.value;e[u.nodeName]=rs.test(u.nodeValue)?parseFloat(u.nodeValue):u.nodeValue}}catch(e){o=!0,a=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw a}}return e}if(e instanceof Array)return e.reduce((function(e,t){return e[t]=r.attr(t),e}),{});if("object"===sr(e)&&e.constructor===Object)for(t in e)this.attr(t,e[t]);else if(null===t)this.node.removeAttribute(e);else{if(null==t)return null==(t=this.node.getAttribute(e))?Mc[e]:rs.test(t)?parseFloat(t):t;"number"==typeof(t=Ic.reduce((function(t,n){return n(e,t,r)}),t))?t=new Dc(t):Ws.isColor(t)?t=new Ws(t):t.constructor===Array&&(t=new jc(t)),"leading"===e?this.leading&&this.leading(t):"string"==typeof n?this.node.setAttributeNS(n,e,t.toString()):this.node.setAttribute(e,t.toString()),!this.rebuild||"font-size"!==e&&"x"!==e||this.rebuild()}return this},find:function(e){return Pc(e,this.node)},findOne:function(e){return Ea(this.node.querySelector(e))}}),Ra(Ac,"Dom");var Lc=function(e){function t(e,n){var r;return wa(this,t),(r=Qs(this,Ks(t).call(this,e,n))).dom={},r.node.instance=Js(r),e.hasAttribute("svgjs:data")&&r.setData(JSON.parse(e.getAttribute("svgjs:data"))||{}),r}return tc(t,e),qs(t,[{key:"center",value:function(e,t){return this.cx(e).cy(t)}},{key:"cx",value:function(e){return null==e?this.x()+this.width()/2:this.x(e-this.width()/2)}},{key:"cy",value:function(e){return null==e?this.y()+this.height()/2:this.y(e-this.height()/2)}},{key:"defs",value:function(){return this.root().defs()}},{key:"dmove",value:function(e,t){return this.dx(e).dy(t)}},{key:"dx",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.x(new Dc(e).plus(this.x()))}},{key:"dy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.y(new Dc(e).plus(this.y()))}},{key:"root",value:function(){var e=this.parent(Ca[ka]);return e&&e.root()}},{key:"getEventHolder",value:function(){return this}},{key:"height",value:function(e){return this.attr("height",e)}},{key:"inside",value:function(e,t){var n=this.bbox();return e>n.x&&t>n.y&&e<n.x+n.width&&t<n.y+n.height}},{key:"move",value:function(e,t){return this.x(e).y(t)}},{key:"parents",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_a.document;e=Ta(e);for(var t=new xc,n=this;(n=n.parent())&&n.node!==e.node&&n.node!==_a.document;)t.push(n);return t}},{key:"reference",value:function(e){if(!(e=this.attr(e)))return null;var t=e.match(Qa);return t?Ta(t[1]):null}},{key:"setData",value:function(e){return this.dom=e,this}},{key:"size",value:function(e,t){var n=va(this,e,t);return this.width(new Dc(n.width)).height(new Dc(n.height))}},{key:"width",value:function(e){return this.attr("width",e)}},{key:"writeDataToDom",value:function(){return this.node.removeAttribute("svgjs:data"),Object.keys(this.dom).length&&this.node.setAttribute("svgjs:data",JSON.stringify(this.dom)),Zs(Ks(t.prototype),"writeDataToDom",this).call(this)}},{key:"x",value:function(e){return this.attr("x",e)}},{key:"y",value:function(e){return this.attr("y",e)}}]),t}(Ac);Da(Lc,{bbox:function(){return new Sc(Cc.call(this,(function(e){return e.getBBox()}),(function(e){try{var t=e.clone().addTo(_c().svg).show(),n=t.node.getBBox();return t.remove(),n}catch(t){throw new Error('Getting bbox of element "'+e.node.nodeName+'" is not possible. '+t.toString())}})))},rbox:function(e){var t=new Sc(Cc.call(this,(function(e){return e.getBoundingClientRect()}),(function(e){throw new Error('Getting rbox of element "'+e.node.nodeName+'" is not possible')})));return e?t.transform(e.screenCTM().inverse()):t.addOffset()},point:function(e,t){return new mc(e,t).transform(this.screenCTM().inverse())},ctm:function(){return new bc(this.node.getCTM())},screenCTM:function(){if("function"==typeof this.isRoot&&!this.isRoot()){var e=this.rect(1,1),t=e.node.getScreenCTM();return e.remove(),new bc(t)}return new bc(this.node.getScreenCTM())}}),Ra(Lc,"Element");var Nc={stroke:["color","width","opacity","linecap","linejoin","miterlimit","dasharray","dashoffset"],fill:["color","opacity","rule"],prefix:function(e,t){return"color"===t?e:e+"-"+t}};["fill","stroke"].forEach((function(e){var t,n={};n[e]=function(n){if(void 0===n)return this.attr(e);if("string"==typeof n||n instanceof Ws||Ws.isRgb(n)||n instanceof Lc)this.attr(e,n);else for(t=Nc[e].length-1;t>=0;t--)null!=n[Nc[e][t]]&&this.attr(Nc.prefix(e,Nc[e][t]),n[Nc[e][t]]);return this},Po(["Element","Runner"],n)})),Po(["Element","Runner"],{matrix:function(e,t,n,r,i,o){return null==e?new bc(this):this.attr("transform",new bc(e,t,n,r,i,o))},rotate:function(e,t,n){return this.transform({rotate:e,ox:t,oy:n},!0)},skew:function(e,t,n,r){return 1===arguments.length||3===arguments.length?this.transform({skew:e,ox:t,oy:n},!0):this.transform({skew:[e,t],ox:n,oy:r},!0)},shear:function(e,t,n){return this.transform({shear:e,ox:t,oy:n},!0)},scale:function(e,t,n,r){return 1===arguments.length||3===arguments.length?this.transform({scale:e,ox:t,oy:n},!0):this.transform({scale:[e,t],ox:n,oy:r},!0)},translate:function(e,t){return this.transform({translate:[e,t]},!0)},relative:function(e,t){return this.transform({relative:[e,t]},!0)},flip:function(e,t){var n="string"==typeof e?e:(isFinite(e),"both"),r="both"===e&&isFinite(t)?[t,t]:"x"===e?[t,0]:"y"===e?[0,t]:isFinite(e)?[e,e]:[0,0];return this.transform({flip:n,origin:r},!0)},opacity:function(e){return this.attr("opacity",e)}}),Po("radius",{radius:function(e,t){var n=(this._element||this).type;return"radialGradient"===n||"radialGradient"===n?this.attr("r",new Dc(e)):this.rx(e).ry(null==t?e:t)}}),Po("Path",{length:function(){return this.node.getTotalLength()},pointAt:function(e){return new mc(this.node.getPointAtLength(e))}}),Po(["Element","Runner"],{font:function(e,t){if("object"===sr(e)){for(t in e)this.font(t,e[t]);return this}return"leading"===e?this.leading(t):"anchor"===e?this.attr("text-anchor",t):"size"===e||"family"===e||"weight"===e||"stretch"===e||"variant"===e||"style"===e?this.attr("font-"+e,t):this.attr(e,t)}}),Po("Text",{ax:function(e){return this.attr("x",e)},ay:function(e){return this.attr("y",e)},amove:function(e,t){return this.ax(e).ay(t)}}),Po("Element",["click","dblclick","mousedown","mouseup","mouseover","mouseout","mousemove","mouseenter","mouseleave","touchstart","touchmove","touchleave","touchend","touchcancel"].reduce((function(e,t){return e[t]=function(e){return null===e?Cs(this,t):Ss(this,t,e),this},e}),{}));var Bc=[].reverse,Fc=[1,2];Dn({target:"Array",proto:!0,forced:String(Fc)===String(Fc.reverse())},{reverse:function(){return In(this)&&(this.length=this.length),Bc.call(this)}}),Dn({target:"Object",stat:!0,forced:!lt,sham:!lt},{defineProperties:lr}),Dn({target:"Object",stat:!0,forced:!lt,sham:!lt},{defineProperty:Dt.f});var zc=Rt.f,Gc=ut((function(){zc(1)}));function qc(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Uc(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Hc(e){return this.attr("rx",e)}function Vc(e){return this.attr("ry",e)}function $c(e){return null==e?this.cx()-this.rx():this.cx(e+this.rx())}function Yc(e){return null==e?this.cy()-this.ry():this.cy(e+this.ry())}function Wc(e){return null==e?this.attr("cx"):this.attr("cx",e)}function Xc(e){return null==e?this.attr("cy"):this.attr("cy",e)}function Jc(e){return null==e?2*this.rx():this.rx(new Dc(e).divide(2))}function Qc(e){return null==e?2*this.ry():this.ry(new Dc(e).divide(2))}Dn({target:"Object",stat:!0,forced:!lt||Gc,sham:!lt},{getOwnPropertyDescriptor:function(e,t){return zc(_t(e),t)}}),Dn({target:"Object",stat:!0,sham:!lt},{getOwnPropertyDescriptors:function(e){for(var t,n,r=_t(e),i=Rt.f,o=Cn(r),a={},s=0;o.length>s;)void 0!==(n=i(r,t=o[s++]))&&An(a,t,n);return a}}),Po("Element",{untransform:function(){return this.attr("transform",null)},matrixify:function(){return(this.attr("transform")||"").split(Ka).slice(0,-1).map((function(e){var t=e.trim().split("(");return[t[0],t[1].split(os).map((function(e){return parseFloat(e)}))]})).reverse().reduce((function(e,t){return"matrix"===t[0]?e.lmultiply(bc.fromArray(t[1])):e[t[0]].apply(e,t[1])}),new bc)},toParent:function(e){if(this===e)return this;var t=this.screenCTM(),n=e.screenCTM().inverse();return this.addTo(e).untransform().transform(n.multiply(t)),this},toRoot:function(){return this.toParent(this.root())},transform:function(e,t){if(null==e||"string"==typeof e){var n=new bc(this).decompose();return null==e?n:n[e]}bc.isMatrixLike(e)||(e=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Uc(n,!0).forEach((function(t){qc(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Uc(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e,{origin:ya(e,this)}));var r=new bc(!0===t?this:t||!1).transform(e);return this.attr("transform",r)}});var Kc={__proto__:null,rx:Hc,ry:Vc,x:$c,y:Yc,cx:Wc,cy:Xc,width:Jc,height:Qc},Zc=function(e){function t(){return wa(this,t),Qs(this,Ks(t).apply(this,arguments))}return tc(t,e),t}(Lc);Ra(Zc,"Shape");var eu=function(e){function t(e){return wa(this,t),Qs(this,Ks(t).call(this,Pa("circle",e),e))}return tc(t,e),qs(t,[{key:"radius",value:function(e){return this.attr("r",e)}},{key:"rx",value:function(e){return this.attr("r",e)}},{key:"ry",value:function(e){return this.rx(e)}},{key:"size",value:function(e){return this.radius(new Dc(e).divide(2))}}]),t}(Zc);Da(eu,{x:$c,y:Yc,cx:Wc,cy:Xc,width:Jc,height:Qc}),Po({Container:{circle:Ia((function(e){return this.put(new eu).size(e).move(0,0)}))}}),Ra(eu,"Circle");var tu=function(e){function t(){return wa(this,t),Qs(this,Ks(t).apply(this,arguments))}return tc(t,e),qs(t,[{key:"flatten",value:function(e){return this.each((function(){return this instanceof t?this.flatten(e).ungroup(e):this.toParent(e)})),this.node.firstElementChild||this.remove(),this}},{key:"ungroup",value:function(e){return e=e||this.parent(),this.each((function(){return this.toParent(e)})),this.remove(),this}}]),t}(Lc);Ra(tu,"Container");var nu=function(e){function t(e){return wa(this,t),Qs(this,Ks(t).call(this,Pa("defs",e),e))}return tc(t,e),qs(t,[{key:"flatten",value:function(){return this}},{key:"ungroup",value:function(){return this}}]),t}(tu);Ra(nu,"Defs");var ru=function(e){function t(e){return wa(this,t),Qs(this,Ks(t).call(this,Pa("ellipse",e),e))}return tc(t,e),qs(t,[{key:"size",value:function(e,t){var n=va(this,e,t);return this.rx(new Dc(n.width).divide(2)).ry(new Dc(n.height).divide(2))}}]),t}(Zc);Da(ru,Kc),Po("Container",{ellipse:Ia((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return this.put(new ru).size(e,t).move(0,0)}))}),Ra(ru,"Ellipse");var iu=function(e){function t(e){return wa(this,t),Qs(this,Ks(t).call(this,Pa("stop",e),e))}return tc(t,e),qs(t,[{key:"update",value:function(e){return("number"==typeof e||e instanceof Dc)&&(e={offset:arguments[0],color:arguments[1],opacity:arguments[2]}),null!=e.opacity&&this.attr("stop-opacity",e.opacity),null!=e.color&&this.attr("stop-color",e.color),null!=e.offset&&this.attr("offset",new Dc(e.offset)),this}}]),t}(Lc);function ou(e,t){return"radialGradient"===(this._element||this).type?this.attr({fx:new Dc(e),fy:new Dc(t)}):this.attr({x1:new Dc(e),y1:new Dc(t)})}function au(e,t){return"radialGradient"===(this._element||this).type?this.attr({cx:new Dc(e),cy:new Dc(t)}):this.attr({x2:new Dc(e),y2:new Dc(t)})}Ra(iu,"Stop");var su={__proto__:null,from:ou,to:au},cu=function(e){function t(e,n){return wa(this,t),Qs(this,Ks(t).call(this,Pa(e+"Gradient","string"==typeof e?null:e),n))}return tc(t,e),qs(t,[{key:"stop",value:function(e,t,n){return this.put(new iu).update(e,t,n)}},{key:"update",value:function(e){return this.clear(),"function"==typeof e&&e.call(this,this),this}},{key:"url",value:function(){return"url(#"+this.id()+")"}},{key:"toString",value:function(){return this.url()}},{key:"attr",value:function(e,n,r){return"transform"===e&&(e="gradientTransform"),Zs(Ks(t.prototype),"attr",this).call(this,e,n,r)}},{key:"targets",value:function(){return Pc('svg [fill*="'+this.id()+'"]')}},{key:"bbox",value:function(){return new Sc}}]),t}(tu);Da(cu,su),Po({Container:{gradient:Ia((function(e,t){return this.defs().gradient(e,t)}))},Defs:{gradient:Ia((function(e,t){return this.put(new cu(e)).update(t)}))}}),Ra(cu,"Gradient");var uu=function(e){function t(e){return wa(this,t),Qs(this,Ks(t).call(this,Pa("pattern",e),e))}return tc(t,e),qs(t,[{key:"url",value:function(){return"url(#"+this.id()+")"}},{key:"update",value:function(e){return this.clear(),"function"==typeof e&&e.call(this,this),this}},{key:"toString",value:function(){return this.url()}},{key:"attr",value:function(e,n,r){return"transform"===e&&(e="patternTransform"),Zs(Ks(t.prototype),"attr",this).call(this,e,n,r)}},{key:"targets",value:function(){return Pc('svg [fill*="'+this.id()+'"]')}},{key:"bbox",value:function(){return new Sc}}]),t}(tu);Po({Container:{pattern:function(){var e;return(e=this.defs()).pattern.apply(e,arguments)}},Defs:{pattern:Ia((function(e,t,n){return this.put(new uu).update(n).attr({x:0,y:0,width:e,height:t,patternUnits:"userSpaceOnUse"})}))}}),Ra(uu,"Pattern");var lu,fu=function(e){function t(e){return wa(this,t),Qs(this,Ks(t).call(this,Pa("image",e),e))}return tc(t,e),qs(t,[{key:"load",value:function(e,t){if(!e)return this;var n=new _a.window.Image;return Ss(n,"load",(function(e){var r=this.parent(uu);0===this.width()&&0===this.height()&&this.size(n.width,n.height),r instanceof uu&&0===r.width()&&0===r.height()&&r.size(this.width(),this.height()),"function"==typeof t&&t.call(this,e)}),this),Ss(n,"load error",(function(){Cs(n)})),this.attr("href",n.src=e,ba)}}]),t}(Zc);lu=function(e,t,n){return"fill"!==e&&"stroke"!==e||is.test(t)&&(t=n.root().defs().image(t)),t instanceof fu&&(t=n.root().defs().pattern(0,0,(function(e){e.add(t)}))),t},Ic.push(lu),Po({Container:{image:Ia((function(e,t){return this.put(new fu).size(0,0).load(e,t)}))}}),Ra(fu,"Image");var hu=kc("PointArray",jc);Da(hu,{toString:function(){for(var e=0,t=this.length,n=[];e<t;e++)n.push(this[e].join(","));return n.join(" ")},toLine:function(){return{x1:this[0][0],y1:this[0][1],x2:this[1][0],y2:this[1][1]}},at:function(e){if(!this.destination)return this;for(var t=0,n=this.length,r=[];t<n;t++)r.push([this[t][0]+(this.destination[t][0]-this[t][0])*e,this[t][1]+(this.destination[t][1]-this[t][1])*e]);return new hu(r)},parse:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[0,0]],t=[];if(e instanceof Array){if(e[0]instanceof Array)return e}else e=e.trim().split(os).map(parseFloat);e.length%2!=0&&e.pop();for(var n=0,r=e.length;n<r;n+=2)t.push([e[n],e[n+1]]);return t},transform:function(e){for(var t=[],n=0;n<this.length;n++){var r=this[n];t.push([e.a*r[0]+e.c*r[1]+e.e,e.b*r[0]+e.d*r[1]+e.f])}return new hu(t)},move:function(e,t){var n=this.bbox();if(e-=n.x,t-=n.y,!isNaN(e)&&!isNaN(t))for(var r=this.length-1;r>=0;r--)this[r]=[this[r][0]+e,this[r][1]+t];return this},size:function(e,t){var n,r=this.bbox();for(n=this.length-1;n>=0;n--)r.width&&(this[n][0]=(this[n][0]-r.x)*e/r.width+r.x),r.height&&(this[n][1]=(this[n][1]-r.y)*t/r.height+r.y);return this},bbox:function(){var e=-1/0,t=-1/0,n=1/0,r=1/0;return this.forEach((function(i){e=Math.max(i[0],e),t=Math.max(i[1],t),n=Math.min(i[0],n),r=Math.min(i[1],r)})),{x:n,y:r,width:e-n,height:t-r}}});var pu={__proto__:null,MorphArray:hu,x:function(e){return null==e?this.bbox().x:this.move(e,this.bbox().y)},y:function(e){return null==e?this.bbox().y:this.move(this.bbox().x,e)},width:function(e){var t=this.bbox();return null==e?t.width:this.size(e,t.height)},height:function(e){var t=this.bbox();return null==e?t.height:this.size(t.width,e)}},du=function(e){function t(e){return wa(this,t),Qs(this,Ks(t).call(this,Pa("line",e),e))}return tc(t,e),qs(t,[{key:"array",value:function(){return new hu([[this.attr("x1"),this.attr("y1")],[this.attr("x2"),this.attr("y2")]])}},{key:"plot",value:function(e,t,n,r){return null==e?this.array():(e=void 0!==t?{x1:e,y1:t,x2:n,y2:r}:new hu(e).toLine(),this.attr(e))}},{key:"move",value:function(e,t){return this.attr(this.array().move(e,t).toLine())}},{key:"size",value:function(e,t){var n=va(this,e,t);return this.attr(this.array().size(n.width,n.height).toLine())}}]),t}(Zc);Da(du,pu),Po({Container:{line:Ia((function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return du.prototype.plot.apply(this.put(new du),null!=t[0]?t:[0,0,0,0])}))}}),Ra(du,"Line");var vu=function(e){function t(e){return wa(this,t),Qs(this,Ks(t).call(this,Pa("marker",e),e))}return tc(t,e),qs(t,[{key:"width",value:function(e){return this.attr("markerWidth",e)}},{key:"height",value:function(e){return this.attr("markerHeight",e)}},{key:"ref",value:function(e,t){return this.attr("refX",e).attr("refY",t)}},{key:"update",value:function(e){return this.clear(),"function"==typeof e&&e.call(this,this),this}},{key:"toString",value:function(){return"url(#"+this.id()+")"}}]),t}(tu);Po({Container:{marker:function(){var e;return(e=this.defs()).marker.apply(e,arguments)}},Defs:{marker:Ia((function(e,t,n){return this.put(new vu).size(e,t).ref(e/2,t/2).viewbox(0,0,e,t).attr("orient","auto").update(n)}))},marker:{marker:function(e,t,n,r){var i=["marker"];return"all"!==e&&i.push(e),i=i.join("-"),e=arguments[1]instanceof vu?arguments[1]:this.defs().marker(t,n,r),this.attr(i,e)}}}),Ra(vu,"Marker");var yu=[].sort,mu=[1,2,3],gu=ut((function(){mu.sort(void 0)})),bu=ut((function(){mu.sort(null)})),_u=La("sort");function wu(e,t){return function(n){return null==n?this[n]:(this[e]=n,t&&t.call(this),this)}}Dn({target:"Array",proto:!0,forced:gu||!bu||_u},{sort:function(e){return void 0===e?yu.call(cr(this)):yu.call(cr(this),Sr(e))}});var Su={"-":function(e){return e},"<>":function(e){return-Math.cos(e*Math.PI)/2+.5},">":function(e){return Math.sin(e*Math.PI/2)},"<":function(e){return 1-Math.cos(e*Math.PI/2)},bezier:function(e,t,n,r){return function(i){return i<0?e>0?t/e*i:n>0?r/n*i:0:i>1?n<1?(1-r)/(1-n)*i+(r-n)/(1-n):e<1?(1-t)/(1-e)*i+(t-e)/(1-e):1:3*i*Math.pow(1-i,2)*t+3*Math.pow(i,2)*(1-i)*r+Math.pow(i,3)}},steps:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"end";t=t.split("-").reverse()[0];var n=e;return"none"===t?--n:"both"===t&&++n,function(r){var i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=Math.floor(r*e),a=r*o%1==0;return"start"!==t&&"both"!==t||++o,i&&a&&--o,r>=0&&o<0&&(o=0),r<=1&&o>n&&(o=n),o/n}}},Cu=function(){function e(){wa(this,e)}return qs(e,[{key:"done",value:function(){return!1}}]),e}(),ku=function(e){function t(e){var n;return wa(this,t),(n=Qs(this,Ks(t).call(this))).ease=Su[e||Rc.ease]||e,n}return tc(t,e),qs(t,[{key:"step",value:function(e,t,n){return"number"!=typeof e?n<1?e:t:e+(t-e)*this.ease(n)}}]),t}(Cu),xu=function(e){function t(e){var n;return wa(this,t),(n=Qs(this,Ks(t).call(this))).stepper=e,n}return tc(t,e),qs(t,[{key:"step",value:function(e,t,n,r){return this.stepper(e,t,n,r)}},{key:"done",value:function(e){return e.done}}]),t}(Cu);function Tu(){var e=(this._duration||500)/1e3,t=this._overshoot||0,n=Math.PI,r=Math.log(t/100+1e-10),i=-r/Math.sqrt(n*n+r*r),o=3.9/(i*e);this.d=2*i*o,this.k=o*o}Da(function(e){function t(e,n){var r;return wa(this,t),(r=Qs(this,Ks(t).call(this))).duration(e||500).overshoot(n||0),r}return tc(t,e),qs(t,[{key:"step",value:function(e,t,n,r){if("string"==typeof e)return e;if(r.done=n===1/0,n===1/0)return t;if(0===n)return e;n>100&&(n=16),n/=1e3;var i=r.velocity||0,o=-this.d*i-this.k*(e-t),a=e+i*n+o*n*n/2;return r.velocity=i+o*n,r.done=Math.abs(t-a)+Math.abs(i)<.002,r.done?t:a}}]),t}(xu),{duration:wu("_duration",Tu),overshoot:wu("_overshoot",Tu)}),Da(function(e){function t(e,n,r,i){var o;return wa(this,t),e=null==e?.1:e,n=null==n?.01:n,r=null==r?0:r,i=null==i?1e3:i,(o=Qs(this,Ks(t).call(this))).p(e).i(n).d(r).windup(i),o}return tc(t,e),qs(t,[{key:"step",value:function(e,t,n,r){if("string"==typeof e)return e;if(r.done=n===1/0,n===1/0)return t;if(0===n)return e;var i=t-e,o=(r.integral||0)+i*n,a=(i-(r.error||0))/n,s=this.windup;return!1!==s&&(o=Math.max(-s,Math.min(o,s))),r.error=i,r.integral=o,r.done=Math.abs(i)<.001,r.done?t:e+(this.P*i+this.I*o+this.D*a)}}]),t}(xu),{windup:wu("windup"),p:wu("P"),i:wu("I"),d:wu("D")});var Pu=kc("PathArray",jc);function Eu(e,t,n,r){return n+r.replace(ls," .")}for(var Ou={M:function(e,t,n){return t.x=n.x=e[0],t.y=n.y=e[1],["M",t.x,t.y]},L:function(e,t){return t.x=e[0],t.y=e[1],["L",e[0],e[1]]},H:function(e,t){return t.x=e[0],["H",e[0]]},V:function(e,t){return t.y=e[0],["V",e[0]]},C:function(e,t){return t.x=e[4],t.y=e[5],["C",e[0],e[1],e[2],e[3],e[4],e[5]]},S:function(e,t){return t.x=e[2],t.y=e[3],["S",e[0],e[1],e[2],e[3]]},Q:function(e,t){return t.x=e[2],t.y=e[3],["Q",e[0],e[1],e[2],e[3]]},T:function(e,t){return t.x=e[0],t.y=e[1],["T",e[0],e[1]]},Z:function(e,t,n){return t.x=n.x,t.y=n.y,["Z"]},A:function(e,t){return t.x=e[5],t.y=e[6],["A",e[0],e[1],e[2],e[3],e[4],e[5],e[6]]}},Ru="mlhvqtcsaz".split(""),Mu=0,ju=Ru.length;Mu<ju;++Mu)Ou[Ru[Mu]]=function(e){return function(t,n,r){if("H"===e)t[0]=t[0]+n.x;else if("V"===e)t[0]=t[0]+n.y;else if("A"===e)t[5]=t[5]+n.x,t[6]=t[6]+n.y;else for(var i=0,o=t.length;i<o;++i)t[i]=t[i]+(i%2?n.y:n.x);return Ou[e](t,n,r)}}(Ru[Mu].toUpperCase());Da(Pu,{toString:function(){return function(e){for(var t=0,n=e.length,r="";t<n;t++)r+=e[t][0],null!=e[t][1]&&(r+=e[t][1],null!=e[t][2]&&(r+=" ",r+=e[t][2],null!=e[t][3]&&(r+=" ",r+=e[t][3],r+=" ",r+=e[t][4],null!=e[t][5]&&(r+=" ",r+=e[t][5],r+=" ",r+=e[t][6],null!=e[t][7]&&(r+=" ",r+=e[t][7])))));return r+" "}(this)},move:function(e,t){var n=this.bbox();if(e-=n.x,t-=n.y,!isNaN(e)&&!isNaN(t))for(var r,i=this.length-1;i>=0;i--)"M"===(r=this[i][0])||"L"===r||"T"===r?(this[i][1]+=e,this[i][2]+=t):"H"===r?this[i][1]+=e:"V"===r?this[i][1]+=t:"C"===r||"S"===r||"Q"===r?(this[i][1]+=e,this[i][2]+=t,this[i][3]+=e,this[i][4]+=t,"C"===r&&(this[i][5]+=e,this[i][6]+=t)):"A"===r&&(this[i][6]+=e,this[i][7]+=t);return this},size:function(e,t){var n,r,i=this.bbox();for(i.width=0===i.width?1:i.width,i.height=0===i.height?1:i.height,n=this.length-1;n>=0;n--)"M"===(r=this[n][0])||"L"===r||"T"===r?(this[n][1]=(this[n][1]-i.x)*e/i.width+i.x,this[n][2]=(this[n][2]-i.y)*t/i.height+i.y):"H"===r?this[n][1]=(this[n][1]-i.x)*e/i.width+i.x:"V"===r?this[n][1]=(this[n][1]-i.y)*t/i.height+i.y:"C"===r||"S"===r||"Q"===r?(this[n][1]=(this[n][1]-i.x)*e/i.width+i.x,this[n][2]=(this[n][2]-i.y)*t/i.height+i.y,this[n][3]=(this[n][3]-i.x)*e/i.width+i.x,this[n][4]=(this[n][4]-i.y)*t/i.height+i.y,"C"===r&&(this[n][5]=(this[n][5]-i.x)*e/i.width+i.x,this[n][6]=(this[n][6]-i.y)*t/i.height+i.y)):"A"===r&&(this[n][1]=this[n][1]*e/i.width,this[n][2]=this[n][2]*t/i.height,this[n][6]=(this[n][6]-i.x)*e/i.width+i.x,this[n][7]=(this[n][7]-i.y)*t/i.height+i.y);return this},equalCommands:function(e){var t,n,r;for(e=new Pu(e),r=this.length===e.length,t=0,n=this.length;r&&t<n;t++)r=this[t][0]===e[t][0];return r},morph:function(e){return e=new Pu(e),this.equalCommands(e)?this.destination=e:this.destination=null,this},at:function(e){if(!this.destination)return this;var t,n,r,i,o=this.destination.value,a=[],s=new Pu;for(t=0,n=this.length;t<n;t++){for(a[t]=[this[t][0]],r=1,i=this[t].length;r<i;r++)a[t][r]=this[t][r]+(o[t][r]-this[t][r])*e;"A"===a[t][0]&&(a[t][4]=+(0!==a[t][4]),a[t][5]=+(0!==a[t][5]))}return s.value=a,s},parse:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[["M",0,0]];if(t instanceof Pu)return t;var n={M:2,L:2,H:1,V:1,C:6,S:4,Q:4,T:2,A:7,Z:0};t="string"==typeof t?t.replace(us,Eu).replace(ss," $& ").replace(as,"$1 -").trim().split(os):t.reduce((function(e,t){return[].concat.call(e,t)}),[]);var r=[],i=new mc,o=new mc,a=0,s=t.length;do{cs.test(t[a])?(e=t[a],++a):"M"===e?e="L":"m"===e&&(e="l"),r.push(Ou[e].call(null,t.slice(a,a+=n[e.toUpperCase()]).map(parseFloat),i,o))}while(s>a);return r},bbox:function(){return _c().path.setAttribute("d",this.toString()),_c.nodes.path.getBBox()}});var Du=function(){function e(t){wa(this,e),this._stepper=t||new ku("-"),this._from=null,this._to=null,this._type=null,this._context=null,this._morphObj=null}return qs(e,[{key:"from",value:function(e){return null==e?this._from:(this._from=this._set(e),this)}},{key:"to",value:function(e){return null==e?this._to:(this._to=this._set(e),this)}},{key:"type",value:function(e){return null==e?this._type:(this._type=e,this)}},{key:"_set",value:function(e){if(!this._type){var t=sr(e);"number"===t?this.type(Dc):"string"===t?Ws.isColor(e)?this.type(Ws):os.test(e)?this.type(ss.test(e)?Pu:jc):Wa.test(e)?this.type(Dc):this.type(Iu):Nu.indexOf(e.constructor)>-1?this.type(e.constructor):Array.isArray(e)?this.type(jc):"object"===t?this.type(Lu):this.type(Iu)}var n=new this._type(e);return this._type===Ws&&(n=this._to?n[this._to[4]]():this._from?n[this._from[4]]():n),n=n.toArray(),this._morphObj=this._morphObj||new this._type,this._context=this._context||Array.apply(null,Array(n.length)).map(Object).map((function(e){return e.done=!0,e})),n}},{key:"stepper",value:function(e){return null==e?this._stepper:(this._stepper=e,this)}},{key:"done",value:function(){return this._context.map(this._stepper.done).reduce((function(e,t){return e&&t}),!0)}},{key:"at",value:function(e){var t=this;return this._morphObj.fromArray(this._from.map((function(n,r){return t._stepper.step(n,t._to[r],e,t._context[r],t._context)})))}}]),e}(),Iu=function(){function e(){wa(this,e),this.init.apply(this,arguments)}return qs(e,[{key:"init",value:function(e){return e=Array.isArray(e)?e[0]:e,this.value=e,this}},{key:"valueOf",value:function(){return this.value}},{key:"toArray",value:function(){return[this.value]}}]),e}(),Au=function(){function e(){wa(this,e),this.init.apply(this,arguments)}return qs(e,[{key:"init",value:function(t){return Array.isArray(t)&&(t={scaleX:t[0],scaleY:t[1],shear:t[2],rotate:t[3],translateX:t[4],translateY:t[5],originX:t[6],originY:t[7]}),Object.assign(this,e.defaults,t),this}},{key:"toArray",value:function(){var e=this;return[e.scaleX,e.scaleY,e.shear,e.rotate,e.translateX,e.translateY,e.originX,e.originY]}}]),e}();Au.defaults={scaleX:1,scaleY:1,shear:0,rotate:0,translateX:0,translateY:0,originX:0,originY:0};var Lu=function(){function e(){wa(this,e),this.init.apply(this,arguments)}return qs(e,[{key:"init",value:function(e){if(this.values=[],!Array.isArray(e)){e=e||{};var t=[];for(var n in e)t.push([n,e[n]]);return t.sort((function(e,t){return e[0]-t[0]})),this.values=t.reduce((function(e,t){return e.concat(t)}),[]),this}this.values=e}},{key:"valueOf",value:function(){for(var e={},t=this.values,n=0,r=t.length;n<r;n+=2)e[t[n]]=t[n+1];return e}},{key:"toArray",value:function(){return this.values}}]),e}(),Nu=[Iu,Au,Lu];var Bu=function(e){function t(e){return wa(this,t),Qs(this,Ks(t).call(this,Pa("path",e),e))}return tc(t,e),qs(t,[{key:"array",value:function(){return this._array||(this._array=new Pu(this.attr("d")))}},{key:"plot",value:function(e){return null==e?this.array():this.clear().attr("d","string"==typeof e?e:this._array=new Pu(e))}},{key:"clear",value:function(){return delete this._array,this}},{key:"move",value:function(e,t){return this.attr("d",this.array().move(e,t))}},{key:"x",value:function(e){return null==e?this.bbox().x:this.move(e,this.bbox().y)}},{key:"y",value:function(e){return null==e?this.bbox().y:this.move(this.bbox().x,e)}},{key:"size",value:function(e,t){var n=va(this,e,t);return this.attr("d",this.array().size(n.width,n.height))}},{key:"width",value:function(e){return null==e?this.bbox().width:this.size(e,this.bbox().height)}},{key:"height",value:function(e){return null==e?this.bbox().height:this.size(this.bbox().width,e)}},{key:"targets",value:function(){return Pc('svg textpath [href*="'+this.id()+'"]')}}]),t}(Zc);Bu.prototype.MorphArray=Pu,Po({Container:{path:Ia((function(e){return this.put(new Bu).plot(e||new Pu)}))}}),Ra(Bu,"Path");var Fu={__proto__:null,array:function(){return this._array||(this._array=new hu(this.attr("points")))},plot:function(e){return null==e?this.array():this.clear().attr("points","string"==typeof e?e:this._array=new hu(e))},clear:function(){return delete this._array,this},move:function(e,t){return this.attr("points",this.array().move(e,t))},size:function(e,t){var n=va(this,e,t);return this.attr("points",this.array().size(n.width,n.height))}},zu=function(e){function t(e){return wa(this,t),Qs(this,Ks(t).call(this,Pa("polygon",e),e))}return tc(t,e),t}(Zc);Po({Container:{polygon:Ia((function(e){return this.put(new zu).plot(e||new hu)}))}}),Da(zu,pu),Da(zu,Fu),Ra(zu,"Polygon");var Gu=function(e){function t(e){return wa(this,t),Qs(this,Ks(t).call(this,Pa("polyline",e),e))}return tc(t,e),t}(Zc);Po({Container:{polyline:Ia((function(e){return this.put(new Gu).plot(e||new hu)}))}}),Da(Gu,pu),Da(Gu,Fu),Ra(Gu,"Polyline");var qu=function(e){function t(e){return wa(this,t),Qs(this,Ks(t).call(this,Pa("rect",e),e))}return tc(t,e),t}(Zc);Da(qu,{rx:Hc,ry:Vc}),Po({Container:{rect:Ia((function(e,t){return this.put(new qu).size(e,t)}))}}),Ra(qu,"Rect");var Uu=Math.max,Hu=Math.min;Dn({target:"Array",proto:!0,forced:!$n("splice")},{splice:function(e,t){var n,r,i,o,a,s,c=cr(this),u=fn(c.length),l=dn(e,u),f=arguments.length;if(0===f?n=r=0:1===f?(n=0,r=u-l):(n=f-2,r=Hu(Uu(un(t),0),u-l)),u+n-r>9007199254740991)throw TypeError("Maximum allowed length exceeded");for(i=xr(c,r),o=0;o<r;o++)(a=l+o)in c&&An(i,o,c[a]);if(i.length=r,n<r){for(o=l;o<u-r;o++)s=o+n,(a=o+r)in c?c[s]=c[a]:delete c[s];for(o=u;o>u-r+n;o--)delete c[o-1]}else if(n>r)for(o=u-r;o>l;o--)s=o+n-1,(a=o+r-1)in c?c[s]=c[a]:delete c[s];for(o=0;o<n;o++)c[o+l]=arguments[o+2];return c.length=u-r+n,i}});var Vu=function(){function e(){wa(this,e),this._first=null,this._last=null}return qs(e,[{key:"push",value:function(e){var t=e.next?e:{value:e,next:null,prev:null};return this._last?(t.prev=this._last,this._last.next=t,this._last=t):(this._last=t,this._first=t),t}},{key:"shift",value:function(){var e=this._first;return e?(this._first=e.next,this._first&&(this._first.prev=null),this._last=this._first?this._last:null,e.value):null}},{key:"first",value:function(){return this._first&&this._first.value}},{key:"last",value:function(){return this._last&&this._last.value}},{key:"remove",value:function(e){e.prev&&(e.prev.next=e.next),e.next&&(e.next.prev=e.prev),e===this._last&&(this._last=e.prev),e===this._first&&(this._first=e.next),e.prev=null,e.next=null}}]),e}(),$u={nextDraw:null,frames:new Vu,timeouts:new Vu,immediates:new Vu,timer:function(){return _a.window.performance||_a.window.Date},transforms:[],frame:function(e){var t=$u.frames.push({run:e});return null===$u.nextDraw&&($u.nextDraw=_a.window.requestAnimationFrame($u._draw)),t},timeout:function(e,t){t=t||0;var n=$u.timer().now()+t,r=$u.timeouts.push({run:e,time:n});return null===$u.nextDraw&&($u.nextDraw=_a.window.requestAnimationFrame($u._draw)),r},immediate:function(e){var t=$u.immediates.push(e);return null===$u.nextDraw&&($u.nextDraw=_a.window.requestAnimationFrame($u._draw)),t},cancelFrame:function(e){null!=e&&$u.frames.remove(e)},clearTimeout:function(e){null!=e&&$u.timeouts.remove(e)},cancelImmediate:function(e){null!=e&&$u.immediates.remove(e)},_draw:function(e){for(var t=null,n=$u.timeouts.last();(t=$u.timeouts.shift())&&(e>=t.time?t.run():$u.timeouts.push(t),t!==n););for(var r=null,i=$u.frames.last();r!==i&&(r=$u.frames.shift());)r.run(e);for(var o=null;o=$u.immediates.shift();)o();$u.nextDraw=$u.timeouts.first()||$u.frames.first()?_a.window.requestAnimationFrame($u._draw):null}},Yu=function(e){var t=e.start,n=e.runner.duration();return{start:t,duration:n,end:t+n,runner:e.runner}},Wu=function(){var e=_a.window;return(e.performance||e.Date).now()},Xu=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Wu;return wa(this,t),(e=Qs(this,Ks(t).call(this)))._timeSource=n,e._startTime=0,e._speed=1,e._persist=0,e._nextFrame=null,e._paused=!0,e._runners=[],e._runnerIds=[],e._lastRunnerId=-1,e._time=0,e._lastSourceTime=0,e._lastStepTime=0,e._step=e._stepFn.bind(Js(e),!1),e._stepImmediate=e._stepFn.bind(Js(e),!0),e}return tc(t,e),qs(t,[{key:"schedule",value:function(e,t,n){if(null==e)return this._runners.map(Yu);var r=0,i=this.getEndTime();if(t=t||0,null==n||"last"===n||"after"===n)r=i;else if("absolute"===n||"start"===n)r=t,t=0;else if("now"===n)r=this._time;else{if("relative"!==n)throw new Error('Invalid value for the "when" parameter');var o=this._runners[e.id];o&&(r=o.start+t,t=0)}e.unschedule(),e.timeline(this);var a=e.persist(),s={persist:null===a?this._persist:a,start:r+t,runner:e};return this._lastRunnerId=e.id,this._runners.push(s),this._runners.sort((function(e,t){return e.start-t.start})),this._runnerIds=this._runners.map((function(e){return e.runner.id})),this.updateTime()._continue(),this}},{key:"unschedule",value:function(e){var t=this._runnerIds.indexOf(e.id);return t<0?this:(this._runners.splice(t,1),this._runnerIds.splice(t,1),e.timeline(null),this)}},{key:"getEndTime",value:function(){var e=this._runners[this._runnerIds.indexOf(this._lastRunnerId)],t=e?e.runner.duration():0;return(e?e.start:0)+t}},{key:"getEndTimeOfTimeline",value:function(){for(var e=0,t=0;t<this._runners.length;t++){var n=this._runners[t],r=n?n.runner.duration():0,i=(n?n.start:0)+r;i>e&&(e=i)}return e}},{key:"updateTime",value:function(){return this.active()||(this._lastSourceTime=this._timeSource()),this}},{key:"play",value:function(){return this._paused=!1,this.updateTime()._continue()}},{key:"pause",value:function(){return this._paused=!0,this._continue()}},{key:"stop",value:function(){return this.time(0),this.pause()}},{key:"finish",value:function(){return this.time(this.getEndTimeOfTimeline()+1),this.pause()}},{key:"speed",value:function(e){return null==e?this._speed:(this._speed=e,this)}},{key:"reverse",value:function(e){var t=this.speed();if(null==e)return this.speed(-t);var n=Math.abs(t);return this.speed(e?n:-n)}},{key:"seek",value:function(e){return this.time(this._time+e)}},{key:"time",value:function(e){return null==e?this._time:(this._time=e,this._continue(!0))}},{key:"persist",value:function(e){return null==e?this._persist:(this._persist=e,this)}},{key:"source",value:function(e){return null==e?this._timeSource:(this._timeSource=e,this)}},{key:"_stepFn",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this._timeSource(),n=t-this._lastSourceTime;e&&(n=0);var r=this._speed*n+(this._time-this._lastStepTime);this._lastSourceTime=t,e||(this._time+=r,this._time=this._time<0?0:this._time),this._lastStepTime=this._time,this.fire("time",this._time);for(var i=this._runners.length;i--;){var o=this._runners[i],a=o.runner,s=this._time-o.start;s<=0&&a.reset()}for(var c=!1,u=0,l=this._runners.length;u<l;u++){var f=this._runners[u],h=f.runner,p=r,d=this._time-f.start;if(d<=0)c=!0;else if(d<p&&(p=d),h.active()){var v=h.step(p).done;if(v){if(!0!==f.persist){var y=h.duration()-h.time()+this._time;y+f.persist<this._time&&(h.unschedule(),--u,--l)}}else c=!0}}return c&&!(this._speed<0&&0===this._time)||this._runnerIds.length&&this._speed<0&&this._time>0?this._continue():(this.pause(),this.fire("finished")),this}},{key:"_continue",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return $u.cancelFrame(this._nextFrame),this._nextFrame=null,e?this._stepImmediate():this._paused?this:(this._nextFrame=$u.frame(this._step),this)}},{key:"active",value:function(){return!!this._nextFrame}}]),t}(Ec);function Ju(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Qu(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ju(n,!0).forEach((function(t){qc(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ju(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}Po({Element:{timeline:function(e){return null==e?(this._timeline=this._timeline||new Xu,this._timeline):(this._timeline=e,this)}}});var Ku=function(e){function t(e){var n;return wa(this,t),(n=Qs(this,Ks(t).call(this))).id=t.id++,e="function"==typeof(e=null==e?Rc.duration:e)?new xu(e):e,n._element=null,n._timeline=null,n.done=!1,n._queue=[],n._duration="number"==typeof e&&e,n._isDeclarative=e instanceof xu,n._stepper=n._isDeclarative?e:new ku,n._history={},n.enabled=!0,n._time=0,n._lastTime=0,n._reseted=!0,n.transforms=new bc,n.transformId=1,n._haveReversed=!1,n._reverse=!1,n._loopsDone=0,n._swing=!1,n._wait=0,n._times=1,n._frameId=null,n._persist=!!n._isDeclarative||null,n}return tc(t,e),qs(t,[{key:"element",value:function(e){return null==e?this._element:(this._element=e,e._prepareRunner(),this)}},{key:"timeline",value:function(e){return void 0===e?this._timeline:(this._timeline=e,this)}},{key:"animate",value:function(e,n,r){var i=t.sanitise(e,n,r),o=new t(i.duration);return this._timeline&&o.timeline(this._timeline),this._element&&o.element(this._element),o.loop(i).schedule(i.delay,i.when)}},{key:"schedule",value:function(e,t,n){if(e instanceof Xu||(n=t,t=e,e=this.timeline()),!e)throw Error("Runner cannot be scheduled without timeline");return e.schedule(this,t,n),this}},{key:"unschedule",value:function(){var e=this.timeline();return e&&e.unschedule(this),this}},{key:"loop",value:function(e,t,n){return"object"===sr(e)&&(t=e.swing,n=e.wait,e=e.times),this._times=e||1/0,this._swing=t||!1,this._wait=n||0,!0===this._times&&(this._times=1/0),this}},{key:"delay",value:function(e){return this.animate(0,e)}},{key:"queue",value:function(e,t,n,r){return this._queue.push({initialiser:e||Oc,runner:t||Oc,retarget:n,isTransform:r,initialised:!1,finished:!1}),this.timeline()&&this.timeline()._continue(),this}},{key:"during",value:function(e){return this.queue(null,e)}},{key:"after",value:function(e){return this.on("finished",e)}},{key:"time",value:function(e){if(null==e)return this._time;var t=e-this._time;return this.step(t),this}},{key:"duration",value:function(){return this._times*(this._wait+this._duration)-this._wait}},{key:"loops",value:function(e){var t=this._duration+this._wait;if(null==e){var n=Math.floor(this._time/t),r=(this._time-n*t)/this._duration;return Math.min(n+r,this._times)}var i=e%1,o=t*Math.floor(e)+this._duration*i;return this.time(o)}},{key:"persist",value:function(e){return null==e?this._persist:(this._persist=e,this)}},{key:"position",value:function(e){var t,n=this._time,r=this._duration,i=this._wait,o=this._times,a=this._swing,s=this._reverse;if(null==e){var c=function(e){var t=a*Math.floor(e%(2*(i+r))/(i+r)),n=t&&!s||!t&&s,o=Math.pow(-1,n)*(e%(i+r))/r+n;return Math.max(Math.min(o,1),0)},u=o*(i+r)-i;return t=n<=0?Math.round(c(1e-5)):n<u?c(n):Math.round(c(u-1e-5)),t}var l=Math.floor(this.loops()),f=a&&l%2==0;return t=l+(f&&!s||s&&f?e:1-e),this.loops(t)}},{key:"progress",value:function(e){return null==e?Math.min(1,this._time/this.duration()):this.time(e*this.duration())}},{key:"step",value:function(e){if(!this.enabled)return this;e=null==e?16:e,this._time+=e;var t=this.position(),n=this._lastPosition!==t&&this._time>=0;this._lastPosition=t;var r=this.duration(),i=this._lastTime<=0&&this._time>0,o=this._lastTime<r&&this._time>=r;this._lastTime=this._time,i&&this.fire("start",this);var a=this._isDeclarative;if(this.done=!a&&!o&&this._time>=r,this._reseted=!1,n||a){this._initialise(n),this.transforms=new bc;var s=this._run(a?e:t);this.fire("step",this)}return this.done=this.done||s&&a,o&&this.fire("finished",this),this}},{key:"reset",value:function(){return this._reseted?this:(this.time(0),this._reseted=!0,this)}},{key:"finish",value:function(){return this.step(1/0)}},{key:"reverse",value:function(e){return this._reverse=null==e?!this._reverse:e,this}},{key:"ease",value:function(e){return this._stepper=new ku(e),this}},{key:"active",value:function(e){return null==e?this.enabled:(this.enabled=e,this)}},{key:"_rememberMorpher",value:function(e,t){if(this._history[e]={morpher:t,caller:this._queue[this._queue.length-1]},this._isDeclarative){var n=this.timeline();n&&n.play()}}},{key:"_tryRetarget",value:function(e,t,n){if(this._history[e]){if(!this._history[e].caller.initialised){var r=this._queue.indexOf(this._history[e].caller);return this._queue.splice(r,1),!1}this._history[e].caller.retarget?this._history[e].caller.retarget(t,n):this._history[e].morpher.to(t),this._history[e].caller.finished=!1;var i=this.timeline();return i&&i.play(),!0}return!1}},{key:"_initialise",value:function(e){if(e||this._isDeclarative)for(var t=0,n=this._queue.length;t<n;++t){var r=this._queue[t],i=this._isDeclarative||!r.initialised&&e;e=!r.finished,i&&e&&(r.initialiser.call(this),r.initialised=!0)}}},{key:"_run",value:function(e){for(var t=!0,n=0,r=this._queue.length;n<r;++n){var i=this._queue[n],o=i.runner.call(this,e);i.finished=i.finished||!0===o,t=t&&i.finished}return t}},{key:"addTransform",value:function(e,t){return this.transforms.lmultiplyO(e),this}},{key:"clearTransform",value:function(){return this.transforms=new bc,this}},{key:"clearTransformsFromQueue",value:function(){this.done&&this._timeline&&this._timeline._runnerIds.includes(this.id)||(this._queue=this._queue.filter((function(e){return!e.isTransform})))}}],[{key:"sanitise",value:function(e,t,n){var r=1,i=!1,o=0;return e=e||Rc.duration,t=t||Rc.delay,n=n||"last","object"!==sr(e)||e instanceof Cu||(t=e.delay||t,n=e.when||n,i=e.swing||i,r=e.times||r,o=e.wait||o,e=e.duration||Rc.duration),{duration:e,delay:t,swing:i,times:r,wait:o,when:n}}}]),t}(Ec);Ku.id=0;var Zu=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new bc,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];wa(this,e),this.transforms=t,this.id=n,this.done=r}return qs(e,[{key:"clearTransformsFromQueue",value:function(){}}]),e}();Da([Ku,Zu],{mergeWith:function(e){return new Zu(e.transforms.lmultiply(this.transforms),e.id)}});var el=function(e,t){return e.lmultiplyO(t)},tl=function(e){return e.transforms};function nl(){var e=this._transformationRunners.runners.map(tl).reduce(el,new bc);this.transform(e),this._transformationRunners.merge(),1===this._transformationRunners.length()&&(this._frameId=null)}var rl=function(){function e(){wa(this,e),this.runners=[],this.ids=[]}return qs(e,[{key:"add",value:function(e){if(!this.runners.includes(e)){var t=e.id+1;return this.runners.push(e),this.ids.push(t),this}}},{key:"getByID",value:function(e){return this.runners[this.ids.indexOf(e+1)]}},{key:"remove",value:function(e){var t=this.ids.indexOf(e+1);return this.ids.splice(t,1),this.runners.splice(t,1),this}},{key:"merge",value:function(){var e=this,t=null;return this.runners.forEach((function(n,r){t&&n.done&&t.done&&(!n._timeline||!n._timeline._runnerIds.includes(n.id))&&(!t._timeline||!t._timeline._runnerIds.includes(t.id))&&(e.remove(n.id),e.edit(t.id,n.mergeWith(t))),t=n})),this}},{key:"edit",value:function(e,t){var n=this.ids.indexOf(e+1);return this.ids.splice(n,1,e+1),this.runners.splice(n,1,t),this}},{key:"length",value:function(){return this.ids.length}},{key:"clearBefore",value:function(e){var t=this.ids.indexOf(e+1)||1;return this.ids.splice(0,t,0),this.runners.splice(0,t,new Zu).forEach((function(e){return e.clearTransformsFromQueue()})),this}}]),e}();Po({Element:{animate:function(e,t,n){var r=Ku.sanitise(e,t,n),i=this.timeline();return new Ku(r.duration).loop(r).element(this).timeline(i.play()).schedule(r.delay,r.when)},delay:function(e,t){return this.animate(0,e,t)},_clearTransformRunnersBefore:function(e){this._transformationRunners.clearBefore(e.id)},_currentTransform:function(e){return this._transformationRunners.runners.filter((function(t){return t.id<=e.id})).map(tl).reduce(el,new bc)},_addRunner:function(e){this._transformationRunners.add(e),$u.cancelImmediate(this._frameId),this._frameId=$u.immediate(nl.bind(this))},_prepareRunner:function(){null==this._frameId&&(this._transformationRunners=(new rl).add(new Zu(new bc(this))))}}}),Da(Ku,{attr:function(e,t){return this.styleAttr("attr",e,t)},css:function(e,t){return this.styleAttr("css",e,t)},styleAttr:function(e,t,n){if("object"===sr(t)){for(var r in t)this.styleAttr(e,r,t[r]);return this}var i=new Du(this._stepper).to(n);return this.queue((function(){i=i.from(this.element()[e](t))}),(function(n){return this.element()[e](t,i.at(n)),i.done()})),this},zoom:function(e,t){if(this._tryRetarget("zoom",au,t))return this;var n=new Du(this._stepper).to(new Dc(e));return this.queue((function(){n=n.from(this.element().zoom())}),(function(e){return this.element().zoom(n.at(e),t),n.done()}),(function(e,r){t=r,n.to(e)})),this._rememberMorpher("zoom",n),this},transform:function(e,t,n){if(t=e.relative||t,this._isDeclarative&&!t&&this._tryRetarget("transform",e))return this;var r=bc.isMatrixLike(e);n=null!=e.affine?e.affine:null!=n?n:!r;var i,o,a,s,c,u=new Du(this._stepper).type(n?Au:bc);return this.queue((function(){o=o||this.element(),i=i||ya(e,o),c=new bc(t?void 0:o),o._addRunner(this),t||o._clearTransformRunnersBefore(this)}),(function(l){t||this.clearTransform();var f=new mc(i).transform(o._currentTransform(this)),h=f.x,p=f.y,d=new bc(Qu({},e,{origin:[h,p]})),v=this._isDeclarative&&a?a:c;if(n){d=d.decompose(h,p),v=v.decompose(h,p);var y=d.rotate,m=v.rotate,g=[y-360,y,y+360],b=g.map((function(e){return Math.abs(e-m)})),_=Math.min.apply(Math,ko(b)),w=b.indexOf(_);d.rotate=g[w]}t&&(r||(d.rotate=e.rotate||0),this._isDeclarative&&s&&(v.rotate=s)),u.from(v),u.to(d);var S=u.at(l);return s=S.rotate,a=new bc(S),this.addTransform(a),o._addRunner(this),u.done()}),(function(t){(t.origin||"center").toString()!==(e.origin||"center").toString()&&(i=ya(e,o)),e=Qu({},t,{origin:i})}),!0),this._isDeclarative&&this._rememberMorpher("transform",u),this},x:function(e,t){return this._queueNumber("x",e)},y:function(e){return this._queueNumber("y",e)},dx:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this._queueNumberDelta("x",e)},dy:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this._queueNumberDelta("y",e)},dmove:function(e,t){return this.dx(e).dy(t)},_queueNumberDelta:function(e,t){if(t=new Dc(t),this._tryRetarget(e,t))return this;var n=new Du(this._stepper).to(t),r=null;return this.queue((function(){r=this.element()[e](),n.from(r),n.to(r+t)}),(function(t){return this.element()[e](n.at(t)),n.done()}),(function(e){n.to(r+new Dc(e))})),this._rememberMorpher(e,n),this},_queueObject:function(e,t){if(this._tryRetarget(e,t))return this;var n=new Du(this._stepper).to(t);return this.queue((function(){n.from(this.element()[e]())}),(function(t){return this.element()[e](n.at(t)),n.done()})),this._rememberMorpher(e,n),this},_queueNumber:function(e,t){return this._queueObject(e,new Dc(t))},cx:function(e){return this._queueNumber("cx",e)},cy:function(e){return this._queueNumber("cy",e)},move:function(e,t){return this.x(e).y(t)},center:function(e,t){return this.cx(e).cy(t)},size:function(e,t){var n;return e&&t||(n=this._element.bbox()),e||(e=n.width/n.height*t),t||(t=n.height/n.width*e),this.width(e).height(t)},width:function(e){return this._queueNumber("width",e)},height:function(e){return this._queueNumber("height",e)},plot:function(e,t,n,r){if(4===arguments.length)return this.plot([e,t,n,r]);if(this._tryRetarget("plot",e))return this;var i=new Du(this._stepper).type(this._element.MorphArray).to(e);return this.queue((function(){i.from(this._element.array())}),(function(e){return this._element.plot(i.at(e)),i.done()})),this._rememberMorpher("plot",i),this},leading:function(e){return this._queueNumber("leading",e)},viewbox:function(e,t,n,r){return this._queueObject("viewbox",new Sc(e,t,n,r))},update:function(e){return"object"!==sr(e)?this.update({offset:arguments[0],color:arguments[1],opacity:arguments[2]}):(null!=e.opacity&&this.attr("stop-opacity",e.opacity),null!=e.color&&this.attr("stop-color",e.color),null!=e.offset&&this.attr("offset",e.offset),this)}}),Da(Ku,{rx:Hc,ry:Vc,from:ou,to:au}),Ra(Ku,"Runner");var il=function(e){function t(e){var n;return wa(this,t),(n=Qs(this,Ks(t).call(this,Pa("svg",e),e))).namespace(),n}return tc(t,e),qs(t,[{key:"isRoot",value:function(){return!(this.node.parentNode&&this.node.parentNode instanceof _a.window.SVGElement&&"#document"!==this.node.parentNode.nodeName)}},{key:"root",value:function(){return this.isRoot()?this:Zs(Ks(t.prototype),"root",this).call(this)}},{key:"namespace",value:function(){return this.isRoot()?this.attr({xmlns:ma,version:"1.1"}).attr("xmlns:xlink",ba,ga).attr("xmlns:svgjs","http://svgjs.com/svgjs",ga):this.root().namespace()}},{key:"defs",value:function(){return this.isRoot()?Ea(this.node.querySelector("defs"))||this.put(new nu):this.root().defs()}},{key:"parent",value:function(e){return this.isRoot()?"#document"===this.node.parentNode.nodeName?null:Ea(this.node.parentNode):Zs(Ks(t.prototype),"parent",this).call(this,e)}},{key:"clear",value:function(){for(;this.node.hasChildNodes();)this.node.removeChild(this.node.lastChild);return delete this._defs,this}}]),t}(tu);Po({Container:{nested:Ia((function(){return this.put(new il)}))}}),Ra(il,"Svg",!0);var ol=function(e){function t(e){return wa(this,t),Qs(this,Ks(t).call(this,Pa("symbol",e),e))}return tc(t,e),t}(tu);Po({Container:{symbol:Ia((function(){return this.put(new ol)}))}}),Ra(ol,"Symbol");var al={__proto__:null,plain:function(e){return!1===this._build&&this.clear(),this.node.appendChild(_a.document.createTextNode(e)),this},length:function(){return this.node.getComputedTextLength()}},sl=function(e){function t(e){var n;return wa(this,t),(n=Qs(this,Ks(t).call(this,Pa("text",e),e))).dom.leading=new Dc(1.3),n._rebuild=!0,n._build=!1,n}return tc(t,e),qs(t,[{key:"x",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.bbox();return null==e?t.x:this.attr("x",this.attr("x")+e-t.x)}},{key:"y",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.bbox();return null==e?t.y:this.attr("y",this.attr("y")+e-t.y)}},{key:"move",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.bbox();return this.x(e,n).y(t,n)}},{key:"cx",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.bbox();return null==e?t.cx:this.attr("x",this.attr("x")+e-t.cx)}},{key:"cy",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.bbox();return null==e?t.cy:this.attr("y",this.attr("y")+e-t.cy)}},{key:"center",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.bbox();return this.cx(e,n).cy(t,n)}},{key:"text",value:function(e){if(void 0===e){var t=this.node.childNodes,n=0;e="";for(var r=0,i=t.length;r<i;++r)"textPath"!==t[r].nodeName?(r!==n&&3!==t[r].nodeType&&!0===Ea(t[r]).dom.newLined&&(e+="\n"),e+=t[r].textContent):0===r&&(n=1);return e}if(this.clear().build(!0),"function"==typeof e)e.call(this,this);else for(var o=0,a=(e=e.split("\n")).length;o<a;o++)this.tspan(e[o]).newLine();return this.build(!1).rebuild()}},{key:"leading",value:function(e){return null==e?this.dom.leading:(this.dom.leading=new Dc(e),this.rebuild())}},{key:"rebuild",value:function(e){if("boolean"==typeof e&&(this._rebuild=e),this._rebuild){var t=this,n=0,r=this.dom.leading;this.each((function(){var e=_a.window.getComputedStyle(this.node).getPropertyValue("font-size"),i=r*new Dc(e);this.dom.newLined&&(this.attr("x",t.attr("x")),"\n"===this.text()?n+=i:(this.attr("dy",i+n),n=0))})),this.fire("rebuild")}return this}},{key:"build",value:function(e){return this._build=!!e,this}},{key:"setData",value:function(e){return this.dom=e,this.dom.leading=new Dc(e.leading||1.3),this}}]),t}(Zc);Da(sl,al),Po({Container:{text:Ia((function(e){return this.put(new sl).text(e)})),plain:Ia((function(e){return this.put(new sl).plain(e)}))}}),Ra(sl,"Text");var cl=function(e){function t(e){return wa(this,t),Qs(this,Ks(t).call(this,Pa("tspan",e),e))}return tc(t,e),qs(t,[{key:"text",value:function(e){return null==e?this.node.textContent+(this.dom.newLined?"\n":""):("function"==typeof e?e.call(this,this):this.plain(e),this)}},{key:"dx",value:function(e){return this.attr("dx",e)}},{key:"dy",value:function(e){return this.attr("dy",e)}},{key:"x",value:function(e){return this.attr("x",e)}},{key:"y",value:function(e){return this.attr("x",e)}},{key:"move",value:function(e,t){return this.x(e).y(t)}},{key:"newLine",value:function(){var e=this.parent(sl);this.dom.newLined=!0;var t=_a.window.getComputedStyle(this.node).getPropertyValue("font-size"),n=e.dom.leading*new Dc(t);return this.dy(n).attr("x",e.x())}}]),t}(sl);Da(cl,al),Po({Tspan:{tspan:Ia((function(e){var t=new cl;return this._build||this.clear(),this.node.appendChild(t.node),t.text(e)}))}}),Ra(cl,"Tspan");var ul=function(e){function t(e){return wa(this,t),Qs(this,Ks(t).call(this,Pa("clipPath",e),e))}return tc(t,e),qs(t,[{key:"remove",value:function(){return this.targets().forEach((function(e){e.unclip()})),Zs(Ks(t.prototype),"remove",this).call(this)}},{key:"targets",value:function(){return Pc('svg [clip-path*="'+this.id()+'"]')}}]),t}(tu);Po({Container:{clip:Ia((function(){return this.defs().put(new ul)}))},Element:{clipWith:function(e){var t=e instanceof ul?e:this.parent().clip().add(e);return this.attr("clip-path",'url("#'+t.id()+'")')},unclip:function(){return this.attr("clip-path",null)},clipper:function(){return this.reference("clip-path")}}}),Ra(ul,"ClipPath");var ll=function(e){function t(e){return wa(this,t),Qs(this,Ks(t).call(this,Pa("foreignObject",e),e))}return tc(t,e),t}(Lc);Po({Container:{foreignObject:Ia((function(e,t){return this.put(new ll).size(e,t)}))}}),Ra(ll,"ForeignObject");var fl=function(e){function t(e){return wa(this,t),Qs(this,Ks(t).call(this,Pa("g",e),e))}return tc(t,e),qs(t,[{key:"x",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.bbox();return null==e?t.x:this.move(e,t.y,t)}},{key:"y",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.bbox();return null==e?t.y:this.move(t.x,e,t)}},{key:"move",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.bbox(),r=e-n.x,i=t-n.y;return this.dmove(r,i)}},{key:"dx",value:function(e){return this.dmove(e,0)}},{key:"dy",value:function(e){return this.dmove(0,e)}},{key:"dmove",value:function(e,t){return this.children().forEach((function(n,r){var i=n.bbox(),o=new bc(n),a=o.translate(e,t).transform(o.inverse()),s=new mc(i.x,i.y).transform(a);n.move(s.x,s.y)})),this}},{key:"width",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.bbox();return null==e?t.width:this.size(e,t.height,t)}},{key:"height",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.bbox();return null==e?t.height:this.size(t.width,e,t)}},{key:"size",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.bbox(),r=va(this,e,t,n),i=r.width/n.width,o=r.height/n.height;return this.children().forEach((function(e,t){var r=new mc(n).transform(new bc(e).inverse());e.scale(i,o,r.x,r.y)})),this}}]),t}(tu);Po({Container:{group:Ia((function(){return this.put(new fl)}))}}),Ra(fl,"G");var hl=function(e){function t(e){return wa(this,t),Qs(this,Ks(t).call(this,Pa("a",e),e))}return tc(t,e),qs(t,[{key:"to",value:function(e){return this.attr("href",e,ba)}},{key:"target",value:function(e){return this.attr("target",e)}}]),t}(tu);Po({Container:{link:Ia((function(e){return this.put(new hl).to(e)}))},Element:{linkTo:function(e){var t=new hl;return"function"==typeof e?e.call(t,t):t.to(e),this.parent().put(t).put(this)}}}),Ra(hl,"A");var pl=function(e){function t(e){return wa(this,t),Qs(this,Ks(t).call(this,Pa("mask",e),e))}return tc(t,e),qs(t,[{key:"remove",value:function(){return this.targets().forEach((function(e){e.unmask()})),Zs(Ks(t.prototype),"remove",this).call(this)}},{key:"targets",value:function(){return Pc('svg [mask*="'+this.id()+'"]')}}]),t}(tu);function dl(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function vl(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?dl(n,!0).forEach((function(t){qc(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):dl(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}Po({Container:{mask:Ia((function(){return this.defs().put(new pl)}))},Element:{maskWith:function(e){var t=e instanceof pl?e:this.parent().mask().add(e);return this.attr("mask",'url("#'+t.id()+'")')},unmask:function(){return this.attr("mask",null)},masker:function(){return this.reference("mask")}}}),Ra(pl,"Mask");var yl=function(e){function t(e){return wa(this,t),Qs(this,Ks(t).call(this,Pa("style",e),e))}return tc(t,e),qs(t,[{key:"addText",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.node.textContent+=e,this}},{key:"font",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.rule("@font-face",vl({fontFamily:e,src:t},n))}},{key:"rule",value:function(e,t){return this.addText(function(e,t){if(!e)return"";if(!t)return e;var n=e+"{";for(var r in t)n+=pa(r)+":"+t[r]+";";return n+="}"}(e,t))}}]),t}(Lc);Po("Dom",{style:Ia((function(e,t){return this.put(new yl).rule(e,t)})),fontface:Ia((function(e,t,n){return this.put(new yl).font(e,t,n)}))}),Ra(yl,"Style");var ml=function(e){function t(e){return wa(this,t),Qs(this,Ks(t).call(this,Pa("textPath",e),e))}return tc(t,e),qs(t,[{key:"array",value:function(){var e=this.track();return e?e.array():null}},{key:"plot",value:function(e){var t=this.track(),n=null;return t&&(n=t.plot(e)),null==e?n:this}},{key:"track",value:function(){return this.reference("href")}}]),t}(sl);Po({Container:{textPath:Ia((function(e,t){return e instanceof sl||(e=this.text(e)),e.path(t)}))},Text:{path:Ia((function(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new ml;if(e instanceof Bu||(e=this.defs().path(e)),r.attr("href","#"+e,ba),n)for(;t=this.node.firstChild;)r.node.appendChild(t);return this.put(r)})),textPath:function(){return this.findOne("textPath")}},Path:{text:Ia((function(e){return e instanceof sl||(e=(new sl).addTo(this.parent()).text(e)),e.path(this)})),targets:function(){return Pc('svg [href*="'+this.id()+'"]')}}}),ml.prototype.MorphArray=Pu,Ra(ml,"TextPath");var gl=function(e){function t(e){return wa(this,t),Qs(this,Ks(t).call(this,Pa("use",e),e))}return tc(t,e),qs(t,[{key:"element",value:function(e,t){return this.attr("href",(t||"")+"#"+e,ba)}}]),t}(Zc);Po({Container:{use:Ia((function(e,t){return this.put(new gl).element(e,t)}))}}),Ra(gl,"Use");var bl=Ta;function _l(t){let n,r,i;return{c(){var e;n=u("div"),e="svg",r=document.createElementNS("http://www.w3.org/2000/svg",e),p(n,"class","flex-1 svelte-5pkurp"),i=h(r,"click",t.clickHex)},m(e,i){s(e,n,i),a(n,r),t.svg_binding(r)},p:e,i:e,o:e,d(e){e&&c(n),t.svg_binding(null),i()}}}function wl(e,t,n){let r,i,o,a,{gameState:s=null}=t;const c=g();function u(e){(console.log("updating state !",e),e)&&e.grid.forEach(e=>{const t=a.get({x:e.x,y:e.y});t&&t.setPlayerPiece(e.playerPiece)})}return function(e){m().$$.on_mount.push(e)}(()=>{const e=bl(r);i=$e({size:30,playerPiece:null,render(e){const{x:t,y:n}=this.toPoint(),r=this.corners();this.draw=e.polygon(r.map(({x:e,y:t})=>`${e},${t}`)).fill("none").stroke({width:1,color:"#999"}).translate(t,n),0===this.q?this.renderEdges(e,[2,3,4],Xe[2]):this.q===We-1&&this.renderEdges(e,[5,0,1],Xe[2]),0===this.r?this.renderEdges(e,[4,5,0],Xe[1]):this.r===We-1&&this.renderEdges(e,[1,2,3],Xe[1])},renderEdges(e,t,n){const{x:r,y:i}=this.toPoint(),o=this.corners();e.polyline(t.map(e=>[o[e].x,o[e].y])).fill("none").stroke({width:3,color:n}).translate(r,i)},setPlayerPiece(e){e!==this.playerPiece&&(this.playerPiece=e,this.updateColor())},updateColor(){switch(this.playerPiece){case 1:this.draw.fill({opacity:1,color:Xe[1]});break;case 2:this.draw.fill({opacity:1,color:Xe[2]});break;default:this.draw.fill({opacity:1,color:"none"})}}}),o=Ye(i),a=o.parallelogram({width:We,height:We,onCreate(t){t.render(e)}}),function(){const e=r.getBBox();r.setAttribute("viewBox",e.x-10+" "+(e.y-10)+" "+(e.width+20)+" "+(e.height+20)),r.setAttribute("width",e.width+20+"px"),r.setAttribute("height",e.height+20+"px")}()}),e.$set=e=>{"gameState"in e&&n("gameState",s=e.gameState)},e.$$.update=(e={gameState:1})=>{e.gameState&&u(s)},{targetElement:r,gameState:s,clickHex:function(e){const t=e.pageX-r.getBoundingClientRect().left-window.scrollX,n=e.pageY-r.getBoundingClientRect().top-window.scrollY,i=o.pointToHex([t,n]),s=a.get(i);s&&!s.playerPiece&&c("play",s)},svg_binding:function(e){_[e?"unshift":"push"](()=>{n("targetElement",r=e)})}}}Da([il,ol,fu,uu,vu],Eo("viewbox")),Da([du,Gu,zu,Bu],Eo("marker")),Da(sl,Eo("Text")),Da(Bu,Eo("Path")),Da(nu,Eo("Defs")),Da([sl,cl],Eo("Tspan")),Da([qu,ru,eu,cu],Eo("radius")),Da(Ec,Eo("EventTarget")),Da(Ac,Eo("Dom")),Da(Lc,Eo("Element")),Da(Zc,Eo("Shape")),Da(tu,Eo("Container")),Da(Ku,Eo("Runner")),xc.extend(ko(new Set(To))),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];Nu.push.apply(Nu,ko([].concat(e)))}([Dc,Ws,Sc,bc,jc,hu,Pu]),Da(Nu,{to:function(e){return(new Du).type(this.constructor).from(this.valueOf()).to(e)},fromArray:function(e){return this.init(e),this}});class Sl extends N{constructor(e){super(),L(this,e,wl,_l,o,{gameState:0})}}function Cl(e){let t;const n=new Sl({props:{gameState:e.gameState}});return n.$on("play",e.sendPlayAction),{c(){j(n.$$.fragment)},m(e,r){D(n,e,r),t=!0},p(e,t){const r={};e.gameState&&(r.gameState=t.gameState),n.$set(r)},i(e){t||(R(n.$$.fragment,e),t=!0)},o(e){M(n.$$.fragment,e),t=!1},d(e){I(n,e)}}}function kl(e){let t,n,i,o,p,v,y,m,g,b,_=(e.connectionToHost||!e.connectionToHost)&&Cl(e);return{c(){(t=u("h1")).textContent="Game",n=f(),i=u("div"),o=u("input"),p=f(),(v=u("button")).textContent="Connect",y=f(),_&&_.c(),m=l(""),b=[h(o,"input",e.input_input_handler),h(v,"click",e.connect)]},m(r,c){s(r,t,c),s(r,n,c),s(r,i,c),a(i,o),d(o,e.hostId),a(i,p),a(i,v),s(r,y,c),_&&_.m(r,c),s(r,m,c),g=!0},p(e,t){e.hostId&&o.value!==t.hostId&&d(o,t.hostId),t.connectionToHost||!t.connectionToHost?_?(_.p(e,t),R(_,1)):((_=Cl(t)).c(),R(_,1),_.m(m.parentNode,m)):_&&(O={r:0,c:[],p:O},M(_,1,1,()=>{_=null}),O.r||r(O.c),O=O.p)},i(e){g||(R(_),g=!0)},o(e){M(_),g=!1},d(e){e&&c(t),e&&c(n),e&&c(i),e&&c(y),_&&_.d(e),e&&c(m),r(b)}}}function xl(e,t,n){let r=null,i=null,o=null;const a=new F;return{connectionToHost:r,hostId:i,gameState:o,connect:function(){n("connectionToHost",r=a.connect(i)),r.on("open",()=>{r.send({request:"state"})}),r.on("data",e=>{console.log("data received",e),"state"===e.type&&n("gameState",o=e.data)})},sendPlayAction:function(e){r&&r.send({action:"play",data:{x:e.detail.x,y:e.detail.y}})},input_input_handler:function(){i=this.value,n("hostId",i)}}}class Tl extends N{constructor(e){super(),L(this,e,xl,kl,o,{})}}function Pl(t){let n,r,i,o,l;const h=new tt({}),d=new Tl({});return{c(){n=u("div"),r=u("div"),j(h.$$.fragment),i=f(),o=u("div"),j(d.$$.fragment),p(r,"class","host-section svelte-f30g9n"),p(o,"class","game-section svelte-f30g9n"),p(n,"class","container svelte-f30g9n")},m(e,t){s(e,n,t),a(n,r),D(h,r,null),a(n,i),a(n,o),D(d,o,null),l=!0},p:e,i(e){l||(R(h.$$.fragment,e),R(d.$$.fragment,e),l=!0)},o(e){M(h.$$.fragment,e),M(d.$$.fragment,e),l=!1},d(e){e&&c(n),I(h),I(d)}}}return new class extends N{constructor(e){super(),L(this,e,null,Pl,o,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
